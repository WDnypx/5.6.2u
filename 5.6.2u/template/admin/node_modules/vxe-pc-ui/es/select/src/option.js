import { defineVxeComponent } from '../../ui/src/comp';
import XEUtils from 'xe-utils';
import { createEvent, globalMixins } from '../../ui';
import { createOption, watchOption, destroyOption, assembleOption } from './util';
export default {
    name: 'VxeOption',
    mixins: [
        globalMixins.sizeMixin
    ],
    props: {
        value: [String, Number, Boolean],
        label: {
            type: [String, Number, Boolean],
            default: ''
        },
        visible: {
            type: Boolean,
            default: null
        },
        className: [String, Function],
        disabled: Boolean
    },
    inject: {
        $xeSelect: {
            default: null
        },
        $xeOptgroup: {
            default: null
        }
    },
    data() {
        const xID = XEUtils.uniqueId();
        const reactData = {};
        const optionConfig = {};
        return {
            xID,
            reactData,
            optionConfig
        };
    },
    computed: Object.assign({}, {}),
    methods: {
        //
        // Method
        //
        dispatchEvent(type, params, evnt) {
            const $xeOption = this;
            $xeOption.$emit(type, createEvent(evnt, { $option: $xeOption }, params));
        },
        //
        // Render
        //
        renderVN(h) {
            return h('div', {
                ref: 'elem'
            });
        }
    },
    created() {
        const $xeOption = this;
        const props = $xeOption;
        const $xeSelect = $xeOption.$xeSelect;
        const optionConfig = createOption($xeSelect, props);
        $xeOption.optionConfig = optionConfig;
        watchOption($xeOption, optionConfig);
    },
    mounted() {
        const $xeOption = this;
        const slots = $xeOption.$scopedSlots;
        const optionConfig = $xeOption.optionConfig;
        const $xeSelect = $xeOption.$xeSelect;
        const $xeOptgroup = $xeOption.$xeOptgroup;
        optionConfig.slots = slots;
        const el = $xeOption.$refs.elem;
        assembleOption($xeSelect, el, optionConfig, $xeOptgroup);
    },
    beforeDestroy() {
        const $xeOption = this;
        const optionConfig = $xeOption.optionConfig;
        const $xeSelect = $xeOption.$xeSelect;
        destroyOption($xeSelect, optionConfig);
    },
    render(h) {
        return this.renderVN(h);
    }
};
