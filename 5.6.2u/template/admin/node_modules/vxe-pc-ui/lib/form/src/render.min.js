Object.defineProperty(exports,"__esModule",{value:!0}),exports.renderItemContent=exports.getItemContentClass=exports.getItemClass=void 0,exports.renderTitle=renderTitle;var _ui=require("../../ui"),_utils=require("../../ui/src/utils"),_dom=require("../../ui/src/dom"),_vn=require("../../ui/src/vn"),_util=require("./util"),_tooltip=_interopRequireDefault(require("../../tooltip/src/tooltip")),_icon=_interopRequireDefault(require("../../icon/src/icon")),_xeUtils=_interopRequireDefault(require("xe-utils"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var l;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(l="Object"===(l={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:l)||"Set"===l?Array.from(e):"Arguments"===l||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l)?_arrayLikeToArray(e,t):void 0}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var l=0,i=Array(t);l<t;l++)i[l]=e[l];return i}function renderPrefixIcon(e,t){return e("span",{class:"vxe-form--item-title-prefix"},[e(_icon.default,{class:t.icon||(0,_ui.getIcon)().FORM_PREFIX,props:{status:t.iconStatus}})])}function renderSuffixIcon(e,t){return e("span",{class:"vxe-form--item-title-suffix"},[e(_icon.default,{class:t.icon||(0,_ui.getIcon)().FORM_SUFFIX,props:{status:t.iconStatus}})])}var getItemClass=exports.getItemClass=function(e,t,l){var i=e.reactData,r=e.$xeGrid,n=e.data,o=e.rules,a=e.readonly,s=e.disabled,u=e.span,d=e.titleBackground,c=e.titleBold,f=e.titleColon,m=e.titleAsterisk,p=e.vertical,g=e.padding,i=i.collapseAll,_=t.folding,x=t.field,v=t.itemRender,y=t.showError,I=t.className,b=t.vertical,C=t.padding,h=t.children,A=t.showContent,v=(0,_utils.isEnableConf)(v)?_ui.renderer.get(v.name):null,v=v?v.formItemClassName||v.itemClassName:"",u=t.span||u,g=_xeUtils.default.eqNull(C)?g:C,C=_xeUtils.default.eqNull(b)?p:b,p=_xeUtils.default.eqNull(t.titleBackground)?d:t.titleBackground,b=_xeUtils.default.eqNull(t.titleBold)?c:t.titleBold,d=_xeUtils.default.eqNull(t.titleColon)?f:t.titleColon,c=_xeUtils.default.eqNull(t.titleAsterisk)?m:t.titleAsterisk,f={data:n,disabled:s,readonly:a,field:x,property:x,item:t,$form:e,$grid:r},m=h&&0<h.length,n=!1,s=!1;return!a&&o&&(r=o[x])&&r.length&&(s=!0,n=r.some(function(e){return e.required})),[l||m?"vxe-form--group":"","vxe-form--item",t.id,u?"vxe-form--item-col_".concat(u," is--span"):"",I?_xeUtils.default.isFunction(I)?I(f):I:"",v?_xeUtils.default.isFunction(v)?v(f):v:"",{"is--colon":d,"is--tbg":p,"is--bold":b,"is--padding":g,"is--vertical":C,"is--asterisk":c,"hide--content":!1===A,"is--valid":s,"is--required":n,"is--hidden":_&&i,"is--active":(0,_util.isActiveItem)(e,t),"is--error":y}]},getItemContentClass=exports.getItemContentClass=function(e,t,l){var i=e.$xeGrid,r=e.data,n=e.readonly,o=e.disabled,a=e.align,s=e.verticalAlign,u=t.field,d=t.itemRender,c=t.contentClassName,f=t.children,d=(0,_utils.isEnableConf)(d)?_ui.renderer.get(d.name):null,d=d?d.formItemContentClassName||d.itemContentClassName:"",a=_xeUtils.default.eqNull(t.align)?a:t.align,s=_xeUtils.default.eqNull(t.verticalAlign)?s:t.verticalAlign,r={data:r,disabled:o,readonly:n,field:u,property:u,item:t,$form:e,$grid:i},o=f&&0<f.length;return[l||o?"vxe-form--group-content vxe-form--item-row":"","vxe-form--item-content",a?"align--".concat(a):"",s?"vertical-align--".concat(s):"",d?_xeUtils.default.isFunction(d)?d(r):d:"",c?_xeUtils.default.isFunction(c)?c(r):c:""]};function renderTitle(e,t,l,i){var r=t.$xeGrid,n=t.data,o=t.readonly,a=t.disabled,s=t.titleAlign,u=t.titleWidth,d=t.titleOverflow,c=t.vertical,f=l.slots,m=l.title,p=l.field,g=l.itemRender,_=l.titleOverflow,x=l.vertical,v=l.showTitle,y=l.titleClassName,I=l.titleStyle,b=l.titlePrefix,C=l.titleSuffix,h=l.children,A=l.showContent,T=t.computeTooltipOpts,U=(0,_utils.isEnableConf)(g)?_ui.renderer.get(g.name):null,q=U?U.formItemTitleClassName||U.itemTitleClassName:"",N=U?U.formItemTitleStyle||U.itemTitleStyle:null,c=_xeUtils.default.eqNull(x)?c:x,x=_xeUtils.default.eqNull(l.titleAlign)?s:l.titleAlign,s=c?null:_xeUtils.default.eqNull(l.titleWidth)?u:l.titleWidth,c=_xeUtils.default.eqNull(_)?d:_,u="title"===c,d=!0===c||"tooltip"===c,_=u||d||"ellipsis"===c,F={data:n,disabled:a,readonly:o,field:p,property:p,item:l,$form:t,$grid:r},c=f?f.title:null,n=f?f.extra:null,a=!1!==v&&(m||c),o=h&&0<h.length,p=[],r=(b&&p.push(b.content||b.message?e(_tooltip.default,{props:Object.assign(Object.assign(Object.assign({},T),b),{content:(0,_utils.getFuncText)(b.content||b.message)}),scopedSlots:{default:function(){return renderPrefixIcon(e,b)}}}):renderPrefixIcon(e,b)),U?U.renderFormItemTitle||U.renderItemTitle:null),f=(p.push(e("span",{class:"vxe-form--item-title-label"},c?t.callSlot(c,F,e):r?(0,_vn.getSlotVNs)(r.call(t,e,g,F)):(0,_utils.getFuncText)(l.title))),[]),v=(C&&f.push(C.content||C.message?e(_tooltip.default,{props:Object.assign(Object.assign(Object.assign({},T),C),{content:(0,_utils.getFuncText)(C.content||C.message)}),scopedSlots:{default:function(){return renderSuffixIcon(e,C)}}}):renderSuffixIcon(e,C)),d?{onMouseenter:function(e){t.triggerTitleTipEvent(e,F)},onMouseleave:t.handleTitleTipLeaveEvent}:{});return a?e("div",{class:[i||o?"vxe-form--group-title":"","vxe-form--item-title",x?"align--".concat(x):"",_?"is--ellipsis":"",q?_xeUtils.default.isFunction(q)?q(F):q:"",y?_xeUtils.default.isFunction(y)?y(F):y:""],style:Object.assign({},_xeUtils.default.isFunction(N)?N(F):N,_xeUtils.default.isFunction(I)?I(F):I,s&&!1!==A?{width:(0,_dom.toCssUnit)(s)}:null),attrs:{title:u?(0,_utils.getFuncText)(m):null},on:v},[e("div",{class:"vxe-form--item-title-content"},p),e("div",{class:"vxe-form--item-title-postfix"},f),n?e("div",{class:"vxe-form--item-title-extra"},t.callSlot(n,F,e)):(0,_ui.renderEmptyElement)(t)]):(0,_ui.renderEmptyElement)(t)}var renderItemContent=exports.renderItemContent=function(e,t,l){var i=t.reactData,r=t.$xeGrid,n=t.data,o=t.readonly,a=t.disabled,s=t.internalData.itemFormatCache,i=i.collapseAll,u=l.slots,d=l.field,c=l.itemRender,f=l.collapseNode,m=l.errRule,p=l.formatter,g=u?u.default:null,u=u?u.valid:null,_=t.computeValidOpts,x=t.computeCollapseOpts,v=(0,_utils.isEnableConf)(c)?_ui.renderer.get(c.name):null,y=_xeUtils.default.get(n,d),n={data:n,disabled:a,readonly:o,field:d,property:d,item:l,itemValue:y,$form:t,$grid:r},a=[],o=v?v.renderFormItemContent||v.renderItemContent:null;if(g)a=t.callSlot(g,n,e);else if(o)a=(0,_vn.getSlotVNs)(o.call(t,e,c,n));else if(d){var I,l=y;if(p){if(d){var r=s[d];if(r)if(I=r.formatData){if(I.value===y)return I.label}else I=r.formatData={};else s[d]={field:d}}l=_xeUtils.default.isString(p)?(g=(v=_ui.formats.get(p))?v.formItemFormatMethod:null)?g(n):"":_xeUtils.default.isArray(p)?(c=(o=_ui.formats.get(p[0]))?o.formItemFormatMethod:null)?c.apply(void 0,[n].concat(_toConsumableArray(p.slice(1)))):"":p(n),I&&(I.value=y,I.label=l)}a=[(0,_utils.eqEmptyValue)(l)?"":"".concat(l)]}return f&&a.push(e("div",{class:"vxe-form--item-trigger-node",on:{click:t.toggleCollapseEvent}},[e("span",{class:"vxe-form--item-trigger-text"},i?x.unfoldButtonText||(0,_ui.getI18n)("vxe.form.unfolding"):x.foldButtonText||(0,_ui.getI18n)("vxe.form.folding")),e("i",{class:["vxe-form--item-trigger-icon",i?x.foldIcon||(0,_ui.getIcon)().FORM_FOLDING:x.unfoldIcon||(0,_ui.getIcon)().FORM_UNFOLDING]})])),m&&_.showMessage&&(r=Object.assign(Object.assign({},n),{rule:m}),a.push(e("div",{class:"vxe-form-item--valid-error-tip",style:m.maxWidth?{width:(0,_dom.toCssUnit)(m.maxWidth)}:{}},[e("div",{class:"vxe-form-item--valid-error-wrapper vxe-form-item--valid-error-theme-".concat(_.theme||"normal")},[u?t.callSlot(u,r,e):[e("span",{class:"vxe-form--item--valid-error-msg"},m.content||m.message)]])]))),e("div",{class:"vxe-form--item-inner"},a)};