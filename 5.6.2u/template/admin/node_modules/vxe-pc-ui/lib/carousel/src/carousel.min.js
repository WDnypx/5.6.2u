Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _comp=require("../../ui/src/comp"),_xeUtils=_interopRequireDefault(require("xe-utils")),_ui=require("../../ui"),_vn=require("../../ui/src/vn"),_dom=require("../../ui/src/dom"),_loading=_interopRequireDefault(require("../../loading/src/loading"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var _default2=exports.default=(0,_comp.defineVxeComponent)({name:"VxeCarousel",mixins:[_ui.globalMixins.sizeMixin],props:{value:[String,Number],options:Array,loading:Boolean,height:{type:[Number,String],default:function(){return(0,_ui.getConfig)().carousel.height}},width:{type:[Number,String],default:function(){return(0,_ui.getConfig)().carousel.width}},autoPlay:{type:Boolean,default:function(){return(0,_ui.getConfig)().carousel.autoPlay}},interval:{type:[Number,String],default:function(){return(0,_ui.getConfig)().carousel.interval}},loop:{type:Boolean,default:function(){return(0,_ui.getConfig)().carousel.loop}},vertical:{type:Boolean,default:function(){return(0,_ui.getConfig)().carousel.vertical}},showIndicators:{type:Boolean,default:function(){return(0,_ui.getConfig)().carousel.showIndicators}}},data:function(){return{xID:_xeUtils.default.uniqueId(),reactData:{activeName:"",staticItems:[],itemWidth:0,itemHeight:0},internalData:{apTimeout:void 0,stopFlag:!1}}},provide:function(){return{$xeCarousel:this}},computed:Object.assign(Object.assign({},{}),{computeListStyle:function(){var t=this.reactData,e=this.vertical,i=this.options,a=t.activeName,n=t.itemWidth,r=t.itemHeight,t=t.staticItems,t=(t&&t.length?t:i)||[],i=Math.max(0,_xeUtils.default.findIndexOf(t,function(t){return t.name===a})),o={};return e?o.transform="translateY(-".concat(i*r,"px)"):(o.width="".concat(n*t.length,"px"),o.transform="translateX(-".concat(i*n,"px)")),o}}),methods:{dispatchEvent:function(t,e,i){this.$emit(t,(0,_ui.createEvent)(i,{$carousel:this},e))},prev:function(){var t=this;return t.handlePrevNext(!1)&&t.handleAutoPlay(),t.$nextTick()},next:function(){var t=this;return t.handlePrevNext(!0)&&t.handleAutoPlay(),t.$nextTick()},updateStyle:function(){var e=this,i=e.reactData;e.$nextTick(function(){var t=e.$refs.refWrapperElem;t&&(i.itemWidth=t.clientWidth,i.itemHeight=t.clientHeight)})},clickItemEvent:function(t,e){var i=this,a=i.reactData,n=e.name;a.activeName=e.name,i.$emit("input",n),i.$emit("change",{value:n},t),i.updateStyle()},initDefaultActive:function(t){var e,i=this,a=i.reactData,n=null;t&&t.length&&(e=!1,n=i.value,t.forEach(function(t){n===t.name&&(e=!0)}),e||(n=t[0].name,i.$emit("input",n))),a.activeName=n},handlePrevNext:function(t){var e=this.reactData,i=this.options,a=this.loop,n=e.activeName,r=e.staticItems,r=(r&&r.length?r:i)||[],i=Math.max(0,_xeUtils.default.findIndexOf(r,function(t){return t.name===n}));if(-1<i){var o=null;if(t?i<r.length-1?o=r[i+1]:a&&(o=r[0]):0<i?o=r[i-1]:a&&(o=r[r.length-1]),o)return t=o.name,e.activeName=t,this.$emit("input",t),!0}return!1},prevEvent:function(t){var e=this.reactData;this.handlePrevNext(!1)&&(e=e.activeName,this.$emit("change",{value:e},t))},nextEvent:function(t){var e=this.reactData;this.handlePrevNext(!0)&&(e=e.activeName,this.$emit("change",{value:e},t))},stopAutoPlay:function(){var t=this.internalData,e=t.apTimeout;t.stopFlag=!0,e&&(clearTimeout(e),t.apTimeout=void 0)},handleAutoPlay:function(){var t=this,e=t.internalData,i=t.autoPlay,a=t.interval,n=e.stopFlag;t.stopAutoPlay(),i&&(e.stopFlag=!1,e.apTimeout=setTimeout(function(){n||t.handlePrevNext(!0)},_xeUtils.default.toNumber(a)||300))},mouseenterEvent:function(){this.stopAutoPlay()},mouseleaveEvent:function(){this.handleAutoPlay()},callSlot:function(t,e){var i=this.$scopedSlots;return t&&(_xeUtils.default.isString(t)&&(t=i[t]||null),_xeUtils.default.isFunction(t))?(0,_vn.getSlotVNs)(t(e)):[]},renderItemWrapper:function(a,t){var n=this,e=n.reactData,r=n.height,o=e.activeName;return a("div",{class:"vxe-carousel--list",style:n.computeListStyle},t.map(function(t){var e=t.name,i=t.url,t=t.slots,t=t?t.default:null;return a("div",{key:"".concat(e),class:["vxe-carousel--item-inner",{"is--active":o===e}],style:r?{height:(0,_dom.toCssUnit)(r)}:{}},t?n.callSlot(t,{}):[a("img",{class:"vxe-carousel--item-img",attrs:{src:i}})])}))},renderIndicators:function(i,t){var a=this,n=a.reactData.activeName;return i("div",{class:"vxe-carousel--indicators"},t.map(function(e){var t=e.name;return i("div",{key:"".concat(t),class:["vxe-carousel--indicators-item",{"is--active":n===t}],on:{click:function(t){a.clickItemEvent(t,e)}}})}))},renderVN:function(t){var e=this,i=e.$scopedSlots,a=e.loading,n=e.height,r=e.width,o=e.showIndicators,u=e.vertical,s=e.reactData.staticItems,i=i.default,s=(s&&s.length?s:e.options)||[];return t("div",{ref:"refElem",class:["vxe-carousel","is--".concat(u?"vertical":"horizontal")],style:r?{width:(0,_dom.toCssUnit)(r)}:{},on:{mouseenter:e.mouseenterEvent,mouseleave:e.mouseleaveEvent}},[t("div",{class:"vxe-carousel--slots"},i?i({}):[]),t("div",{ref:"refWrapperElem",class:"vxe-carousel--item-wrapper",style:n?{height:(0,_dom.toCssUnit)(n)}:{}},[e.renderItemWrapper(t,s)]),o?e.renderIndicators(t,s):(0,_ui.renderEmptyElement)(e),t("div",{class:"vxe-carousel--btn-wrapper"},[t("div",{class:"vxe-carousel--previous-btn",on:{click:e.prevEvent}},[t("i",{class:u?(0,_ui.getIcon)().CAROUSEL_VERTICAL_PREVIOUS:(0,_ui.getIcon)().CAROUSEL_HORIZONTAL_PREVIOUS})]),t("div",{class:"vxe-carousel--next-btn",on:{click:e.nextEvent}},[t("i",{class:u?(0,_ui.getIcon)().CAROUSEL_VERTICAL_NEXT:(0,_ui.getIcon)().CAROUSEL_HORIZONTAL_NEXT})])]),t(_loading.default,{class:"vxe-carousel--loading",props:{value:a}})])}},watch:{options:function(){this.initDefaultActive(this.options)},"reactData.staticItems":function(){var t=this.reactData;this.initDefaultActive(t.staticItems)},autoPlay:function(){this.handleAutoPlay()}},created:function(){var t=this.reactData;this.initDefaultActive(t.staticItems.length?t.staticItems:this.options)},mounted:function(){this.handleAutoPlay(),this.updateStyle()},beforeDestroy:function(){this.stopAutoPlay()},render:function(t){return this.renderVN(t)}});