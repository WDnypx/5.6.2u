Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _comp=require("../../ui/src/comp"),_xeUtils=_interopRequireDefault(require("xe-utils")),_ui=require("../../ui"),_vn=require("../../ui/src/vn"),_dom=require("../../ui/src/dom"),_loading=_interopRequireDefault(require("../../loading/src/loading"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function getNodeUniqueId(){return _xeUtils.default.uniqueId("node_")}function handleSetExpand(e,t,n){t?n[e]||(n[e]=!0):n[e]&&delete n[e]}var _default2=exports.default=(0,_comp.defineVxeComponent)({name:"VxeTree",mixins:[_ui.globalMixins.sizeMixin],props:{data:Array,height:[String,Number],minHeight:{type:[String,Number],default:function(){return(0,_ui.getConfig)().tree.minHeight}},loading:Boolean,loadingConfig:Object,accordion:{type:Boolean,default:function(){return(0,_ui.getConfig)().tree.accordion}},childrenField:{type:String,default:function(){return(0,_ui.getConfig)().tree.childrenField}},valueField:{type:String,default:function(){return(0,_ui.getConfig)().tree.valueField}},keyField:{type:String,default:function(){return(0,_ui.getConfig)().tree.keyField}},parentField:{type:String,default:function(){return(0,_ui.getConfig)().tree.parentField}},titleField:{type:String,default:function(){return(0,_ui.getConfig)().tree.titleField}},hasChildField:{type:String,default:function(){return(0,_ui.getConfig)().tree.hasChildField}},mapChildrenField:{type:String,default:function(){return(0,_ui.getConfig)().tree.mapChildrenField}},transform:Boolean,isCurrent:Boolean,isHover:Boolean,expandAll:Boolean,showLine:{type:Boolean,default:function(){return(0,_ui.getConfig)().tree.showLine}},trigger:String,indent:{type:Number,default:function(){return(0,_ui.getConfig)().tree.indent}},showRadio:{type:Boolean,default:function(){return(0,_ui.getConfig)().tree.showRadio}},checkNodeKey:{type:[String,Number],default:function(){return(0,_ui.getConfig)().tree.checkNodeKey}},radioConfig:Object,showCheckbox:{type:Boolean,default:function(){return(0,_ui.getConfig)().tree.showCheckbox}},checkNodeKeys:{type:Array,default:function(){return(0,_ui.getConfig)().tree.checkNodeKeys}},checkboxConfig:Object,nodeConfig:Object,lazy:Boolean,toggleMethod:Function,loadMethod:Function,showIcon:{type:Boolean,default:!0},iconOpen:{type:String,default:function(){return(0,_ui.getConfig)().tree.iconOpen}},iconClose:{type:String,default:function(){return(0,_ui.getConfig)().tree.iconClose}},iconLoaded:{type:String,default:function(){return(0,_ui.getConfig)().tree.iconLoaded}},size:{type:String,default:function(){return(0,_ui.getConfig)().tree.size||(0,_ui.getConfig)().size}}},data:function(){return{xID:_xeUtils.default.uniqueId(),reactData:{currentNode:null,selectRadioKey:null,treeList:[],updateExpandedFlag:1,updateCheckboxFlag:1},internalData:{nodeMaps:{},selectCheckboxMaps:{},indeterminateRowMaps:{},treeExpandedMaps:{},treeExpandLazyLoadedMaps:{}}}},computed:Object.assign(Object.assign({},{}),{computeTitleField:function(){return this.titleField||"title"},computeKeyField:function(){return this.keyField||"id"},computeValueField:function(){var e=this.computeKeyField;return this.valueField||e},computeParentField:function(){return this.parentField||"parentId"},computeChildrenField:function(){return this.childrenField||"children"},computeMapChildrenField:function(){return this.mapChildrenField||"mapChildren"},computeHasChildField:function(){return this.hasChildField||"hasChild"},computeIsRowCurrent:function(){var e=this.computeNodeOpts.isCurrent;return _xeUtils.default.isBoolean(e)?e:this.isCurrent},computeIsRowHover:function(){var e=this.computeNodeOpts.isHover;return _xeUtils.default.isBoolean(e)?e:this.isHover},computeRadioOpts:function(){return Object.assign({showIcon:!0},(0,_ui.getConfig)().tree.radioConfig,this.radioConfig)},computeCheckboxOpts:function(){return Object.assign({showIcon:!0},(0,_ui.getConfig)().tree.checkboxConfig,this.checkboxConfig)},computeNodeOpts:function(){return Object.assign({},(0,_ui.getConfig)().tree.nodeConfig,this.nodeConfig)},computeLoadingOpts:function(){return Object.assign({},(0,_ui.getConfig)().tree.loadingConfig,this.loadingConfig)},computeTreeStyle:function(){var e=this.height,t=this.minHeight,n={};return e&&(n.height=(0,_dom.toCssUnit)(e)),t&&(n.minHeight=(0,_dom.toCssUnit)(t)),n}}),methods:{dispatchEvent:function(e,t,n){this.$emit(e,(0,_ui.createEvent)(n,{$tree:this},t))},clearCurrentNode:function(){return this.reactData.currentNode=null,this.$nextTick()},getCurrentNodeId:function(){var e=this.reactData.currentNode;return e?this.getNodeId(e):null},getCurrentNode:function(){var e=this.reactData,t=this.internalData,e=e.currentNode,t=t.nodeMaps;if(e){t=t[this.getNodeId(e)];if(t)return t.item}return null},setCurrentNodeId:function(e){var t=this.reactData,e=this.internalData.nodeMaps[e];return t.currentNode=e?e.item:null,this.$nextTick()},setCurrentNode:function(e){return this.reactData.currentNode=e,this.$nextTick()},clearRadioNode:function(){return this.reactData.selectRadioKey=null,this.$nextTick()},getCheckboxNodeIds:function(){var e=this.internalData.selectCheckboxMaps;return Object.keys(e)},getCheckboxNodes:function(){var e=this.internalData,n=e.nodeMaps,i=[];return _xeUtils.default.each(e.selectCheckboxMaps,function(e,t){t=n[t];t&&i.push(t.item)}),i},clearCheckboxNode:function(){var e=this.reactData;return this.internalData.selectCheckboxMaps={},e.updateCheckboxFlag++,this.$nextTick()},setAllCheckboxNode:function(e){var t=this,n=t.reactData,i=t.internalData,a=t.transform,o={};return e&&_xeUtils.default.eachTree(n.treeList,function(e){e=t.getNodeId(e);o[e]=!0},{children:a?t.computeMapChildrenField:t.computeChildrenField}),i.selectCheckboxMaps=o,n.updateCheckboxFlag++,t.$nextTick()},clearExpandNode:function(){return this.clearAllExpandNode()},clearAllExpandNode:function(){var e=this.reactData,t=this.internalData,n=t.nodeMaps;return _xeUtils.default.each(n,function(e){e.treeLoaded=!1}),t.treeExpandedMaps={},e.updateExpandedFlag++,this.$nextTick()},setExpandByNodeId:function(e,t){var n=this.reactData,i=this.internalData.treeExpandedMaps;return e&&((e=_xeUtils.default.isArray(e)?e:[e]).forEach(function(e){handleSetExpand(e,t,i)}),n.updateExpandedFlag++),this.$nextTick()},getExpandNodeIds:function(){var e=this.internalData.treeExpandedMaps;return _xeUtils.default.keys(e)},getExpandNodes:function(){var e=this.internalData,n=e.nodeMaps,i=[];return _xeUtils.default.each(e.treeExpandedMaps,function(e,t){t=n[t];t&&i.push(t.item)}),i},setExpandNode:function(e,t){var n=this,i=n.reactData,a=n.internalData.treeExpandedMaps;return e&&((e=_xeUtils.default.isArray(e)?e:[e]).forEach(function(e){handleSetExpand(n.getNodeId(e),t,a)}),i.updateExpandedFlag++),n.$nextTick()},toggleExpandByNodeId:function(e){var t=this.reactData,n=this.internalData.treeExpandedMaps;return e&&((e=_xeUtils.default.isArray(e)?e:[e]).forEach(function(e){handleSetExpand(e,!n[e],n)}),t.updateExpandedFlag++),this.$nextTick()},toggleExpandNode:function(e){var t=this,n=t.reactData,i=t.internalData.treeExpandedMaps;return e&&((e=_xeUtils.default.isArray(e)?e:[e]).forEach(function(e){e=t.getNodeId(e);handleSetExpand(e,!i[e],i)}),n.updateExpandedFlag++),t.$nextTick()},setAllExpandNode:function(e){var n=this,t=n.reactData,i=n.internalData,a=n.transform,o=i.treeExpandedMaps,d=n.computeChildrenField;return e?_xeUtils.default.eachTree(t.treeList,function(e){var t=_xeUtils.default.get(e,d);t&&t.length&&(t=n.getNodeId(e),o[t]=!0)},{children:a?n.computeMapChildrenField:d}):i.treeExpandedMaps={},t.updateExpandedFlag++,n.$nextTick()},reloadExpandNode:function(e){return this.lazy?(this.clearExpandLoaded(e),this.handleAsyncTreeExpandChilds(e)):this.$nextTick()},clearExpandLoaded:function(e){var t=this.internalData,n=this.lazy,t=t.nodeMaps;return n&&(n=t[this.getNodeId(e)])&&(n.treeLoaded=!1),this.$nextTick()},loadChildrenNode:function(d,e){var t,r,c,u,l=this,n=l.internalData,i=l.lazy,a=l.transform,s=n.nodeMaps;return i?(t=l.computeChildrenField,r=s[l.getNodeId(d)],c=r?r.level:0,u=r?r.nodes:[],l.createNode(e).then(function(e){return _xeUtils.default.eachTree(e,function(e,t,n,i,a,o){e=l.getNodeId(e);s[e]={item:d,itemIndex:-1,items:n,parent:a||r.item,nodes:u.concat(o),level:c+o.length,lineCount:0,treeLoaded:!1}},{children:t}),d[t]=e,a&&(d[t]=e),l.updateNodeLine(d),e})):Promise.resolve([])},getNodeId:function(e){var t=this.computeValueField,e=_xeUtils.default.get(e,t);return _xeUtils.default.eqNull(e)?"":encodeURIComponent(e)},isExpandByNode:function(e){var t=this.reactData,n=this.internalData,t=t.updateExpandedFlag,n=n.treeExpandedMaps,e=this.getNodeId(e);return!(!t||!n[e])},isCheckedByRadioNodeId:function(e){return this.reactData.selectRadioKey===e},isCheckedByRadioNode:function(e){return this.isCheckedByRadioNodeId(this.getNodeId(e))},isCheckedByCheckboxNodeId:function(e){var t=this.reactData,n=this.internalData,t=t.updateCheckboxFlag,n=n.selectCheckboxMaps;return!(!t||!n[e])},isCheckedByCheckboxNode:function(e){return this.isCheckedByCheckboxNodeId(this.getNodeId(e))},isIndeterminateByCheckboxNodeid:function(e){var t=this.reactData,n=this.internalData,t=t.updateCheckboxFlag,n=n.indeterminateRowMaps;return!(!t||!n[e])},isIndeterminateByCheckboxNode:function(e){return this.isIndeterminateByCheckboxNodeid(this.getNodeId(e))},getCheckboxIndeterminateNodes:function(){var e=this.internalData,n=e.nodeMaps,i=[];return _xeUtils.default.each(e.indeterminateRowMaps,function(e,t){t=n[t];t&&i.push(t.item)}),i},emitCheckboxMode:function(e){this.$emit("update:checkNodeKeys",e)},emitRadioMode:function(e){this.$emit("update:checkNodeKey",e)},getRadioNodeId:function(){return this.reactData.selectRadioKey||null},setRadioNodeId:function(e){return this.reactData.selectRadioKey=e,this.$nextTick()},getRadioNode:function(){var e=this.reactData,t=this.internalData,e=e.selectRadioKey,t=t.nodeMaps;if(e){t=t[e];if(t)return t.item}return null},setRadioNode:function(e){var t=this.reactData;return e&&(t.selectRadioKey=this.getNodeId(e)),this.$nextTick()},setCheckboxNode:function(e,t){return e&&(_xeUtils.default.isArray(e)||(e=[e]),this.handleCheckedCheckboxNode(e,t)),this.$nextTick()},setCheckboxByNodeId:function(e,t){var n,i=this.internalData.nodeMaps;return e&&(_xeUtils.default.isArray(e)||(e=[e]),n=[],e.forEach(function(e){e=i[e];e&&n.push(e.item)}),this.handleCheckedCheckboxNode(n,t)),this.$nextTick()},handleCheckedCheckboxNode:function(e,n){function t(e){var t=i.getNodeId(e);n?d[t]||(d[t]=e):d[t]&&delete d[t]}var i=this,a=i.reactData,o=i.transform,d=i.internalData.selectCheckboxMaps,r=i.computeMapChildrenField,c=i.computeChildrenField;i.computeCheckboxOpts.checkStrictly?e.forEach(t):_xeUtils.default.eachTree(e,t,{children:o?r:c}),a.updateCheckboxFlag++,i.updateCheckboxStatus()},updateCheckboxChecked:function(e){this.setCheckboxByNodeId(e,!0)},createNode:function(e){var n=this,i=n.computeValueField;return Promise.resolve(e.map(function(e){var t,e=Object.assign({},e);return n.getNodeId(e)||(t=getNodeUniqueId(),_xeUtils.default.set(e,i,t)),e}))},cacheNodeMap:function(){var r=this,e=r.reactData,t=r.internalData,n=r.transform,e=e.treeList,c=r.computeValueField,u={};_xeUtils.default.eachTree(e,function(e,t,n,i,a,o){var d=r.getNodeId(e);d||(d=getNodeUniqueId(),_xeUtils.default.set(e,c,d)),u[d]={item:e,itemIndex:t,items:n,parent:a,nodes:o,level:o.length,lineCount:0,treeLoaded:!1}},{children:n?r.computeMapChildrenField:r.computeChildrenField}),t.nodeMaps=u},loadTreeData:function(e){var t=this,n=t,i=t.reactData,a=t.internalData,o=n.expandAll,d=a.initialized;i.treeList=n.transform?_xeUtils.default.toArrayTree(e,{key:t.computeKeyField,parentKey:t.computeParentField,mapChildren:t.computeMapChildrenField}):e?e.slice(0):[],t.cacheNodeMap(),d||e&&e.length&&(a.initialized=!0,o&&t.setAllExpandNode(!0),t.setCheckboxByNodeId(n.checkNodeKeys||[],!0))},handleCountLine:function(e,i,a){var o=this,t=o.internalData.treeExpandedMaps,n=o.computeChildrenField,d=o.getNodeId(e);a.lineCount++,t[d]&&_xeUtils.default.arrayEach(e[n],function(e,t,n){(!i||t<n.length-1)&&o.handleCountLine(e,!1,a)})},updateNodeLine:function(e){var n=this,i=n.internalData.nodeMaps;e&&(e=n.getNodeId(e),e=i[e])&&_xeUtils.default.lastArrayEach(e.nodes,function(e){var t=n.getNodeId(e),t=i[t];t&&(t.lineCount=0,n.handleCountLine(e,!0,t))})},handleNodeClickEvent:function(e,t){var n=this,i=n.reactData,a=n.showRadio,o=n.showCheckbox,d=n.trigger,r=n.computeRadioOpts,c=n.computeCheckboxOpts,u=!1,l=!1,s=!1,h=!1;n.computeIsRowCurrent?(u=!0,n.changeCurrentEvent(e,t)):i.currentNode&&(i.currentNode=null),"node"===d&&(h=!0,n.toggleExpandEvent(e,t)),a&&"node"===r.trigger&&(l=!0,n.changeRadioEvent(e,t)),o&&"node"===c.trigger&&(s=!0,n.changeCheckboxEvent(e,t)),n.dispatchEvent("node-click",{node:t,triggerCurrent:u,triggerRadio:l,triggerCheckbox:s,triggerExpand:h},e)},handleNodeDblclickEvent:function(e,t){this.dispatchEvent("node-dblclick",{node:t},e)},handleAsyncTreeExpandChilds:function(o){var d=this,r=d.reactData,c=d.internalData,n=d.loadMethod,u=d.computeCheckboxOpts.checkStrictly;return new Promise(function(e){var t,i,a;n?(t=c.nodeMaps,i=d.getNodeId(o),a=t[i],c.treeExpandLazyLoadedMaps[i]=!0,Promise.resolve(n({$tree:d,node:o})).then(function(n){var e=c.treeExpandLazyLoadedMaps;if(a.treeLoaded=!0,e[i]&&(e[i]=!1),n=_xeUtils.default.isArray(n)?n:[])return d.loadChildrenNode(o,n).then(function(e){var t=c.treeExpandedMaps;return e.length&&!t[i]&&(t[i]=!0),r.updateExpandedFlag++,!u&&d.isCheckedByCheckboxNodeId(i)&&d.handleCheckedCheckboxNode(e,!0),d.updateNodeLine(o),d.dispatchEvent("load-success",{node:o,data:n},new Event("load-success")),d.$nextTick()});d.updateNodeLine(o),d.dispatchEvent("load-success",{node:o,data:n},new Event("load-success"))}).catch(function(e){var t=c.treeExpandLazyLoadedMaps;a.treeLoaded=!1,t[i]&&(t[i]=!1),d.updateNodeLine(o),d.dispatchEvent("load-error",{node:o,data:e},new Event("load-error"))}).finally(function(){return d.$nextTick()})):e()})},handleBaseTreeExpand:function(e,t){var i=this,n=i.reactData,a=i.internalData,o=i.lazy,d=i.accordion,r=i.toggleMethod,c=a.treeExpandLazyLoadedMaps,u=a.treeExpandedMaps,l=a.nodeMaps,s=i.computeChildrenField,h=i.computeHasChildField,p=[],a=r?e.filter(function(e){return r({$tree:i,expanded:t,node:e})}):e,f=(d&&(a=a.length?[a[a.length-1]]:[],e=i.getNodeId(a[0]),d=l[e])&&d.items.forEach(function(e){e=i.getNodeId(e);u[e]&&delete u[e]}),[]);return t?a.forEach(function(e){var t,n=i.getNodeId(e);u[n]||(t=l[n],o&&e[h]&&!t.treeLoaded&&!c[n]?p.push(i.handleAsyncTreeExpandChilds(e)):e[s]&&e[s].length&&(u[n]=!0,f.push(e)))}):a.forEach(function(e){var t=i.getNodeId(e);u[t]&&(delete u[t],f.push(e))}),n.updateExpandedFlag++,f.forEach(i.updateNodeLine),Promise.all(p)},toggleExpandEvent:function(e,t){var n=this.internalData,i=this.lazy,a=n.treeExpandedMaps,n=n.treeExpandLazyLoadedMaps,o=this.getNodeId(t),a=!a[o];e.stopPropagation(),i&&n[o]||this.handleBaseTreeExpand([t],a)},updateCheckboxStatus:function(){var i,a,r=this,e=r.reactData,t=r.internalData,n=r.transform,o=e.treeList,c=t.selectCheckboxMaps,u=t.indeterminateRowMaps,d=r.computeChildrenField,t=r.computeCheckboxOpts,l=t.checkStrictly,s=t.checkMethod;l||(i={},a=[],_xeUtils.default.eachTree(o,function(e){var t=r.getNodeId(e),n=e[d];n&&n.length&&!i[t]&&(i[t]=1,a.unshift([e,t,n]))},{children:n?r.computeMapChildrenField:d}),a.forEach(function(e){var t=e[0],n=e[1],i=0,a=0,o=0,e=(e[2].forEach(s?function(e){var t=r.getNodeId(e),n=c[t];s({node:e})?(n?i++:u[t]&&a++,o++):n?i++:u[t]&&a++}:function(e){e=r.getNodeId(e);c[e]?i++:u[e]&&a++,o++}),o<=i),d=!e&&(1<=i||1<=a);e?(c[n]=t,u[n]&&delete u[n]):(c[n]&&delete c[n],d?u[n]=t:u[n]&&delete u[n])}),e.updateCheckboxFlag++)},changeCheckboxEvent:function(e,t){var n,i=this,a=i,o=i.reactData,d=i.internalData,a=(e.preventDefault(),e.stopPropagation(),a.transform),r=d.selectCheckboxMaps,d=i.computeChildrenField,c=i.computeMapChildrenField,u=i.computeCheckboxOpts,l=u.checkStrictly,u=u.checkMethod,s=!!u;(s=u?!u({node:t}):s)||(u=i.getNodeId(t),n=!1,r[u]?delete r[u]:(n=!0,r[u]=t),l||_xeUtils.default.eachTree(_xeUtils.default.get(t,d),function(e){e=i.getNodeId(e);n?r[e]||(r[e]=!0):r[e]&&delete r[e]},{children:a?c:d}),o.updateCheckboxFlag++,i.updateCheckboxStatus(),s=_xeUtils.default.keys(r),i.emitCheckboxMode(s),i.dispatchEvent("checkbox-change",{node:t,value:s,checked:n},e))},changeCurrentEvent:function(e,t){var n=this.reactData,i=(e.preventDefault(),this.computeNodeOpts),a=i.currentMethod,i=i.trigger,o=this.computeChildrenField,o=_xeUtils.default.get(t,o),o=o&&o.length,d=!!a;if("child"===i){if(o)return}else if("parent"===i&&!o)return;(d=a?!a({node:t}):d)||(n.currentNode=t,this.dispatchEvent("current-change",{node:t,checked:!0},e))},changeRadioEvent:function(e,t){var n=this,i=n.reactData;e.preventDefault(),e.stopPropagation();var a=n.computeRadioOpts.checkMethod,o=!!a;(o=a?!a({node:t}):o)||(a=n.getNodeId(t),i.selectRadioKey=a,n.emitRadioMode(a),n.dispatchEvent("radio-change",{node:t,value:a,checked:!0},e))},renderRadio:function(e,t,n,i){var a=this,o=a.showRadio,d=a.computeRadioOpts,r=d.showIcon,c=d.checkMethod,d=d.visibleMethod,d=!d||d({node:t}),u=!!c;return o&&r&&d?e("div",{class:["vxe-tree--radio-option",{"is--checked":i,"is--disabled":u=c?!c({node:t}):u}],on:{click:function(e){u||a.changeRadioEvent(e,t)}}},[e("span",{class:["vxe-radio--icon",i?(0,_ui.getIcon)().RADIO_CHECKED:(0,_ui.getIcon)().RADIO_UNCHECKED]})]):(0,_ui.renderEmptyElement)(a)},renderCheckbox:function(e,t,n,i){var a=this,o=a.showCheckbox,d=a.computeCheckboxOpts,r=d.showIcon,c=d.checkMethod,d=d.visibleMethod,n=a.isIndeterminateByCheckboxNodeid(n),d=!d||d({node:t}),u=!!c;return o&&r&&d?e("div",{class:["vxe-tree--checkbox-option",{"is--checked":i,"is--indeterminate":n,"is--disabled":u=c?!c({node:t}):u}],on:{click:function(e){u||a.changeCheckboxEvent(e,t)}}},[e("span",{class:["vxe-checkbox--icon",n?(0,_ui.getIcon)().CHECKBOX_INDETERMINATE:i?(0,_ui.getIcon)().CHECKBOX_CHECKED:(0,_ui.getIcon)().CHECKBOX_UNCHECKED]})]):(0,_ui.renderEmptyElement)(a)},renderNode:function(t,n){var i=this,e=i.$scopedSlots,a=i.reactData,o=i.internalData,d=i.lazy,r=i.showRadio,c=i.showCheckbox,u=i.showLine,l=i.indent,s=i.iconOpen,h=i.iconClose,p=i.iconLoaded,f=i.showIcon,g=a.currentNode,x=a.selectRadioKey,a=a.updateExpandedFlag,C=o.nodeMaps,m=o.treeExpandedMaps,o=o.treeExpandLazyLoadedMaps,v=i.computeTitleField,k=i.computeHasChildField,y=_xeUtils.default.get(n,i.computeChildrenField),N=y&&y.length,E=e.icon,_=e.title,e=e.extra,b=i.getNodeId(n),a=a&&m[b],C=C[b],v=_xeUtils.default.get(n,v),D=!1,r=(r&&(D=b==x),!1),x=(c&&(r=i.isCheckedByCheckboxNodeId(b)),!1),c=!1,I=!1,M=(d&&(c=!!o[b],x=n[k],I=!!C.treeLoaded),[]);return N&&m[b]&&(u&&M.push(t("div",{key:"line",class:"vxe-tree--node-child-line",style:{height:"calc(".concat(C.lineCount," * var(--vxe-ui-tree-node-height) - var(--vxe-ui-tree-node-height) / 2)"),left:"".concat((C.level+1)*(l||1),"px")}})),y.forEach(function(e){M.push(i.renderNode(t,e))})),t("div",{class:["vxe-tree--node-wrapper","node--level-".concat(C.level)],attrs:{nodeid:b}},[t("div",{class:["vxe-tree--node-item",{"is--current":g&&b===i.getNodeId(g),"is-radio--checked":D,"is-checkbox--checked":r}],style:{paddingLeft:"".concat((C.level-1)*(l||1),"px")},on:{click:function(e){i.handleNodeClickEvent(e,n)},dblclick:function(e){i.handleNodeDblclickEvent(e,n)}}},[f||u?t("div",{class:"vxe-tree--node-item-switcher"},f&&(!d||I?N:x)?[t("div",{class:"vxe-tree--node-item-icon",on:{click:function(e){i.toggleExpandEvent(e,n)}}},E?E({node:n,isExpand:a}):[t("i",{class:c?p||(0,_ui.getIcon)().TREE_NODE_LOADED:a?s||(0,_ui.getIcon)().TREE_NODE_OPEN:h||(0,_ui.getIcon)().TREE_NODE_CLOSE})])]:[]):(0,_ui.renderEmptyElement)(i),i.renderRadio(t,n,b,D),i.renderCheckbox(t,n,b,r),t("div",{class:"vxe-tree--node-item-inner"},[t("div",{class:"vxe-tree--node-item-title"},_?(0,_vn.getSlotVNs)(_({node:n,isExpand:a})):"".concat(v)),e?t("div",{class:"vxe-tree--node-item-extra"},(0,_vn.getSlotVNs)(e({node:n,isExpand:a}))):(0,_ui.renderEmptyElement)(i)])]),N&&m[b]?t("div",{class:"vxe-tree--node-child-wrapper"},M):(0,_ui.renderEmptyElement)(i)])},renderNodeList:function(t){var n=this,e=n.reactData.treeList;return t("div",{class:"vxe-tree--node-list-wrapper"},e.map(function(e){return n.renderNode(t,e)}))},renderVN:function(e){var t=this,n=t.$scopedSlots,i=t.loading,a=t.trigger,o=t.showLine,d=t.computeSize,r=t.computeRadioOpts,c=t.computeCheckboxOpts,u=t.computeTreeStyle,l=t.computeLoadingOpts,s=t.computeIsRowHover,h=n.loading;return e("div",{ref:"refElem",class:["vxe-tree",_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},"size--".concat(d),d),"show--line",o),"checkbox--highlight",c.highlight),"radio--highlight",r.highlight),"node--hover",s),"node--trigger","node"===a),"is--loading",i)],style:u},[t.renderNodeList(e),e(_loading.default,{class:"vxe-tree--loading",props:{value:i,icon:l.icon,text:l.text},scopedSlots:h?{default:function(){return h({$tree:t})}}:{}})])}},watch:{data:function(e){this.loadTreeData(e||[])},checkNodeKey:function(e){this.reactData.selectRadioKey=e},checkNodeKeys:function(){this.updateCheckboxChecked(this.checkNodeKeys||[])}},created:function(){this.reactData.selectRadioKey=this.checkNodeKey||null,this.loadTreeData(this.data||[])},beforeDestroy:function(){var e=this.reactData,t=this.internalData;e.treeList=[],t.treeExpandedMaps={},t.indeterminateRowMaps={},t.nodeMaps={}},render:function(e){return this.renderVN(e)}});