Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _comp=require("../../ui/src/comp"),_xeUtils=_interopRequireDefault(require("xe-utils")),_ui=require("../../ui"),_log=require("../../ui/src/log"),_select=_interopRequireDefault(require("../../select/src/select")),_input=_interopRequireDefault(require("../../input/src/input"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}var _default2=exports.default=(0,_comp.defineVxeComponent)({name:"VxePager",mixins:[_ui.globalMixins.sizeMixin],props:{size:{type:String,default:function(){return(0,_ui.getConfig)().pager.size||(0,_ui.getConfig)().size}},layouts:{type:Array,default:function(){return(0,_ui.getConfig)().pager.layouts||["PrevJump","PrevPage","Jump","PageCount","NextPage","NextJump","Sizes","Total"]}},currentPage:{type:Number,default:1},loading:Boolean,pageSize:{type:Number,default:function(){return(0,_ui.getConfig)().pager.pageSize||10}},total:{type:Number,default:0},pagerCount:{type:Number,default:function(){return(0,_ui.getConfig)().pager.pagerCount||7}},pageSizes:{type:Array,default:function(){return(0,_ui.getConfig)().pager.pageSizes||[10,15,20,50,100]}},align:{type:String,default:function(){return(0,_ui.getConfig)().pager.align}},border:{type:Boolean,default:function(){return(0,_ui.getConfig)().pager.border}},background:{type:Boolean,default:function(){return(0,_ui.getConfig)().pager.background}},perfect:{type:Boolean,default:function(){return(0,_ui.getConfig)().pager.perfect}},autoHidden:{type:Boolean,default:function(){return(0,_ui.getConfig)().pager.autoHidden}},transfer:{type:Boolean,default:function(){return(0,_ui.getConfig)().pager.transfer}},className:[String,Function],pageSizePlacement:{type:String,default:function(){return(0,_ui.getConfig)().pager.pageSizePlacement}},iconPrevPage:String,iconJumpPrev:String,iconJumpNext:String,iconNextPage:String,iconJumpMore:String,iconHomePage:String,iconEndPage:String},inject:{$xeGrid:{default:null}},data:function(){return{xID:_xeUtils.default.uniqueId(),reactData:{inpCurrPage:1}}},computed:Object.assign(Object.assign({},{}),{computePageCount:function(){return this.getPageCount(this.total,this.pageSize)},computeNumList:function(){for(var e=this.pagerCount,t=e<this.computePageCount?e-2:e,n=[],r=0;r<t;r++)n.push(r);return n},computeOffsetNumber:function(){return Math.floor((this.pagerCount-2)/2)},computeSizeList:function(){return this.pageSizes.map(function(e){return _xeUtils.default.isNumber(e)?{value:e,label:"".concat((0,_ui.getI18n)("vxe.pager.pagesize",[e]))}:Object.assign({value:"",label:""},e)})}}),methods:{dispatchEvent:function(e,t,n){this.$emit(e,(0,_ui.createEvent)(n,{$pager:this},t))},homePage:function(){return this.handleHomePage(),this.$nextTick()},endPage:function(){return this.handleEndPage(),this.$nextTick()},prevPage:function(){return this.handlePrevPage(),this.$nextTick()},nextPage:function(){return this.handleNextPage(),this.$nextTick()},prevJump:function(){return this.handlePrevJump(),this.$nextTick()},nextJump:function(){return this.handleNextJump(),this.$nextTick()},jumpPage:function(e){var t=this.reactData,e=_xeUtils.default.toNumber(e)||1;return t.inpCurrPage=e,this.changeCurrentPage(e),this.$nextTick()},getPageCount:function(e,t){return Math.max(Math.ceil(e/t),1)},jumpPageEvent:function(e,t){this.$emit("update:currentPage",t),e&&t!==this.currentPage&&this.dispatchEvent("page-change",{type:"current",pageSize:this.pageSize,currentPage:t},e)},changeCurrentPage:function(e,t){this.$emit("update:currentPage",e),t&&e!==this.currentPage&&this.dispatchEvent("page-change",{type:"current",pageSize:this.pageSize,currentPage:e},t)},triggerJumpEvent:function(e){var t=this.reactData,e=e.$event,n=e.target,r=_xeUtils.default.toInteger(n.value),a=this.computePageCount.value,a=r<=0?1:a<=r?a:r,r=_xeUtils.default.toValueString(a);n.value=r,t.inpCurrPage=r,this.changeCurrentPage(a,e)},handleHomePage:function(e){1<this.currentPage&&this.changeCurrentPage(1,e)},handleEndPage:function(e){var t=this.currentPage,n=this.computePageCount;t<n&&this.changeCurrentPage(n,e)},handlePrevPage:function(e){var t=this.currentPage,n=this.computePageCount;1<t&&this.changeCurrentPage(Math.min(n,Math.max(t-1,1)),e)},handleNextPage:function(e){var t=this.currentPage,n=this.computePageCount;t<n&&this.changeCurrentPage(Math.min(n,t+1),e)},handlePrevJump:function(e){var t=this.computeNumList;this.changeCurrentPage(Math.max(this.currentPage-t.length,1),e)},handleNextJump:function(e){var t=this.computePageCount,n=this.computeNumList;this.changeCurrentPage(Math.min(this.currentPage+n.length,t),e)},pageSizeEvent:function(e){var t=this,n=t,r=e.value,r=_xeUtils.default.toNumber(r),a=t.getPageCount(n.total,r),n=n.currentPage;a<n&&t.$emit("update:currentPage",n=a),t.$emit("update:pageSize",r),t.dispatchEvent("page-change",{type:"size",pageSize:r,currentPage:n},e.$event)},jumpKeydownEvent:function(e){var t=e.$event;_ui.globalEvents.hasKey(t,_ui.GLOBAL_EVENT_KEYS.ENTER)?this.triggerJumpEvent(e):_ui.globalEvents.hasKey(t,_ui.GLOBAL_EVENT_KEYS.ARROW_UP)?(t.preventDefault(),this.handleNextPage(t)):_ui.globalEvents.hasKey(t,_ui.GLOBAL_EVENT_KEYS.ARROW_DOWN)&&(t.preventDefault(),this.handlePrevPage(t))},renderHomePage:function(e){var t=this,n=t,r=t.$scopedSlots,a=n.currentPage,r=r.home;return r?e("span",{class:"vxe-pager--custom-home-btn"},r({$pager:t,total:n.total,currentPage:a,pageCount:t.computePageCount})):e("button",{class:["vxe-pager--home-btn",{"is--disabled":a<=1}],attrs:{type:"button",title:(0,_ui.getI18n)("vxe.pager.homePageTitle")},on:{click:t.handleHomePage}},[e("i",{class:["vxe-pager--btn-icon",n.iconHomePage||(0,_ui.getIcon)().PAGER_HOME]})])},renderPrevPage:function(e){var t=this,n=t,r=t.$scopedSlots,a=n.currentPage,r=r.prevPage||r["prev-page"];return r?e("span",{class:"vxe-pager--custom-prev-btn"},r({$pager:t,total:n.total,currentPage:a,pageCount:t.computePageCount})):e("button",{class:["vxe-pager--prev-btn",{"is--disabled":a<=1}],attrs:{type:"button",title:(0,_ui.getI18n)("vxe.pager.prevPageTitle")},on:{click:t.handlePrevPage}},[e("i",{class:["vxe-pager--btn-icon",n.iconPrevPage||(0,_ui.getIcon)().PAGER_PREV_PAGE]})])},renderPrevJump:function(e,t){var n=this,r=n,a=n.$scopedSlots,u=r.currentPage,a=a.prevJump||a["prev-jump"];return a?e("span",{class:"vxe-pager--custom-jump-prev"},a({$pager:n,total:r.total,currentPage:u,pageCount:n.computePageCount})):e(t||"button",{class:["vxe-pager--jump-prev",{"is--fixed":!t,"is--disabled":u<=1}],attrs:{type:"button",title:(0,_ui.getI18n)("vxe.pager.prevJumpTitle")},on:{click:n.handlePrevJump}},[t?e("i",{class:["vxe-pager--jump-more-icon",r.iconJumpMore||(0,_ui.getIcon)().PAGER_JUMP_MORE]}):null,e("i",{class:["vxe-pager--jump-icon",r.iconJumpPrev||(0,_ui.getIcon)().PAGER_JUMP_PREV]})])},renderNextJump:function(e,t){var n=this,r=n,a=n.$scopedSlots,u=r.currentPage,a=a.nextJump||a["next-jump"],i=n.computePageCount;return a?e("span",{class:"vxe-pager--custom-jump-next"},a({$pager:n,total:r.total,currentPage:u,pageCount:i})):e(t||"button",{class:["vxe-pager--jump-next",{"is--fixed":!t,"is--disabled":i<=u}],attrs:{type:"button",title:(0,_ui.getI18n)("vxe.pager.nextJumpTitle")},on:{click:n.handleNextJump}},[t?e("i",{class:["vxe-pager--jump-more-icon",r.iconJumpMore||(0,_ui.getIcon)().PAGER_JUMP_MORE]}):null,e("i",{class:["vxe-pager--jump-icon",r.iconJumpNext||(0,_ui.getIcon)().PAGER_JUMP_NEXT]})])},renderNextPage:function(e){var t=this,n=t,r=t.$scopedSlots,a=n.currentPage,r=r.nextPage||r["next-page"],u=t.computePageCount;return r?e("span",{class:"vxe-pager--custom-next-btn"},r({$pager:t,total:n.total,currentPage:a,pageCount:u})):e("button",{class:["vxe-pager--next-btn",{"is--disabled":u<=a}],attrs:{type:"button",title:(0,_ui.getI18n)("vxe.pager.nextPageTitle")},on:{click:t.handleNextPage}},[e("i",{class:["vxe-pager--btn-icon",n.iconNextPage||(0,_ui.getIcon)().PAGER_NEXT_PAGE]})])},renderEndPage:function(e){var t=this,n=t,r=t.$scopedSlots,a=n.currentPage,r=r.end,u=t.computePageCount;return r?e("span",{class:"vxe-pager--custom-end-btn"},r({$pager:t,total:n.total,currentPage:a,pageCount:u})):e("button",{class:["vxe-pager--end-btn",{"is--disabled":u<=a}],attrs:{type:"button",title:(0,_ui.getI18n)("vxe.pager.endPageTitle")},on:{click:t.handleEndPage}},[e("i",{class:["vxe-pager--btn-icon",n.iconEndPage||(0,_ui.getIcon)().PAGER_END]})])},renderNumber:function(r,e){var a=this,t=a.$scopedSlots,u=a.currentPage,n=a.total,t=e?t.numberJump||t["number-jump"]:t.number,i=[],o=a.computePageCount,p=a.computeNumList,s=a.computeOffsetNumber,g=a.pagerCount<o,c=g&&s+1<u,l=g&&u<o-s,m=[],P=1;return g&&(P=o-s<=u?Math.max(o-p.length+1,1):Math.max(u-s,1)),e&&c&&(m.push(1),i.push(r("button",{class:"vxe-pager--num-btn",attrs:{type:"button"},on:{click:function(e){return a.jumpPageEvent(e,1)}}},"1"),a.renderPrevJump(r,"span"))),p.forEach(function(e,t){var n=P+t;n<=o&&(m.push(n),i.push(r("button",{key:n,class:["vxe-pager--num-btn",{"is--active":u===n}],attrs:{type:"button"},on:{click:function(e){return a.jumpPageEvent(e,n)}}},"".concat(n))))}),e&&l&&(m.push(o),i.push(a.renderNextJump(r,"button"),r("button",{class:"vxe-pager--num-btn",attrs:{type:"button"},on:{click:function(e){return a.jumpPageEvent(e,o)}}},o))),t?r("span",{class:"vxe-pager--custom-btn-wrapper"},t({$pager:a,total:n,numList:m,currentPage:u,pageCount:o})):r("span",{class:"vxe-pager--btn-wrapper"},i)},renderJumpNumber:function(e){return this.renderNumber(e,!0)},renderSizes:function(e){var t=this,n=t.$scopedSlots,r=t.currentPage,a=t.pageSize,u=t.pageSizePlacement,i=t.transfer,n=n.sizes,o=t.computeSizeList;return n?e("span",{class:"vxe-pager--custom-sizes"},n({$pager:t,total:t.total,currentPage:r,pageCount:t.computePageCount,pageSize:a,options:o})):e(_select.default,{class:"vxe-pager--sizes",props:{value:a,placement:u,transfer:i,options:o},on:{change:t.pageSizeEvent}})},renderJump:function(e,t){var n=this,r=n.reactData,a=n.$scopedSlots,u=n.total,i=r.inpCurrPage,a=t?a.fullJump||a["full-jump"]:a.jump,o=n.computePageCount;return a?e("span",{class:"vxe-pager--custom-jump"},a({$pager:n,total:u,currentPage:i,pageCount:o})):e("span",{class:"vxe-pager--jump"},[t?e("span",{class:"vxe-pager--goto-text"},(0,_ui.getI18n)("vxe.pager.goto")):null,e(_input.default,{class:"vxe-pager--goto",props:{value:i,placeholder:(0,_ui.getI18n)("vxe.pager.gotoTitle"),align:"center",type:"integer",max:o,min:1,controls:!1},on:{keydown:n.jumpKeydownEvent,blur:n.triggerJumpEvent,modelValue:function(e){r.inpCurrPage=e}}}),t?e("span",{class:"vxe-pager--classifier-text"},(0,_ui.getI18n)("vxe.pager.pageClassifier")):null])},renderFullJump:function(e){return this.renderJump(e,!0)},renderPageCount:function(e){var t=this.$scopedSlots,n=this.currentPage,r=this.total,t=t.pageCount||t["page-count"],a=this.computePageCount;return t?e("span",{class:"vxe-pager--custom-count"},t({$pager:this,total:r,currentPage:n,pageCount:a})):e("span",{class:"vxe-pager--count"},[e("span",{class:"vxe-pager--separator"}),e("span",a)])},renderTotal:function(e){var t=this.$scopedSlots,n=this.total,r=this.currentPage,t=t.total,a=this.computePageCount;return t?e("span",{class:"vxe-pager--custom-total"},t({$pager:this,total:n,currentPage:r,pageCount:a})):e("span",{class:"vxe-pager--total"},(0,_ui.getI18n)("vxe.pager.total",[n]))},renderVN:function(n){var r=this,e=r,t=r.$scopedSlots,a=r.$xeGrid,u=e.align,i=e.layouts,o=e.className,p=[],s=r.computeSize,g=r.computePageCount;return t.left&&p.push(n("span",{class:"vxe-pager--left-wrapper"},t.left({$grid:a}))),i.forEach(function(e){var t;switch(e){case"Home":t=r.renderHomePage;break;case"PrevJump":t=r.renderPrevJump;break;case"PrevPage":t=r.renderPrevPage;break;case"Number":t=r.renderNumber;break;case"JumpNumber":t=r.renderJumpNumber;break;case"NextPage":t=r.renderNextPage;break;case"NextJump":t=r.renderNextJump;break;case"End":t=r.renderEndPage;break;case"Sizes":t=r.renderSizes;break;case"FullJump":t=r.renderFullJump;break;case"Jump":t=r.renderJump;break;case"PageCount":t=r.renderPageCount;break;case"Total":t=r.renderTotal}t?p.push(t(n)):(0,_log.errLog)("vxe.error.notProp",["layouts -> ".concat(e)])}),t.right&&p.push(n("span",{class:"vxe-pager--right-wrapper"},t.right({$grid:a}))),n("div",{ref:"refElem",class:["vxe-pager",o?_xeUtils.default.isFunction(o)?o({$pager:r}):o:"",_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},"size--".concat(s),s),"align--".concat(u),u),"is--border",e.border),"is--background",e.background),"is--perfect",e.perfect),"is--hidden",e.autoHidden&&1===g),"is--loading",e.loading)]},[n("div",{class:"vxe-pager--wrapper"},p)])}},watch:{currentPage:function(e){this.reactData.inpCurrPage=e}},created:function(){this.reactData.inpCurrPage=this.currentPage},render:function(e){return this.renderVN(e)}});