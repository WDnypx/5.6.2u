Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils")),_utils=require("../../ui/src/utils"),_dom=require("../../ui/src/dom"),_util=require("./util"),_ui=require("../../ui"),_methods=_interopRequireDefault(require("./methods")),_body=_interopRequireDefault(require("./body")),_header=_interopRequireDefault(require("./header")),_footer=_interopRequireDefault(require("./footer")),_props=_interopRequireDefault(require("./props")),_vn=require("../../ui/src/vn"),_log=require("../../ui/src/log"),_panel=_interopRequireDefault(require("../module/custom/panel")),_panel2=_interopRequireDefault(require("../module/filter/panel")),_importPanel=_interopRequireDefault(require("../module/export/import-panel")),_exportPanel=_interopRequireDefault(require("../module/export/export-panel")),_panel3=_interopRequireDefault(require("../module/menu/panel")),_mixin=_interopRequireDefault(require("../module/filter/mixin")),_mixin2=_interopRequireDefault(require("../module/menu/mixin")),_mixin3=_interopRequireDefault(require("../module/edit/mixin")),_mixin4=_interopRequireDefault(require("../module/export/mixin")),_mixin5=_interopRequireDefault(require("../module/keyboard/mixin")),_mixin6=_interopRequireDefault(require("../module/validator/mixin")),_mixin7=_interopRequireDefault(require("../module/custom/mixin"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}let{getConfig,getIcon,getI18n,renderer,globalResize,globalEvents,globalMixins,renderEmptyElement}=_ui.VxeUI;function handleKeyField(e){var t=e,e=e.computeRowField;t.currKeyField=e,t.isCurrDeepKey=(0,_util.hasDeepKey)(e)}function renderFixed(e,t,r){var{showHeader:o,showFooter:l}=t,{tableData:i,tableColumn:n,tableGroupColumn:a,columnStore:s,footerTableData:u}=t,p="left"===r,s=p?s.leftList:s.rightList;return e("div",{ref:p?"refLeftContainer":"refRightContainer",class:`vxe-table--fixed-${r}-wrapper`},[o?e(_header.default,{props:{fixedType:r,tableData:i,tableColumn:n,tableGroupColumn:a,fixedColumn:s},ref:r+"Header"}):renderEmptyElement(t),e(_body.default,{props:{fixedType:r,tableData:i,tableColumn:n,fixedColumn:s},ref:r+"Body"}),l?e(_footer.default,{props:{footerTableData:u,tableColumn:n,fixedColumn:s,fixedType:r},ref:r+"Footer"}):renderEmptyElement(t)])}function renderEmptyBody(e,t){var{$scopedSlots:r,emptyOpts:o}=t;let l="";var i={$table:t};return l=r.empty?r.empty.call(t,i,e):(r=(r=o.name?renderer.get(o.name):null)?r.renderTableEmpty||r.renderTableEmptyView||r.renderEmpty:null)?(0,_vn.getSlotVNs)(r.call(t,e,o,i)):(0,_utils.getFuncText)(t.emptyText)||getI18n("vxe.table.emptyText")}let renderDragTipContents=(e,t)=>{var r=t.dragConfig,{dragRow:o,dragCol:l,dragTipText:i}=t,n=t.computeColumnDragOpts,r=(t.computeRowDragOpts.slots||{}).tip||(r&&r.slots?r.slots.rowTip:null),n=(n.slots||{}).tip;return o&&r?t.callSlot(r,{row:o},e):l&&n?t.callSlot(n,{column:l},e):[e("span",i)]},renderDragTip=(e,t)=>{var{dragRow:r,dragCol:o}=t,l=t.computeRowOpts,i=t.computeRowDragOpts,n=t.computeColumnDragOpts;return l.drag||t.computeColumnOpts.drag?e("div",{class:"vxe-table--drag-wrapper"},[e("div",{ref:"refDragRowLineElem",class:["vxe-table--drag-row-line",{"is--guides":i.showGuidesStatus}]}),e("div",{ref:"refDragColLineElem",class:["vxe-table--drag-col-line",{"is--guides":n.showGuidesStatus}]}),r&&i.showDragTip||o&&n.showDragTip?e("div",{ref:"refDragTipElem",class:"vxe-table--drag-sort-tip"},[e("div",{class:"vxe-table--drag-sort-tip-wrapper"},[e("div",{class:"vxe-table--drag-sort-tip-status"},[e("span",{class:["vxe-table--drag-sort-tip-normal-status",r?getIcon().TABLE_DRAG_STATUS_ROW:getIcon().TABLE_DRAG_STATUS_COLUMN]}),e("span",{class:["vxe-table--drag-sort-tip-sub-status",getIcon().TABLE_DRAG_STATUS_SUB_ROW]}),e("span",{class:["vxe-table--drag-sort-tip-disabled-status",getIcon().TABLE_DRAG_DISABLED]})]),e("div",{class:"vxe-table--drag-sort-tip-content"},renderDragTipContents(e,t))])]):renderEmptyElement(t)]):renderEmptyElement(t)};function handleUpdateResize(e){var t=e.$el;t&&t.clientWidth&&t.clientHeight&&e.recalculate()}function renderRowExpandedVNs(C,w){let O=w,y=w.$xeGrid,_=w.treeConfig,{expandColumn:E,isRowGroupStatus:S}=w;var e=w.computeTableRowExpandedList,t=w.computeExpandOpts.mode;if("fixed"!==t)return renderEmptyElement(w);let L=[C("div",{key:"repY",ref:"refRowExpandYSpaceElem"})];if(E){let v=(0,_util.createHandleGetRowId)(w).handleGetRowId;e.forEach(e=>{var{height:t,padding:r,indent:o}=w.computeExpandOpts,{fullAllDataRowIdData:l,fullColumnIdData:i}=O,n=w.computeTreeOpts,{transform:a,seqMode:s}=n,u={},p=v(e),l=l[p],i=i[E.id]||{};let g=0,d=-1,c=-1,m=-1,f=-1,h=(l&&(g=l.level,d=S||_&&a&&"increasing"===s?l._index+1:l.seq,m=l.index,f=l.$index,c=l._index),t&&(u.height=t+"px"),(S||_)&&(u.paddingLeft=g*(_xeUtils.default.isNumber(o)?o:n.indent)+30+"px"),-1),b=-1,x=-1;i&&(h=i.index,b=i.$index,x=i._index);a={$grid:y,$table:w,seq:d,column:E,columnIndex:h,$columnIndex:b,_columnIndex:x,fixed:"",type:"body",level:g,rowid:p,row:e,rowIndex:m,$rowIndex:f,_rowIndex:c,isHidden:!1,isEdit:!1,visibleData:[],data:[],items:[]};L.push(C("div",{key:p,class:["vxe-body--row-expanded-cell",{"is--padding":r,"is--ellipsis":t}],attrs:{rowid:p},style:u},E.renderData(C,a)))})}return C("div",{ref:"refRowExpandElem",class:"vxe-table--row-expanded-wrapper"},L)}function renderScrollX(e,t){return e("div",{key:"vsx",ref:"refScrollXVirtualElem",class:"vxe-table--scroll-x-virtual"},[e("div",{ref:"refScrollXLeftCornerElem",class:"vxe-table--scroll-x-left-corner"}),e("div",{ref:"refScrollXWrapperElem",class:"vxe-table--scroll-x-wrapper"},[e("div",{ref:"refScrollXHandleElem",class:"vxe-table--scroll-x-handle",on:{scroll:t.triggerVirtualScrollXEvent}},[e("div",{ref:"refScrollXSpaceElem",class:"vxe-table--scroll-x-space"})])]),e("div",{ref:"refScrollXRightCornerElem",class:"vxe-table--scroll-x-right-corner"})])}function renderScrollY(e,t){return e("div",{ref:"refScrollYVirtualElem",class:"vxe-table--scroll-y-virtual"},[e("div",{ref:"refScrollYTopCornerElem",class:"vxe-table--scroll-y-top-corner"}),e("div",{ref:"refScrollYWrapperElem",class:"vxe-table--scroll-y-wrapper"},[e("div",{ref:"refScrollYHandleElem",class:"vxe-table--scroll-y-handle",on:{scroll:t.triggerVirtualScrollYEvent}},[e("div",{ref:"refScrollYSpaceElem",class:"vxe-table--scroll-y-space"})])]),e("div",{ref:"refScrollYBottomCornerElem",class:"vxe-table--scroll-y-bottom-corner"})])}function renderViewport(e,t){var{showHeader:r,showFooter:o}=t,{overflowX:l,tableData:i,tableColumn:n,tableGroupColumn:a,footerTableData:s,columnStore:u}=t,{leftList:u,rightList:p}=u;return e("div",{ref:"refTableViewportElem",class:"vxe-table--viewport-wrapper"},[e("div",{class:"vxe-table--main-wrapper"},[r?e(_header.default,{ref:"refTableHeader",props:{tableData:i,tableColumn:n,tableGroupColumn:a}}):renderEmptyElement(t),e(_body.default,{ref:"refTableBody",props:{tableData:i,tableColumn:n}}),o?e(_footer.default,{ref:"refTableFooter",props:{footerTableData:s,tableColumn:n}}):renderEmptyElement(t)]),e("div",{class:"vxe-table--fixed-wrapper"},[u&&u.length&&l?renderFixed(e,t,"left"):renderEmptyElement(t),p&&p.length&&l?renderFixed(e,t,"right"):renderEmptyElement(t)]),renderRowExpandedVNs(e,t)])}function renderBody(e,t){return e("div",{class:"vxe-table--layout-wrapper"},t.computeScrollbarYToLeft?[renderScrollY(e,t),renderViewport(e,t)]:[renderViewport(e,t),renderScrollY(e,t)])}var _default=exports.default={name:"VxeTable",mixins:[globalMixins.sizeMixin,_mixin.default,_mixin2.default,_mixin3.default,_mixin4.default,_mixin5.default,_mixin6.default,_mixin7.default],props:_props.default,provide(){return{$xeTable:this,xecolgroup:null}},inject:{$xeTabs:{default:null},$xeGrid:{default:null}},data(){var e=_xeUtils.default.uniqueId();return{xID:e,tId:e,staticColumns:[],tableGroupColumn:[],tableColumn:[],tableData:[],scrollXLoad:!1,scrollYLoad:!1,overflowY:!0,overflowX:!1,scrollbarWidth:0,scrollbarHeight:0,rowHeight:0,parentHeight:0,isGroup:!1,isAllOverflow:!1,isAllSelected:!1,isIndeterminate:!1,currentRow:null,currentColumn:null,selectRadioRow:null,footerTableData:[],rowGroupColumn:null,expandColumn:null,hasFixedColumn:!1,treeNodeColumn:null,initStore:{filter:!1,import:!1,export:!1,custom:!1},customColumnList:[],upDataFlag:0,reColumnFlag:0,customStore:{btnEl:null,isAll:!1,isIndeterminate:!1,activeBtn:!1,activeWrapper:!1,visible:!1,maxHeight:0,oldSortMaps:{},oldFixedMaps:{},oldVisibleMaps:{}},filterStore:{isAllSelected:!1,isIndeterminate:!1,style:null,options:[],column:null,multiple:!1,visible:!1,maxHeight:null},columnStore:{leftList:[],centerList:[],rightList:[],resizeList:[],pxList:[],pxMinList:[],autoMinList:[],scaleList:[],scaleMinList:[],autoList:[],remainList:[]},ctxMenuStore:{selected:null,visible:!1,showChild:!1,selectChild:null,list:[],style:null},editStore:{indexs:{columns:[]},titles:{columns:[]},selected:{row:null,column:null},copyed:{cut:!1,rows:[],columns:[]},actived:{row:null,column:null},focused:{row:null,column:null}},tooltipStore:{row:null,column:null,visible:!1,currOpts:{}},validStore:{visible:!1},validErrorMaps:{},importStore:{inited:!1,file:null,type:"",modeList:[],typeList:[],filename:"",visible:!1},importParams:{mode:"",types:null,message:!0},exportStore:{inited:!1,name:"",modeList:[],typeList:[],columns:[],isPrint:!1,hasFooter:!1,hasTree:!1,hasMerge:!1,hasColgroup:!1,visible:!1},exportParams:{filename:"",sheetName:"",mode:"",type:"",isColgroup:!1,isMerge:!1,isAllExpand:!1,useStyle:!1,original:!1,message:!0,isHeader:!1,isTitle:!1,isFooter:!1},visiblwRowsFlag:1,isRowGroupStatus:!1,rowGroupExpandedFlag:1,rowExpandedFlag:1,treeExpandedFlag:1,updateCheckboxFlag:1,pendingRowFlag:1,insertRowFlag:1,removeRowFlag:1,mergeBodyFlag:1,mergeFootFlag:1,rowHeightStore:{large:52,default:48,medium:44,small:40,mini:36},scrollVMLoading:!1,scrollYHeight:0,scrollYTop:0,isScrollYBig:!1,scrollXLeft:0,scrollXWidth:0,isScrollXBig:!1,rowExpandHeightFlag:1,calcCellHeightFlag:1,resizeHeightFlag:1,resizeWidthFlag:1,isCustomStatus:!1,isDragRowMove:!1,dragRow:null,isDragColMove:!1,dragCol:null,dragTipText:"",isDragResize:!1,isRowLoading:!1,isColLoading:!1,reScrollFlag:0,reLayoutFlag:0,footFlag:0}},computed:Object.assign(Object.assign({},{}),{tableId(){return this.computeTableId},computeTableId(){var e=this.id;return e?_xeUtils.default.isFunction(e)?""+(e({$table:this})||""):""+e:""},computeRowField(){var e=this.computeRowOpts;return""+(this.rowId||e.keyField||"_X_ROW_KEY")},validOpts(){return this.computeValidOpts},computeValidOpts(){return Object.assign({message:"default"},getConfig().table.validConfig,this.validConfig)},sXOpts(){return this.computeVirtualXOpts},computeSXOpts(){return this.computeVirtualXOpts},computeScrollXThreshold(){var e=this.computeVirtualXOpts.threshold;return e?_xeUtils.default.toNumber(e):0},sYOpts(){return this.computeVirtualYOpts},computeSYOpts(){return this.computeVirtualYOpts},computeVirtualXOpts(){return Object.assign({},getConfig().table.virtualXConfig||getConfig().table.scrollX,this.virtualXConfig||this.scrollX)},computeVirtualYOpts(){return Object.assign({},getConfig().table.virtualYConfig||getConfig().table.scrollY,this.virtualYConfig||this.scrollY)},computeScrollbarOpts(){return Object.assign({},getConfig().table.scrollbarConfig,this.scrollbarConfig)},computeScrollbarXToTop(){var e=this.computeScrollbarOpts;return!(!e.x||"top"!==e.x.position)},computeScrollbarYToLeft(){var e=this.computeScrollbarOpts;return!(!e.y||"left"!==e.y.position)},computeScrollYThreshold(){var e=this.computeVirtualYOpts.threshold;return e?_xeUtils.default.toNumber(e):0},rowHeightMaps(){return this.computeRowHeightMaps},computeRowHeightMaps(){return this.rowHeightStore},computeDefaultRowHeight(){var e=this.computeSize;return this.computeRowHeightMaps[e||"default"]||18},columnOpts(){return this.computeColumnOpts},computeColumnOpts(){return Object.assign({},getConfig().table.columnConfig,this.columnConfig)},computeCurrentColumnOpts(){return Object.assign({},getConfig().table.currentColumnConfig,this.currentColumnConfig)},computeCellOpts(){var e=Object.assign({},getConfig().table.cellConfig,this.cellConfig);return e.height&&(e.height=_xeUtils.default.toNumber(e.height)),e},computeHeaderCellOpts(){var e=Object.assign({},getConfig().table.headerCellConfig,this.headerCellConfig),t=this.computeCellOpts;return e.height=_xeUtils.default.toNumber((0,_util.getCellHeight)(e.height||t.height)),e},computeFooterCellOpts(){var e=Object.assign({},getConfig().table.footerCellConfig,this.footerCellConfig),t=this.computeCellOpts;return e.height=_xeUtils.default.toNumber((0,_util.getCellHeight)(e.height||t.height)),e},rowOpts(){return this.computeRowOpts},computeRowOpts(){return Object.assign({},getConfig().table.rowConfig,this.rowConfig)},computeAggregateOpts(){return Object.assign({},getConfig().table.aggregateConfig||getConfig().table.rowGroupConfig,this.aggregateConfig||this.rowGroupConfig)},computeRowGroupOpts(){return this.computeAggregateOpts},computeCurrentRowOpts(){return Object.assign({},getConfig().table.currentRowConfig,this.currentRowConfig)},computeRowDragOpts(){return Object.assign({},getConfig().table.rowDragConfig,this.rowDragConfig)},computeColumnDragOpts(){return Object.assign({},getConfig().table.columnDragConfig,this.columnDragConfig)},resizeOpts(){return this.computeResizeOpts},computeResizeOpts(){return Object.assign({},getConfig().table.resizeConfig,this.resizeConfig)},resizableOpts(){return this.computeResizableOpts},computeResizableOpts(){return Object.assign({},getConfig().table.resizableConfig,this.resizableConfig)},seqOpts(){return this.computeSeqOpts},computeSeqOpts(){return Object.assign({startIndex:0},getConfig().table.seqConfig,this.seqConfig)},radioOpts(){return this.computeRadioOpts},computeRadioOpts(){return Object.assign({},getConfig().table.radioConfig,this.radioConfig)},checkboxOpts(){return this.computeCheckboxOpts},computeCheckboxOpts(){return Object.assign({},getConfig().table.checkboxConfig,this.checkboxConfig)},tooltipOpts(){return this.computeTooltipOpts},computeTooltipOpts(){return Object.assign({},getConfig().tooltip,getConfig().table.tooltipConfig,this.tooltipConfig)},tipConfig(){return Object.assign({},this.tooltipOpts)},computeTableTipConfig(){var e=this.tooltipStore,t=this.computeTooltipOpts;return Object.assign({},t,e.currOpts)},computeValidTipConfig(){var e=this.computeTooltipOpts;return Object.assign({},e)},validTipOpts(){return Object.assign({isArrow:!1},this.tooltipOpts)},editOpts(){return this.computeEditOpts},computeEditOpts(){return Object.assign({},getConfig().table.editConfig,this.editConfig)},sortOpts(){return this.computeSortOpts},computeSortOpts(){return Object.assign({orders:["asc","desc",null]},getConfig().table.sortConfig,this.sortConfig)},filterOpts(){return this.computeFilterOpts},computeFilterOpts(){return Object.assign({},getConfig().table.filterConfig,this.filterConfig)},mouseOpts(){return this.computeMouseOpts},computeMouseOpts(){return Object.assign({},getConfig().table.mouseConfig,this.mouseConfig)},areaOpts(){return this.computeAreaOpts},computeAreaOpts(){return Object.assign({},getConfig().table.areaConfig,this.areaConfig)},keyboardOpts(){return this.computeKeyboardOpts},computeKeyboardOpts(){return Object.assign({},getConfig().table.keyboardConfig,this.keyboardConfig)},clipOpts(){return this.computeClipOpts},computeClipOpts(){return Object.assign({},getConfig().table.clipConfig,this.clipConfig)},fnrOpts(){return this.computeFNROpts},computeFNROpts(){return Object.assign({},getConfig().table.fnrConfig,this.fnrConfig)},headerCtxMenu(){return this.computeHeaderMenu},computeHeaderMenu(){var e=this.computeMenuOpts.header;return e&&e.options?e.options:[]},bodyCtxMenu(){return this.computeBodyMenu},computeBodyMenu(){var e=this.computeMenuOpts.body;return e&&e.options?e.options:[]},footerCtxMenu(){return this.computeFooterMenu},computeFooterMenu(){var e=this.computeMenuOpts.footer;return e&&e.options?e.options:[]},isCtxMenu(){return this.computeIsMenu},computeIsMenu(){var e=this,t=e.computeMenuOpts,r=e.computeHeaderMenu,o=e.computeBodyMenu,l=e.computeFooterMenu;return!(!e.contextMenu&&!e.menuConfig||!(0,_utils.isEnableConf)(t)||!(r.length||o.length||l.length))},ctxMenuList(){return this.computeMenuList},computeMenuList(){var e=this.ctxMenuStore;let t=[];return e.list.forEach(e=>{e.forEach(e=>{t.push(e)})}),t},ctxMenuOpts(){return this.computeMenuOpts},computeMenuOpts(){return Object.assign({},getConfig().table.menuConfig,this.contextMenu,this.menuConfig)},computeLeftFixedWidth(){var e=this.columnStore,t=e.leftList;let r=0;for(let e=0;e<t.length;e++){var o=t[e];r+=o.renderWidth}return r},computeRightFixedWidth(){var e=this.columnStore,t=e.rightList;let r=0;for(let e=0;e<t.length;e++){var o=t[e];r+=o.renderWidth}return r},exportOpts(){return this.computeExportOpts},computeExportOpts(){return Object.assign({},getConfig().table.exportConfig,this.exportConfig)},importOpts(){return this.computeImportOpts},computeImportOpts(){return Object.assign({},getConfig().table.importConfig,this.importConfig)},printOpts(){return this.computePrintOpts},computePrintOpts(){return Object.assign({},getConfig().table.printConfig,this.printConfig)},expandOpts(){return this.computeExpandOpts},computeExpandOpts(){return Object.assign({},getConfig().table.expandConfig,this.expandConfig)},treeOpts(){return this.computeTreeOpts},computeTreeOpts(){return Object.assign({},getConfig().table.treeConfig,this.treeConfig)},emptyOpts(){return this.computeEmptyOpts},computeEmptyOpts(){return Object.assign({},getConfig().table.emptyRender,this.emptyRender)},loadingOpts(){return this.computeLoadingOpts},computeLoadingOpts(){return Object.assign({},getConfig().table.loadingConfig,this.loadingConfig)},computeCellOffsetWidth(){return this.border?Math.max(2,Math.ceil(this.scrollbarWidth/this.tableColumn.length)):1},customOpts(){return this.computeCustomOpts},computeCustomOpts(){return Object.assign({},getConfig().table.customConfig,this.customConfig)},computeTableRowExpandedList(){var e=this.treeConfig,{rowExpandedFlag:t,expandColumn:r,rowGroupExpandedFlag:o,treeExpandedFlag:l,isRowGroupStatus:i}=this;let{visibleDataRowIdData:n,rowExpandedMaps:a}=this;var s=this.computeTreeOpts.transform;let u=[];if(r&&t&&o&&l){if(!(i||e&&s))return _xeUtils.default.values(a);_xeUtils.default.each(a,(e,t)=>{n[t]&&u.push(e)})}return u},computeAutoWidthColumnList(){var{tableColumn:e,visibleColumn:t}=this;return e.length||t.length?t.filter(e=>"auto"===e.width||"auto"===e.minWidth):[]},computeFixedColumnSize(){var e=this.tableColumn,t=this.collectColumn;let r=0;return e.length&&t.length&&t.forEach(e=>{e.renderFixed&&r++}),r},fixedColumnSize(){return this.computeFixedColumnSize},computeIsMaxFixedColumn(){var e=this.computeFixedColumnSize,t=this.columnOpts.maxFixedSize;return!!t&&t<=e},computeTableBorder(){var e=this.border;return!0===e?"full":e||"default"},isAllCheckboxDisabled(){var{tableFullData:e,tableData:t,checkboxOpts:r}=this;let{strict:o,checkMethod:l}=r;return!!o&&(!t.length&&!e.length||!!l&&e.every(e=>!l({row:e})))},computeVirtualScrollBars(){var{overflowX:e,scrollXLoad:t,overflowY:r,scrollYLoad:o}=this;return{x:e&&t,y:r&&o}},computeRowGroupFields(){return this.computeAggregateOpts.groupFields},tabsResizeFlag(){var e=this.$xeTabs;return e?e.reactData.resizeFlag:null},computeVxeLanguage(){return _ui.VxeUI.getLanguage()}}),watch:{data(e){let l=this,i=l,n=this.initStatus;e&&5e4<=e.length&&(0,_log.warnLog)("vxe.error.errLargeData",["loadData(data), reloadData(data)"]),this.loadTableData(e||[],!1).then(()=>{var{scrollXLoad:e,scrollYLoad:t,expandColumn:r}=i,o=l.computeExpandOpts;this.inited=!0,this.initStatus=!0,n||this.handleLoadDefaults(),(e||t)&&r&&"fixed"!==o.mode&&(0,_log.warnLog)("vxe.error.scrollErrProp",["column.type=expand"]),this.recalculate()})},staticColumns(e){this.handleColumn(_xeUtils.default.clone(e))},tableColumn(){this.analyColumnWidth()},upDataFlag(){this.$nextTick().then(()=>this.updateData())},reColumnFlag(){this.$nextTick().then(()=>this.refreshColumn())},computeSize(){this.reScrollFlag++},showHeader(){this.reScrollFlag++},showFooter(){this.reScrollFlag++},overflowX(){this.reScrollFlag++},overflowY(){this.reScrollFlag++},reScrollFlag(){let e=this;e.$nextTick(()=>{e.recalculate(!0).then(()=>e.refreshScroll())})},height(){this.reLayoutFlag++},maxHeight(){this.reLayoutFlag++},computeScrollbarXToTop(){this.reLayoutFlag++},computeScrollbarYToLeft(){this.reLayoutFlag++},computeVxeLanguage(){this.reLayoutFlag++},reLayoutFlag(){let e=this;e.$nextTick(()=>e.recalculate(!0))},footerData(){this.footFlag++},footFlag(){this.updateFooter()},syncResize(e){e&&(handleUpdateResize(this),this.$nextTick(()=>{handleUpdateResize(this),setTimeout(()=>handleUpdateResize(this))}))},tabsResizeFlag(){this.handleGlobalResizeEvent()},mergeCells(e){this.clearMergeCells(),this.$nextTick(()=>this.setMergeCells(e))},mergeFooterItems(e){this.clearMergeFooterItems(),this.$nextTick(()=>this.setMergeFooterItems(e))},computeRowGroupFields(e){this.handleUpdateRowGroup(e)},computeRowField(){let e=this;var t=e;let{inited:r,tableFullData:o}=e;r&&(handleKeyField(e),t.tableData=[],e.$nextTick(()=>{e.reloadData(o)}))}},created(){var e=this,t=e,r=e;Object.assign(e,{tZindex:0,currKeyField:"",isCurrDeepKey:!1,elemStore:{},scrollXStore:{preloadSize:0,offsetSize:0,visibleSize:0,visibleStartIndex:0,visibleEndIndex:0,startIndex:0,endIndex:0},scrollYStore:{preloadSize:0,offsetSize:0,visibleSize:0,visibleStartIndex:0,visibleEndIndex:0,startIndex:0,endIndex:0},tableWidth:0,tableHeight:0,headerHeight:0,footerHeight:0,lastScrollLeft:0,lastScrollTop:0,radioReserveRow:null,checkboxReserveRowMap:{},rowExpandedReserveRowMap:{},treeExpandedReserveRowMap:{},treeIndeterminateRowMaps:{},tableFullData:[],afterFullData:[],afterTreeFullData:[],afterGroupFullData:[],afterFullRowMaps:{},tableFullTreeData:[],tableFullGroupData:[],tableSynchData:[],tableSourceData:[],collectColumn:[],tableFullColumn:[],visibleColumn:[],fullAllDataRowIdData:{},fullDataRowIdData:{},visibleDataRowIdData:{},sourceDataRowIdData:{},fullColumnIdData:{},fullColumnFieldData:{},mergeBodyList:[],mergeBodyMaps:{},mergeFooterList:[],mergeFooterMaps:{},mergeBodyCellMaps:{},mergeFooterCellMaps:{},rowExpandedMaps:{},rowExpandLazyLoadedMaps:{},rowGroupExpandedMaps:{},treeExpandedMaps:{},treeExpandLazyLoadedMaps:{},selectCheckboxMaps:{},pendingRowMaps:{},insertRowMaps:{},removeRowMaps:{},cvCacheMaps:{},swYSize:0,swYInterval:0,swYTotal:0}),handleKeyField(e);let{data:o,exportConfig:l,importConfig:i,treeConfig:n,showOverflow:a,highlightCurrentRow:s,highlightCurrentColumn:u}=t;var{scrollXStore:r,scrollYStore:p}=r,g=e.computeColumnOpts,d=e.computeEditOpts,c=e.computeTreeOpts,m=e.computeRadioOpts,f=e.computeCheckboxOpts,h=e.computeExpandOpts,b=e.computeRowOpts,x=e.computeCustomOpts,v=e.computeMouseOpts;let C=e.computeExportOpts,w=e.computeImportOpts;var O=e.computeCurrentRowOpts,y=e.computeCurrentColumnOpts,_=e.computeKeyboardOpts,E=e.computeAggregateOpts,S=E.groupFields;t.rowId&&(0,_log.warnLog)("vxe.error.delProp",["row-id","row-config.keyField"]),t.rowKey&&(0,_log.warnLog)("vxe.error.delProp",["row-key","row-config.useKey"]),t.columnKey&&(0,_log.warnLog)("vxe.error.delProp",["column-id","column-config.useKey"]),t.rowId||b.keyField||!(f.reserve||f.checkRowKeys||m.reserve||m.checkRowKey||h.expandRowKeys||c.expandRowKeys)||(0,_log.warnLog)("vxe.error.reqProp",["row-config.keyField"]),t.editConfig&&d.showStatus&&!t.keepSource&&(0,_log.warnLog)("vxe.error.reqProp",["keep-source"]),n&&(c.showLine||c.line)&&!a&&(0,_log.warnLog)("vxe.error.reqProp",["show-overflow"]),n&&!c.transform&&t.stripe&&(0,_log.warnLog)("vxe.error.noTree",["stripe"]),!t.showFooter||t.footerMethod||t.footerData||(0,_log.warnLog)("vxe.error.reqProp",["footer-data | footer-method"]),b.height&&(0,_log.warnLog)("vxe.error.delProp",["row-config.height","cell-config.height"]),this.tooltipOpts.enabled&&(0,_log.warnLog)("vxe.error.delProp",["tooltip-config.enabled","tooltip-config.showAll"]),this.highlightCurrentRow&&(0,_log.warnLog)("vxe.error.delProp",["highlight-current-row","row-config.isCurrent"]),this.highlightHoverRow&&(0,_log.warnLog)("vxe.error.delProp",["highlight-hover-row","row-config.isHover"]),this.highlightCurrentColumn&&(0,_log.warnLog)("vxe.error.delProp",["highlight-current-column","column-config.isCurrent"]),this.highlightHoverColumn&&(0,_log.warnLog)("vxe.error.delProp",["highlight-hover-column","column-config.isHover"]),t.resizable&&(0,_log.warnLog)("vxe.error.delProp",["resizable","column-config.resizable"]),i&&w.types&&!w.importMethod&&!_xeUtils.default.includeArrays(_xeUtils.default.keys(w._typeMaps),w.types)&&(0,_log.warnLog)("vxe.error.errProp",["export-config.types="+w.types.join(","),w.types.filter(e=>_xeUtils.default.includes(_xeUtils.default.keys(w._typeMaps),e)).join(",")||_xeUtils.default.keys(w._typeMaps).join(",")]),l&&C.types&&!C.exportMethod&&!_xeUtils.default.includeArrays(_xeUtils.default.keys(C._typeMaps),C.types)&&(0,_log.warnLog)("vxe.error.errProp",["export-config.types="+C.types.join(","),C.types.filter(e=>_xeUtils.default.includes(_xeUtils.default.keys(C._typeMaps),e)).join(",")||_xeUtils.default.keys(C._typeMaps).join(",")]),t.id||(t.customConfig?(0,_utils.isEnableConf)(x):x.enabled)&&x.storage&&(0,_log.errLog)("vxe.error.reqProp",["id"]),n&&f.range&&(0,_log.errLog)("vxe.error.noTree",["checkbox-config.range"]),b.height&&!this.showOverflow&&(0,_log.warnLog)("vxe.error.notProp",["table.show-overflow"]),!e.triggerCellAreaMousedownEvent&&(t.areaConfig&&(0,_log.warnLog)("vxe.error.notProp",["area-config"]),t.clipConfig&&(0,_log.warnLog)("vxe.error.notProp",["clip-config"]),t.fnrConfig&&(0,_log.warnLog)("vxe.error.notProp",["fnr-config"]),v.area)?(0,_log.errLog)("vxe.error.notProp",["mouse-config.area"]):(n&&b.drag&&!c.transform&&(0,_log.warnLog)("vxe.error.notSupportProp",["column-config.drag","tree-config.transform=false","tree-config.transform=true"]),t.dragConfig&&(0,_log.warnLog)("vxe.error.delProp",["drag-config","row-drag-config"]),t.rowGroupConfig&&(0,_log.warnLog)("vxe.error.delProp",["row-group-config","aggregate-config"]),E.countFields&&(0,_log.warnLog)("vxe.error.delProp",["row-group-config.countFields","column.agg-func"]),E.countMethod&&(0,_log.warnLog)("vxe.error.delProp",["row-group-config.countMethod","aggregate-config.aggregateMethod"]),t.treeConfig&&c.children&&(0,_log.warnLog)("vxe.error.delProp",["tree-config.children","tree-config.childrenField"]),t.treeConfig&&c.line&&(0,_log.warnLog)("vxe.error.delProp",["tree-config.line","tree-config.showLine"]),v.area&&v.selected&&(0,_log.warnLog)("vxe.error.errConflicts",["mouse-config.area","mouse-config.selected"]),v.area&&t.treeConfig&&!c.transform&&(0,_log.errLog)("vxe.error.noTree",["mouse-config.area"]),t.editConfig&&d.activeMethod&&(0,_log.warnLog)("vxe.error.delProp",["table.edit-config.activeMethod","table.edit-config.beforeEditMethod"]),t.treeConfig&&f.isShiftKey&&(0,_log.errLog)("vxe.error.errConflicts",["tree-config","checkbox-config.isShiftKey"]),f.halfField&&(0,_log.warnLog)("vxe.error.delProp",["checkbox-config.halfField","checkbox-config.indeterminateField"]),this.contextMenu&&((0,_log.warnLog)("vxe.error.delProp",["context-menu","menu-config"]),_xeUtils.default.isObject(this.contextMenu)||(0,_log.warnLog)("vxe.error.errProp",["table.context-menu="+this.contextMenu,"table.context-menu={}"])),t.menuConfig&&!_xeUtils.default.isObject(t.menuConfig)&&(0,_log.warnLog)("vxe.error.errProp",["table.menu-config="+t.menuConfig,"table.menu-config={}"]),t.exportConfig&&!_xeUtils.default.isObject(t.exportConfig)&&(0,_log.warnLog)("vxe.error.errProp",["table.export-config="+t.exportConfig,"table.export-config={}"]),t.importConfig&&!_xeUtils.default.isObject(t.importConfig)&&(0,_log.warnLog)("vxe.error.errProp",["table.import-config="+t.importConfig,"table.import-config={}"]),t.printConfig&&!_xeUtils.default.isObject(t.printConfig)&&(0,_log.warnLog)("vxe.error.errProp",["table.print-config="+t.printConfig,"table.print-config={}"]),t.treeConfig&&!_xeUtils.default.isObject(t.treeConfig)&&(0,_log.warnLog)("vxe.error.errProp",["table.tree-config="+t.treeConfig,"table.tree-config={}"]),t.customConfig&&!_xeUtils.default.isObject(t.customConfig)&&(0,_log.warnLog)("vxe.error.errProp",["table.custom-config="+t.customConfig,"table.custom-config={}"]),t.editConfig&&!_xeUtils.default.isObject(t.editConfig)&&(0,_log.warnLog)("vxe.error.errProp",["table.edit-config="+t.editConfig,"table.edit-config={}"]),t.emptyRender&&!_xeUtils.default.isObject(t.emptyRender)&&(0,_log.warnLog)("vxe.error.errProp",["table.empty-render="+t.emptyRender,"table.empty-render={}"]),b.currentMethod&&(0,_log.warnLog)("vxe.error.delProp",["row-config.currentMethod","current-row-config.beforeSelectMethod"]),g.currentMethod&&(0,_log.warnLog)("vxe.error.delProp",["row-config.currentMethod","current-column-config.beforeSelectMethod"]),(b.isCurrent||s)&&t.keyboardConfig&&_.isArrow&&!_xeUtils.default.isBoolean(O.isFollowSelected)&&(0,_log.warnLog)("vxe.error.notConflictProp",["row-config.isCurrent","current-row-config.isFollowSelected"]),(g.isCurrent||u)&&t.keyboardConfig&&_.isArrow&&!_xeUtils.default.isBoolean(y.isFollowSelected)&&(0,_log.warnLog)("vxe.error.notConflictProp",["column-config.isCurrent","current-column-config.isFollowSelected"]),t.editConfig&&!e.insert&&(0,_log.errLog)("vxe.error.reqModule",["Edit"]),t.editRules&&!e.validate&&(0,_log.errLog)("vxe.error.reqModule",["Validator"]),(f.range||t.keyboardConfig||t.mouseConfig)&&!e.handleCellMousedownEvent&&(0,_log.errLog)("vxe.error.reqModule",["Keyboard"]),(t.printConfig||t.importConfig||t.exportConfig)&&!e.exportData&&(0,_log.errLog)("vxe.error.reqModule",["Export"]),Object.assign(p,{startIndex:0,endIndex:1,visibleSize:0}),Object.assign(r,{startIndex:0,endIndex:1,visibleSize:0}),this.handleUpdateRowGroup(S),this.loadTableData(o,!0).then(()=>{o&&o.length&&(this.inited=!0,this.initStatus=!0,this.handleLoadDefaults()),this.handleInitDefaults(),this.updateStyle()}),globalEvents.on(e,"paste",this.handleGlobalPasteEvent),globalEvents.on(e,"copy",this.handleGlobalCopyEvent),globalEvents.on(e,"cut",this.handleGlobalCutEvent),globalEvents.on(e,"mousedown",this.handleGlobalMousedownEvent),globalEvents.on(e,"blur",this.handleGlobalBlurEvent),globalEvents.on(e,"mousewheel",this.handleGlobalMousewheelEvent),globalEvents.on(e,"keydown",this.handleGlobalKeydownEvent),globalEvents.on(e,"resize",this.handleGlobalResizeEvent),globalEvents.on(e,"contextmenu",this.handleGlobalContextmenuEvent),e.preventEvent(null,"created"))},mounted(){var e=this;let t=e;var r=e.computeColumnOpts,o=e.computeVirtualYOpts,r=((r.drag||e.computeRowOpts.drag||e.computeCustomOpts.allowSort)&&(0,_dom.initTpImg)(),this).$listeners;!this.menuConfig&&(r["menu-click"]||r["cell-menu"]||r["header-cell-menu"]||r["footer-cell-menu"])&&(0,_log.warnLog)("vxe.error.reqProp",["menu-config"]),this.tooltipConfig||!r["cell-mouseenter"]&&!r["cell-mouseleave"]||(0,_log.warnLog)("vxe.error.reqProp",["tooltip-config"]);let l=_ui.VxeUI.getComponent("VxeLoading"),i=_ui.VxeUI.getComponent("VxeTooltip");e.$nextTick(()=>{!t.loading||l||this.$scopedSlots.loading||(0,_log.errLog)("vxe.error.reqComp",["vxe-loading"]),!0!==t.showOverflow&&"tooltip"!==t.showOverflow&&!0!==t.showHeaderOverflow&&"tooltip"!==t.showHeaderOverflow&&!0!==t.showFooterOverflow&&"tooltip"!==t.showFooterOverflow&&!t.tooltipConfig&&!t.editRules||i||(0,_log.errLog)("vxe.error.reqComp",["vxe-tooltip"])}),this.autoResize&&((r=globalResize.create(()=>{this.autoResize&&this.recalculate(!0)})).observe(this.$el),r.observe(this.getParentElem()),this.$resize=r),"scroll"!==o.mode&&(r=e.$refs.refTableViewportElem)&&r.addEventListener("wheel",e.triggerBodyWheelEvent,{passive:!1}),this.preventEvent(null,"mounted")},activated(){this.recalculate().then(()=>this.refreshScroll()),this.preventEvent(null,"activated")},deactivated(){this.preventEvent(null,"deactivated")},beforeDestroy(){var e=this,t=this.$refs.refTableViewportElem;t&&t.removeEventListener("wheel",this.triggerBodyWheelEvent),e.cvCacheMaps={},e.prevDragRow=null,e.prevDragCol=null,this.$resize&&this.$resize.disconnect(),this.closeFilter(),this.closeMenu(),this.preventEvent(null,"beforeDestroy")},destroyed(){var e=this;globalEvents.off(e,"paste"),globalEvents.off(e,"copy"),globalEvents.off(e,"cut"),globalEvents.off(e,"mousedown"),globalEvents.off(e,"blur"),globalEvents.off(e,"mousewheel"),globalEvents.off(e,"keydown"),globalEvents.off(e,"resize"),globalEvents.off(e,"contextmenu"),this.preventEvent(null,"destroyed")},render(e){var t=_ui.VxeUI.getComponent("VxeLoading"),r=_ui.VxeUI.getComponent("VxeTooltip");let o=this,l=o.$xeGrid;var i=o,n=o.$scopedSlots,a=o,s=o.xID,{loading:u,stripe:p,showHeader:g,height:d,treeConfig:c,mouseConfig:m,showFooter:f,highlightCell:h,highlightHoverRow:b,highlightHoverColumn:x,editConfig:v,editRules:C}=i,{isGroup:w,overflowX:O,overflowY:z,scrollXLoad:j,scrollYLoad:P,tableData:H,initStore:y,isRowGroupStatus:U,columnStore:_,filterStore:V,customStore:G}=a,{leftList:_,rightList:Y}=_;let E=n.loading;var n=o.computeTableTipConfig,S=o.computeValidTipConfig,L=o.computeValidOpts,$=o.computeCheckboxOpts,R=o.computeTreeOpts,X=o.computeRowOpts,M=o.computeColumnOpts,D=o.computeSize,B=o.computeTableBorder,F=o.computeMouseOpts,T=o.computeAreaOpts,k=o.computeLoadingOpts,A=o.computeIsMenu;let I=a.isColLoading||a.isRowLoading||u;var a=o.computeResizableOpts,u=m&&F.area,K=o.computeColumnDragOpts,q=o.computeScrollbarXToTop,W=o.computeScrollbarYToLeft;return e("div",{ref:"refElem",class:["vxe-table","vxe-table--render-default","tid_"+s,"border--"+B,"sx-pos--"+(q?"top":"bottom"),"sy-pos--"+(W?"left":"right"),{["size--"+D]:D,["valid-msg--"+L.msgMode]:!!C,"vxe-editable":!!v,"old-cell-valid":C&&"obsolete"===getConfig().cellVaildMode,"cell--highlight":h,"cell--selected":m&&F.selected,"cell--area":u,"header-cell--area":u&&T.selectCellByHeader,"body-cell--area":u&&T.selectCellByBody,"row--highlight":X.isHover||b,"column--highlight":M.isHover||x,"checkbox--range":$.range,"col--drag-cell":M.drag&&"cell"===K.trigger,"is--header":g,"is--footer":f,"is--group":w,"is-row-group":U,"is--tree-line":c&&(R.showLine||R.line),"is--fixed-left":_.length,"is--fixed-right":Y.length,"is--animat":!!i.animat,"is--round":i.round,"is--stripe":!c&&p,"is--loading":I,"is--empty":!I&&!H.length,"is--scroll-y":z,"is--scroll-x":O,"is--virtual-x":j,"is--virtual-y":P}],attrs:{spellcheck:!1},on:{keydown:this.keydownEvent}},[e("div",{class:"vxe-table-slots",ref:"hideColumn"},this.$slots.default),e("div",{ref:"refVarElem",class:"vxe-table-vars"},[e("div",{class:"vxe-table-var-default"}),e("div",{class:"vxe-table-var-medium"}),e("div",{class:"vxe-table-var-small"}),e("div",{class:"vxe-table-var-mini"})]),e("div",{key:"tw",class:"vxe-table--render-wrapper"},q?[renderScrollX(e,o),renderBody(e,o)]:[renderBody(e,o),renderScrollX(e,o)]),e("div",{key:"tn",ref:"refEmptyPlaceholder",class:"vxe-table--empty-placeholder"},[e("div",{class:"vxe-table--empty-content"},renderEmptyBody(e,this))]),e("div",{key:"tl",class:"vxe-table--border-line"}),e("div",{key:"tcl",ref:"refColResizeBar",class:"vxe-table--resizable-col-bar"},a.showDragTip?[e("div",{ref:"refColResizeTip",class:"vxe-table--resizable-number-tip"})]:[]),e("div",{key:"trl",ref:"refRowResizeBar",class:"vxe-table--resizable-row-bar"},a.showDragTip?[e("div",{class:"vxe-table--resizable-number-tip"})]:[]),t?e(t,{key:"lg",class:"vxe-table--loading",props:{value:I,icon:k.icon,text:k.text},scopedSlots:E?{default:()=>o.callSlot(E,{$table:o,$grid:l,loading:I},e)}:{}}):E?e("div",{class:["vxe-loading--custom-wrapper",{"is--visible":I}]},o.callSlot(E,{$table:o,$grid:l,loading:I},e)):renderEmptyElement(o),y.custom?e(_panel.default,{key:"cs",ref:"customWrapper",props:{customStore:G}}):renderEmptyElement(o),y.filter?e(_panel2.default,{key:"tf",ref:"refTableFilter",props:{filterStore:V}}):renderEmptyElement(o),y.import&&this.importConfig?e(_importPanel.default,{key:"it",props:{defaultOptions:this.importParams,storeData:this.importStore}}):renderEmptyElement(o),y.export&&(this.exportConfig||this.printConfig)?e(_exportPanel.default,{key:"et",props:{defaultOptions:this.exportParams,storeData:this.exportStore}}):renderEmptyElement(o),A?e(_panel3.default,{key:"tm",ref:"refTableMenu",props:{ctxMenuStore:this.ctxMenuStore,ctxMenuOpts:this.ctxMenuOpts}}):renderEmptyElement(o),renderDragTip(e,this),e("div",{},[r?e(r,{key:"ctp",ref:"refCommTooltip",props:{isArrow:!1,enterable:!1}}):renderEmptyElement(o),r?e(r,{key:"btp",ref:"refTooltip",props:{theme:n.theme,enterable:n.enterable,enterDelay:n.enterDelay,leaveDelay:n.leaveDelay,useHTML:n.useHTML}}):renderEmptyElement(o),r&&this.editRules&&L.showMessage&&("default"===L.message?!d:"tooltip"===L.message)?e(r,{key:"vtp",ref:"refValidTooltip",class:[{"old-cell-valid":C&&"obsolete"===getConfig().cellVaildMode},"vxe-table--valid-error"],props:{theme:S.theme,enterable:S.enterable,enterDelay:S.enterDelay,leaveDelay:S.leaveDelay}}):renderEmptyElement(o)])])},methods:_methods.default};