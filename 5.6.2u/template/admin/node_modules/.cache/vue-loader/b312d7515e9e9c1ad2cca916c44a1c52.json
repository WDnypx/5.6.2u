{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\user\\list\\index.vue?vue&type=style&index=0&id=54fabd91&scoped=true&lang=scss","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\user\\list\\index.vue","mtime":1750064202516},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\css-loader\\index.js","mtime":1753254259822},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1753254262918},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\postcss-loader\\src\\index.js","mtime":1753254258547},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1753254255270},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Cjo6di1kZWVwIC5lbC10YWJzX19pdGVtIHsKICBoZWlnaHQ6IDU0cHggIWltcG9ydGFudDsKICBsaW5lLWhlaWdodDogNTRweCAhaW1wb3J0YW50Owp9CgoucGljQm94IHsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgY3Vyc29yOiBwb2ludGVyOwoKICAudXBMb2FkIHsKICAgIHdpZHRoOiA1OHB4OwogICAgaGVpZ2h0OiA1OHB4OwogICAgbGluZS1oZWlnaHQ6IDU4cHg7CiAgICBib3JkZXI6IDFweCBkb3R0ZWQgcmdiYSgwLCAwLCAwLCAwLjEpOwogICAgYm9yZGVyLXJhZGl1czogNHB4OwogICAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjAyKTsKICAgIGZvbnQtc2l6ZTogMjRweDsKICAgIGZvbnQtd2VpZ2h0OiA1MDA7CiAgfQoKICAucGljdHJ1ZSB7CiAgICB3aWR0aDogNjBweDsKICAgIGhlaWdodDogNjBweDsKICAgIGJvcmRlcjogMXB4IGRvdHRlZCByZ2JhKDAsIDAsIDAsIDAuMSk7CiAgICBtYXJnaW4tcmlnaHQ6IDEwcHg7CgogICAgaW1nIHsKICAgICAgd2lkdGg6IDEwMCU7CiAgICAgIGhlaWdodDogMTAwJTsKICAgIH0KICB9Cn0KLmZpeF9mb290ZXIgewogIHBvc2l0aW9uOiBmaXhlZDsKICBib3R0b206IDA7CiAgd2lkdGg6IC13ZWJraXQtZmlsbC1hdmFpbGFibGU7CiAgYmFja2dyb3VuZDogI2ZmZjsKICBwYWRkaW5nOiAyMHB4IDBweDsKICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogIHotaW5kZXg6IDEwMDsKfQoudXNlckZyb20gewogIDo6di1kZWVwIC5pdnUtZm9ybS1pdGVtLWNvbnRlbnQgewogICAgbWFyZ2luLWxlZnQ6IDBweCAhaW1wb3J0YW50OwogIH0KfQoKLnVzZXJBbGVydCB7CiAgbWFyZ2luLXRvcDogMjBweDsKfQoKLnVzZXJJIHsKICBjb2xvcjogdmFyKC0tcHJldi1jb2xvci1wcmltYXJ5KTsKICBmb250LXN0eWxlOiBub3JtYWw7Cn0KCmltZyB7CiAgaGVpZ2h0OiAzNnB4OwogIGRpc3BsYXk6IGJsb2NrOwp9CgoudGFiQm94X2ltZyB7CiAgd2lkdGg6IDM2cHg7CiAgaGVpZ2h0OiAzNnB4OwogIGJvcmRlci1yYWRpdXM6IDRweDsKICBjdXJzb3I6IHBvaW50ZXI7CgogIGltZyB7CiAgICB3aWR0aDogMTAwJTsKICAgIGhlaWdodDogMTAwJTsKICB9Cn0KCi50YWJCb3hfdGl0IHsKICB3aWR0aDogNjAlOwogIGZvbnQtc2l6ZTogMTJweCAhaW1wb3J0YW50OwogIG1hcmdpbjogMCAycHggMCAxMHB4OwogIGxldHRlci1zcGFjaW5nOiAxcHg7CiAgcGFkZGluZzogNXB4IDA7CiAgYm94LXNpemluZzogYm9yZGVyLWJveDsKfQoKLm1vZGVsQm94IHsKICA6OnYtZGVlcCAuaXZ1LW1vZGFsLWJvZHkgewogICAgcGFkZGluZzogMCAxNnB4IDE2cHggMTZweCAhaW1wb3J0YW50OwogIH0KfQoKLnZpcE5hbWUgewogIGNvbG9yOiAjZGFiMTc2Owp9CgoubGlzdGJveCB7CiAgOjp2LWRlZXAgLml2dS1kaXZpZGVyLWhvcml6b250YWwgewogICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7CiAgfQp9CgoubGFiZWxJbnB1dCB7CiAgd2lkdGg6IDI1MHB4OwogIGJvcmRlcjogMXB4IHNvbGlkICNkY2RlZTI7CiAgcGFkZGluZzogMCAxNXB4OwogIGJvcmRlci1yYWRpdXM6IDVweDsKICBtaW4taGVpZ2h0OiAzMHB4OwogIGN1cnNvcjogcG9pbnRlcjsKICBmb250LXNpemU6IDEycHg7CgogIC5zcGFuIHsKICAgIGNvbG9yOiAjYzVjOGNlOwogIH0KCiAgLml2dS1pY29uLWlvcy1hcnJvdy1kb3duIHsKICAgIGZvbnQtc2l6ZTogMTRweDsKICAgIGNvbG9yOiAjODA4Njk1OwogIH0KfQoKLmRlbW8tZHJhd2VyLWZvb3RlciB7CiAgd2lkdGg6IDEwMCU7CiAgcG9zaXRpb246IGFic29sdXRlOwogIGJvdHRvbTogMDsKICBsZWZ0OiAwOwogIGJvcmRlci10b3A6IDFweCBzb2xpZCAjZThlOGU4OwogIHBhZGRpbmc6IDEwcHggMTZweDsKICB0ZXh0LWFsaWduOiByaWdodDsKICBiYWNrZ3JvdW5kOiAjZmZmOwp9Cgouc2VhcmNoLWZvcm0gewogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwoKICAuc2VhcmNoLWZvcm0tYm94IHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICBmbGV4OiAxOwogIH0KfQoKLnNlYXJjaC1mb3JtLXN1YiB7CiAgZGlzcGxheTogZmxleDsKfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAwvCA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/user/list","sourcesContent":["<template>\n  <div>\n    <el-card :bordered=\"false\" shadow=\"never\" class=\"ivu-mt\" :body-style=\"{ padding: 0 }\">\n      <div class=\"padding-add\">\n        <el-form\n          ref=\"userFrom\"\n          :model=\"userFrom\"\n          label-width=\"80px\"\n          label-position=\"right\"\n          @submit.native.prevent\n          inline\n        >\n          <div class=\"acea-row search-form\" v-if=\"!collapse\">\n            <div>\n              <el-form-item label=\"用户搜索：\" label-for=\"nickname\">\n                <el-input v-model=\"userFrom.nickname\" placeholder=\"请输入用户\" clearable class=\"form_content_width\">\n                  <el-select v-model=\"field_key\" slot=\"prepend\" style=\"width: 100px\">\n                    <el-option value=\"all\" label=\"全部\"></el-option>\n                    <el-option value=\"uid\" label=\"UID\"></el-option>\n                    <el-option value=\"phone\" label=\"手机号\"></el-option>\n                    <el-option value=\"nickname\" label=\"用户昵称\"></el-option>\n                  </el-select>\n                </el-input>\n              </el-form-item>\n              <el-form-item label=\"用户等级：\" label-for=\"level\">\n                <el-select v-model=\"level\" placeholder=\"请选择用户等级\" clearable class=\"form_content_width\">\n                  <el-option value=\"all\" label=\"全部\">全部</el-option>\n                  <el-option\n                    :value=\"item.id\"\n                    v-for=\"(item, index) in levelList\"\n                    :key=\"index\"\n                    :label=\"item.name\"\n                  ></el-option>\n                </el-select>\n              </el-form-item>\n              <el-form-item label=\"用户分组：\">\n                <el-select v-model=\"group_id\" placeholder=\"请选择用户分组\" clearable class=\"form_content_width\">\n                  <el-option value=\"all\" label=\"全部\"></el-option>\n                  <el-option\n                    :value=\"item.id\"\n                    v-for=\"(item, index) in groupList\"\n                    :key=\"index\"\n                    :label=\"item.group_name\"\n                  ></el-option>\n                </el-select>\n              </el-form-item>\n            </div>\n            <el-form-item class=\"search-form-sub\">\n              <el-button type=\"primary\" v-db-click @click=\"userSearchs\">搜索</el-button>\n              <el-button class=\"ResetSearch\" v-db-click @click=\"reset('userFrom')\">重置</el-button>\n              <a class=\"ivu-ml-8 font12 ml10\" v-db-click @click=\"collapse = !collapse\">\n                <template v-if=\"!collapse\"> 展开 <i class=\"el-icon-arrow-down\" /> </template>\n                <template v-else> 收起 <i class=\"el-icon-arrow-up\" /> </template>\n              </a>\n            </el-form-item>\n          </div>\n          <div v-if=\"collapse\" class=\"acea-row search-form\">\n            <div class=\"search-form-box\">\n              <el-form-item label=\"用户搜索：\" label-for=\"nickname\">\n                <el-input v-model=\"userFrom.nickname\" placeholder=\"请输入用户\" clearable class=\"form_content_width\">\n                  <el-select v-model=\"field_key\" slot=\"prepend\" style=\"width: 100px\">\n                    <el-option value=\"all\" label=\"全部\"></el-option>\n                    <el-option value=\"uid\" label=\"UID\"></el-option>\n                    <el-option value=\"phone\" label=\"手机号\"></el-option>\n                    <el-option value=\"nickname\" label=\"用户昵称\"></el-option>\n                  </el-select>\n                </el-input>\n              </el-form-item>\n              <el-form-item label=\"用户等级：\" label-for=\"level\">\n                <el-select v-model=\"level\" placeholder=\"请选择用户等级\" clearable class=\"form_content_width\">\n                  <el-option value=\"all\" label=\"全部\">全部</el-option>\n                  <el-option\n                    :value=\"item.id\"\n                    v-for=\"(item, index) in levelList\"\n                    :key=\"index\"\n                    :label=\"item.name\"\n                  ></el-option>\n                </el-select>\n              </el-form-item>\n              <el-form-item label=\"用户分组：\">\n                <el-select v-model=\"group_id\" placeholder=\"请选择用户分组\" clearable class=\"form_content_width\">\n                  <el-option value=\"all\" label=\"全部\"></el-option>\n                  <el-option\n                    :value=\"item.id\"\n                    v-for=\"(item, index) in groupList\"\n                    :key=\"index\"\n                    :label=\"item.group_name\"\n                  ></el-option>\n                </el-select>\n              </el-form-item>\n              <el-form-item label=\"分销等级：\">\n                <el-select v-model=\"agent_level\" placeholder=\"请选择分销等级\" clearable class=\"form_content_width\">\n                  <el-option value=\"all\" label=\"全部\"></el-option>\n                  <el-option\n                    :value=\"item.grade\"\n                    v-for=\"(item, index) in membershipList\"\n                    :key=\"index\"\n                    :label=\"item.name\"\n                  ></el-option>\n                </el-select>\n              </el-form-item>\n              <el-form-item label=\"用户标签：\" label-for=\"label_id\">\n                <div class=\"labelInput acea-row row-between-wrapper\" v-db-click @click=\"openSelectLabel\">\n                  <div style=\"width: 222px\">\n                    <div v-if=\"selectDataLabel.length\">\n                      <el-tag :closable=\"false\" v-for=\"(item, index) in selectDataLabel\" :key=\"index\" class=\"mr10\">{{\n                        item.label_name\n                      }}</el-tag>\n                    </div>\n                    <span class=\"span\" v-else>选择用户关联标签</span>\n                  </div>\n                  <div class=\"ivu-icon ivu-icon-ios-arrow-down\"></div>\n                </div>\n              </el-form-item>\n              <el-form-item label=\"用户身份：\">\n                <el-select v-model=\"userFrom.is_promoter\" placeholder=\"请选择\" clearable class=\"form_content_width\">\n                  <el-option value=\"\" label=\"全部\"></el-option>\n                  <el-option value=\"1\" label=\"推广员\"></el-option>\n                  <el-option value=\"0\" label=\"普通用户\"></el-option>\n                </el-select>\n              </el-form-item>\n              <el-form-item label=\"付费会员：\" label-for=\"isMember\">\n                <el-select v-model=\"userFrom.isMember\" placeholder=\"请选择\" clearable class=\"form_content_width\">\n                  <el-option value=\"\" label=\"全部\"></el-option>\n                  <el-option value=\"1\" label=\"是\"></el-option>\n                  <el-option value=\"0\" label=\"否\"></el-option>\n                </el-select>\n              </el-form-item>\n              <el-form-item label=\"储值余额：\" label-for=\"balance\">\n                <el-input\n                  clearable\n                  placeholder=\"最小值\"\n                  v-model=\"userFrom.balance[0]\"\n                  class=\"form_range_content_width\"\n                />\n                ~\n                <el-input\n                  clearable\n                  placeholder=\"最大值\"\n                  v-model=\"userFrom.balance[1]\"\n                  class=\"form_range_content_width\"\n                />\n              </el-form-item>\n              <el-form-item label=\"积分剩余：\" label-for=\"integral\">\n                <el-input\n                  clearable\n                  placeholder=\"最小值\"\n                  v-model=\"userFrom.integral[0]\"\n                  class=\"form_range_content_width\"\n                />\n                ~\n                <el-input\n                  clearable\n                  placeholder=\"最大值\"\n                  v-model=\"userFrom.integral[1]\"\n                  class=\"form_range_content_width\"\n                />\n              </el-form-item>\n              <el-form-item label=\"上次消费：\" label-for=\"before_pay_time\">\n                <el-date-picker\n                  clearable\n                  v-model=\"before_pay_time\"\n                  type=\"daterange\"\n                  :editable=\"false\"\n                  @change=\"(e) => onchangeTime(e, 'before_pay_time')\"\n                  format=\"yyyy/MM/dd\"\n                  value-format=\"yyyy/MM/dd\"\n                  start-placeholder=\"开始日期\"\n                  end-placeholder=\"结束日期\"\n                  :picker-options=\"pickerOptions\"\n                  style=\"width: 250px\"\n                ></el-date-picker>\n              </el-form-item>\n              <el-form-item label=\"下单次数：\" label-for=\"pay_count\">\n                <el-input\n                  clearable\n                  placeholder=\"最小值\"\n                  v-model=\"userFrom.pay_count_num[0]\"\n                  class=\"form_range_content_width\"\n                />\n                ~\n                <el-input\n                  clearable\n                  placeholder=\"最大值\"\n                  v-model=\"userFrom.pay_count_num[1]\"\n                  class=\"form_range_content_width\"\n                />\n              </el-form-item>\n              <el-form-item label=\"消费金额：\" label-for=\"store_name\">\n                <el-input\n                  clearable\n                  placeholder=\"最小值\"\n                  v-model=\"userFrom.pay_count_money[0]\"\n                  class=\"form_range_content_width\"\n                />\n                ~\n                <el-input\n                  clearable\n                  placeholder=\"最大值\"\n                  v-model=\"userFrom.pay_count_money[1]\"\n                  class=\"form_range_content_width\"\n                />\n              </el-form-item>\n              <el-form-item label=\"充值次数：\" label-for=\"store_name\">\n                <el-input\n                  clearable\n                  placeholder=\"最小值\"\n                  v-model=\"userFrom.recharge_count[0]\"\n                  class=\"form_range_content_width\"\n                />\n                ~\n                <el-input\n                  clearable\n                  placeholder=\"最大值\"\n                  v-model=\"userFrom.recharge_count[1]\"\n                  class=\"form_range_content_width\"\n                />\n              </el-form-item>\n              <el-form-item label=\"访问情况：\" label-for=\"user_time_type\">\n                <el-select v-model=\"user_time_type\" placeholder=\"请选择访问情况\" clearable class=\"form_content_width\">\n                  <el-option value=\"\" label=\"全部\"></el-option>\n                  <el-option value=\"visitno\" label=\"时间段未访问\"></el-option>\n                  <el-option value=\"visit\" label=\"时间段访问过\"></el-option>\n                  <el-option value=\"add_time\" label=\"首次访问\"></el-option>\n                </el-select>\n              </el-form-item>\n              <el-form-item label=\"访问时间：\" label-for=\"user_time\" v-if=\"user_time_type\">\n                <el-date-picker\n                  clearable\n                  v-model=\"timeVal\"\n                  type=\"daterange\"\n                  :editable=\"false\"\n                  @change=\"(e) => onchangeTime(e, 'user_time')\"\n                  format=\"yyyy/MM/dd\"\n                  value-format=\"yyyy/MM/dd\"\n                  start-placeholder=\"开始日期\"\n                  end-placeholder=\"结束日期\"\n                  :picker-options=\"pickerOptions\"\n                  style=\"width: 250px\"\n                ></el-date-picker>\n              </el-form-item>\n              <!-- <el-form-item label=\"地区：\" label-for=\"country\">\n                <el-select\n                  v-model=\"userFrom.country\"\n                  placeholder=\"请选择国家\"\n                  clearable\n                  @change=\"changeCountry\"\n                  class=\"form_content_width\"\n                >\n                  <el-option value=\"domestic\" label=\"中国\"></el-option>\n                  <el-option value=\"abroad\" label=\"外国\"></el-option>\n                </el-select>\n              </el-form-item>\n              <el-form-item label=\"省份：\" v-if=\"userFrom.country === 'domestic'\">\n                <el-cascader\n                  :options=\"addresData\"\n                  :value=\"address\"\n                  v-model=\"address\"\n                  @change=\"handleChange\"\n                  clearable\n                  style=\"width: 250px\"\n                ></el-cascader>\n              </el-form-item> -->\n            </div>\n\n            <el-form-item class=\"search-form-sub\">\n              <el-button type=\"primary\" label=\"default\" v-db-click @click=\"userSearchs\">搜索</el-button>\n              <el-button class=\"ResetSearch\" v-db-click @click=\"reset('userFrom')\">重置</el-button>\n              <a class=\"ivu-ml-8 font12 ml10\" v-db-click @click=\"collapse = !collapse\">\n                <template v-if=\"!collapse\"> 展开 <i class=\"el-icon-arrow-down\" /> </template>\n                <template v-else> 收起 <i class=\"el-icon-arrow-up\" /> </template>\n              </a>\n            </el-form-item>\n          </div>\n        </el-form>\n      </div>\n    </el-card>\n    <el-card :bordered=\"false\" shadow=\"never\" class=\"ivu-mt mt16\" :body-style=\"{ padding: '0 20px 20px' }\">\n      <el-tabs v-model=\"userFrom.user_type\" @tab-click=\"onClickTab\">\n        <el-tab-pane :label=\"item.name\" :name=\"item.type\" v-for=\"(item, index) in headeNum\" :key=\"index\" />\n      </el-tabs>\n      <el-row :gutter=\"24\" justify=\"space-between\">\n        <el-col :span=\"24\">\n          <el-button v-auth=\"['admin-user-save']\" type=\"primary\" v-db-click @click=\"edit({ uid: 0 })\"\n            >添加用户</el-button\n          >\n          <el-button v-auth=\"['admin-user-coupon']\" v-db-click @click=\"onSend\">发送优惠券</el-button>\n          <el-button\n            v-auth=\"['admin-wechat-news']\"\n            class=\"greens mr10\"\n            v-db-click\n            @click=\"onSendPic\"\n            v-if=\"userFrom.user_type === 'wechat'\"\n          >\n            发送图文消息\n          </el-button>\n          <el-button v-auth=\"['admin-user-group_set']\" v-db-click @click=\"setGroup\">批量设置分组</el-button>\n          <el-button v-auth=\"['admin-user-set_label']\" v-db-click @click=\"setLabel\">批量设置标签</el-button>\n          <el-button class=\"mr10\" v-db-click @click=\"exportList\">导出</el-button>\n\n          <!-- <el-button v-auth=\"['admin-user-synchro']\" class=\"mr20\" v-db-click @click=\"synchro\">同步公众号用户</el-button> -->\n        </el-col>\n        <el-col :span=\"24\" class=\"userAlert\" v-if=\"selectionList.length\">\n          <el-alert show-icon>\n            <template slot=\"title\">\n              已选择<i class=\"userI\"> {{ selectionList.length }} </i>项\n            </template>\n          </el-alert>\n        </el-col>\n      </el-row>\n      <el-table\n        :data=\"userLists\"\n        class=\"mt16\"\n        ref=\"table\"\n        highlight-current-row\n        v-loading=\"loading\"\n        empty-text=\"暂无数据\"\n        no-filtered-userFrom-text=\"暂无筛选结果\"\n        @sort-change=\"sortChanged\"\n        @select=\"handleSelectRow\"\n        @select-all=\"handleSelectAll\"\n      >\n        <el-table-column type=\"expand\">\n          <template slot-scope=\"scope\">\n            <expandRow :row=\"scope.row\"></expandRow>\n          </template>\n        </el-table-column>\n        <el-table-column type=\"selection\" :selectable=\"isSel\" width=\"55\"> </el-table-column>\n        <el-table-column label=\"用户ID\" min-width=\"80\">\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.uid }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"头像\" min-width=\"60\">\n          <template slot-scope=\"scope\">\n            <div class=\"tabBox_img\" v-viewer>\n              <img v-lazy=\"scope.row.avatar\" />\n            </div>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"姓名\" min-width=\"150\">\n          <template slot-scope=\"scope\">\n            <div class=\"acea-row\">\n              <i class=\"el-icon-male\" v-show=\"scope.row.sex === '男'\" style=\"color: #2db7f5; font-size: 15px\"></i>\n              <i class=\"el-icon-female\" v-show=\"scope.row.sex === '女'\" style=\"color: #ed4014; font-size: 15px\"></i>\n              <div v-text=\"scope.row.nickname\" class=\"\"></div>\n            </div>\n            <div v-if=\"scope.row.is_del == 1\" style=\"color: red\">用户已注销</div>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"付费会员\" min-width=\"90\">\n          <template slot-scope=\"scope\">\n            <div>{{ scope.row.isMember ? '是' : '否' }}</div>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"用户等级\" min-width=\"90\">\n          <template slot-scope=\"scope\">\n            <div>{{ scope.row.level }}</div>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"分组\" min-width=\"100\">\n          <template slot-scope=\"scope\">\n            <div>{{ scope.row.group_id }}</div>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"分销等级\" min-width=\"100\">\n          <template slot-scope=\"scope\">\n            <div>{{ scope.row.agent_level_name }}</div>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"手机号\" min-width=\"100\">\n          <template slot-scope=\"scope\">\n            <div>{{ scope.row.phone }}</div>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"用户类型\" min-width=\"100\">\n          <template slot-scope=\"scope\">\n            <div>{{ scope.row.user_type }}</div>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"余额\" prop=\"now_money\" min-width=\"100\" :sortable=\"true\">\n          <template slot-scope=\"scope\">\n            <div>{{ scope.row.now_money }}</div>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"操作\" fixed=\"right\" width=\"120\">\n          <template slot-scope=\"scope\">\n            <template v-if=\"scope.row.is_del != 1\">\n              <a v-db-click @click=\"userDetail(scope.row)\">详情</a>\n\n              <el-divider direction=\"vertical\"></el-divider>\n              <el-dropdown size=\"small\" @command=\"changeMenu(scope.row, $event, scope.$index)\" :transfer=\"true\">\n                <span class=\"el-dropdown-link\">更多<i class=\"el-icon-arrow-down el-icon--right\"></i> </span>\n                <el-dropdown-menu slot=\"dropdown\">\n                  <!-- <el-dropdown-item command=\"1\">编辑</el-dropdown-item> -->\n                  <el-dropdown-item command=\"2\">修改余额</el-dropdown-item>\n                  <el-dropdown-item command=\"8\">修改积分</el-dropdown-item>\n                  <el-dropdown-item command=\"3\">赠送会员</el-dropdown-item>\n                  <!--                                <el-dropdown-item command=\"4\" v-if=\"row.vip_name\">清除等级</el-dropdown-item>-->\n                  <el-dropdown-item command=\"5\">设置分组</el-dropdown-item>\n                  <el-dropdown-item command=\"6\">设置标签</el-dropdown-item>\n                  <el-dropdown-item command=\"7\">修改上级推广人</el-dropdown-item>\n                  <el-dropdown-item command=\"99\" v-if=\"scope.row.spread_uid\">清除上级推广人</el-dropdown-item>\n                </el-dropdown-menu>\n              </el-dropdown>\n            </template>\n            <template v-else>\n              <a v-db-click @click=\"userDetail(scope.row)\">详情</a>\n            </template>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <div class=\"acea-row row-right page\">\n        <pagination\n          v-if=\"total\"\n          :total=\"total\"\n          :page.sync=\"userFrom.page\"\n          :limit.sync=\"userFrom.limit\"\n          @pagination=\"pageChange\"\n        />\n      </div>\n    </el-card>\n    <!-- 编辑表单 积分余额-->\n    <edit-from ref=\"edits\" :FromData=\"FromData\" @submitFail=\"submitFail\"></edit-from>\n    <!-- 发送优惠券-->\n    <send-from ref=\"sends\" :userIds=\"ids.toString()\"></send-from>\n    <!-- 会员详情-->\n    <user-details ref=\"userDetails\"></user-details>\n    <!--发送图文消息 -->\n    <el-dialog :visible.sync=\"modal13\" title=\"发送消息\" width=\"1200px\" class=\"modelBox\">\n      <news-category\n        v-if=\"modal13\"\n        :isShowSend=\"isShowSend\"\n        :userIds=\"ids.toString()\"\n        :scrollerHeight=\"scrollerHeight\"\n        :contentTop=\"contentTop\"\n        :contentWidth=\"contentWidth\"\n        :maxCols=\"maxCols\"\n      ></news-category>\n    </el-dialog>\n    <!--修改推广人-->\n    <el-dialog :visible.sync=\"promoterShow\" title=\"修改推广人\" width=\"540px\" :show-close=\"true\">\n      <el-form ref=\"formInline\" :model=\"formInline\" label-width=\"100px\" @submit.native.prevent>\n        <el-form-item v-if=\"formInline\" label=\"选择推广人：\" prop=\"image\">\n          <div class=\"picBox\" v-db-click @click=\"customer\">\n            <div class=\"pictrue\" v-if=\"formInline.image\">\n              <img v-lazy=\"formInline.image\" />\n            </div>\n            <div class=\"upLoad acea-row row-center-wrapper\" v-else>\n              <i class=\"el-icon-user\"></i>\n            </div>\n          </div>\n        </el-form-item>\n      </el-form>\n      <div class=\"acea-row row-right mt20\">\n        <el-button v-db-click @click=\"cancel('formInline')\">取消</el-button>\n        <el-button type=\"primary\" v-db-click @click=\"putSend('formInline')\">提交</el-button>\n      </div>\n    </el-dialog>\n    <el-dialog :visible.sync=\"customerShow\" title=\"请选择商城用户\" :show-close=\"true\" width=\"1000px\">\n      <customerInfo v-if=\"customerShow\" @imageObject=\"imageObject\"></customerInfo>\n    </el-dialog>\n    <el-dialog :visible.sync=\"labelShow\" append-to-body title=\"请选择用户标签\" width=\"540px\" :show-close=\"true\">\n      <userLabel\n        v-if=\"labelShow\"\n        :uid=\"labelActive.uid\"\n        :only_get=\"!labelActive.uid\"\n        @close=\"labelClose\"\n        @activeData=\"activeData\"\n        @onceGetList=\"onceGetList\"\n      ></userLabel>\n    </el-dialog>\n    <el-drawer\n      custom-class=\"demo-drawer\"\n      :visible.sync=\"modals\"\n      :wrapperClosable=\"false\"\n      size=\"720\"\n      title=\"用户信息填写\"\n    >\n      <div class=\"demo-drawer__content\">\n        <userEdit ref=\"userEdit\" v-if=\"modals\" :userData=\"userData\"></userEdit>\n        <div class=\"fix_footer acea-row row-center\">\n          <el-button v-db-click @click=\"modals = false\">取消</el-button>\n          <el-button type=\"primary\" v-db-click @click=\"setUser\">提交</el-button>\n        </div>\n      </div>\n    </el-drawer>\n    <!-- 用户标签 -->\n    <el-dialog\n      :visible.sync=\"selectLabelShow\"\n      append-to-body\n      title=\"请选择用户标签\"\n      width=\"540px\"\n      :show-close=\"true\"\n      :close-on-click-modal=\"false\"\n    >\n      <userLabel\n        v-if=\"selectLabelShow\"\n        :uid=\"0\"\n        ref=\"userLabel\"\n        :only_get=\"true\"\n        :selectDataLabel=\"selectDataLabel\"\n        @activeData=\"activeSelectData\"\n        @close=\"labelClose\"\n      ></userLabel>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport userLabel from '@/components/userLabel';\nimport { mapState } from 'vuex';\nimport expandRow from './tableExpand.vue';\nimport userEdit from './handle/userEdit.vue';\nimport {\n  userList,\n  getUserData,\n  isShowApi,\n  editOtherApi,\n  giveLevelApi,\n  userSetGroup,\n  userGroupApi,\n  levelListApi,\n  userSetLabelApi,\n  userLabelApi,\n  userSynchro,\n  getUserSaveForm,\n  giveLevelTimeApi,\n  getUserInfo,\n  setUser,\n  editUser,\n  saveSetLabel,\n} from '@/api/user';\nimport { agentSpreadApi } from '@/api/agent';\nimport { exportUserList } from '@/api/export';\nimport editFrom from '../../../components/from/from';\nimport sendFrom from '@/components/sendCoupons/index';\nimport userDetails from './handle/userDetails';\nimport newsCategory from '@/components/newsCategory/index';\nimport customerInfo from '@/components/customerInfo';\nimport { cityList } from '@/api/app';\nimport { membershipDataListApi } from '@/api/membershipLevel';\n\nexport default {\n  name: 'user_list',\n  components: {\n    expandRow,\n    editFrom,\n    sendFrom,\n    userDetails,\n    newsCategory,\n    customerInfo,\n    userLabel,\n    userEdit,\n  },\n  data() {\n    return {\n      dataLabel: [],\n      selectDataLabel: [],\n      userData: {},\n      modals: false,\n      selectLabelShow: false,\n      labelShow: false,\n      customerShow: false,\n      promoterShow: false,\n      labelActive: {\n        uid: 0,\n      },\n      formInline: {\n        uid: 0,\n        spread_uid: 0,\n        image: '',\n      },\n      pickerOptions: this.$timeOptions,\n      collapse: false,\n      headeNum: [\n        { type: '', name: '全部' },\n        { type: 'wechat', name: '微信公众号' },\n        { type: 'routine', name: '微信小程序' },\n        { type: 'h5', name: 'H5' },\n        { type: 'pc', name: 'PC' },\n        { type: 'app', name: 'APP' },\n      ],\n      address: [],\n      addresData: [],\n      isShowSend: true,\n      modal13: false,\n      maxCols: 4,\n      scrollerHeight: '600',\n      contentTop: '130',\n      contentWidth: '98%',\n      grid: {\n        xl: 6,\n        lg: 6,\n        md: 8,\n        sm: 12,\n        xs: 24,\n      },\n      grid2: {\n        xl: 8,\n        lg: 8,\n        md: 8,\n        sm: 12,\n        xs: 24,\n      },\n      loading: false,\n      total: 0,\n      userFrom: {\n        label_id: '',\n        user_type: '',\n        status: '',\n        sex: '',\n        is_promoter: '',\n        country: '',\n        isMember: '',\n        pay_count_num: ['', ''],\n        balance: ['', ''],\n        integral: ['', ''],\n        pay_count_money: ['', ''],\n        recharge_count: ['', ''],\n        user_time_type: '',\n        user_time: '',\n        before_pay_time: '',\n        nickname: '',\n        province: '',\n        city: '',\n        page: 1,\n        limit: 15,\n        level: '',\n        group_id: '',\n        agent_level: '',\n        field_key: '',\n      },\n      before_pay_time: '',\n      field_key: '',\n      level: '',\n      group_id: '',\n      agent_level: '',\n      label_id: '',\n      user_time_type: '',\n      pay_count: '',\n      userLists: [],\n      FromData: null,\n      selectionList: [],\n      user_ids: '',\n      selectedData: [],\n      timeVal: [],\n      groupList: [],\n      levelList: [],\n      membershipList: [],\n      labelFrom: {\n        page: 1,\n        limit: '',\n      },\n      labelLists: [],\n      selectedIds: [], //选中合并项的id\n      ids: [],\n    };\n  },\n  computed: {\n    ...mapState('media', ['isMobile']),\n  },\n  created() {\n    this.getList();\n    this.getCityList();\n  },\n  mounted() {\n    this.userGroup();\n    this.levelLists();\n    this.membershipDataList();\n    // this.groupLists();\n  },\n  methods: {\n    getCityList() {\n      cityList().then((res) => {\n        this.addresData = res.data;\n      });\n    },\n    setUser() {\n      let data = this.$refs.userEdit.formItem;\n      let ids = [];\n      this.$refs.userEdit.dataLabel.map((i) => {\n        ids.push(i.id);\n      });\n      data.label_id = ids;\n      // if (!data.real_name) return this.$message.warning(\"请输入真实姓名\");\n      // if (!data.phone) return this.$message.warning(\"请输入手机号\");\n      // if (!data.pwd) return this.$message.warning(\"请输入密码\");\n      // if (!data.true_pwd) return this.$message.warning(\"请输入确认密码\");\n      if (data.uid) {\n        editUser(data)\n          .then((res) => {\n            this.modals = false;\n            this.$message.success(res.msg);\n            this.getList();\n          })\n          .catch((err) => {\n            this.$message.error(err);\n          });\n      } else {\n        setUser(data)\n          .then((res) => {\n            this.modals = false;\n            this.$message.success(res.msg);\n            this.getList();\n          })\n          .catch((err) => {\n            this.$message.error(err.msg);\n          });\n      }\n    },\n    onceGetList() {\n      this.labelActive.uid = 0;\n      this.getList();\n    },\n    // 标签弹窗关闭\n    labelClose() {\n      this.labelActive.uid = 0;\n      this.labelShow = false;\n      this.selectLabelShow = false;\n    },\n    // 提交\n    putSend(name) {\n      this.$refs[name].validate((valid) => {\n        if (valid) {\n          if (!this.formInline.spread_uid) {\n            return this.$message.error('请上传用户');\n          }\n          agentSpreadApi(this.formInline)\n            .then((res) => {\n              this.promoterShow = false;\n              this.$message.success(res.msg);\n              this.getList();\n              this.$refs[name].resetFields();\n            })\n            .catch((res) => {\n              this.$message.error(res.msg);\n            });\n        }\n      });\n    },\n\n    save() {\n      this.modals = true;\n\n      // this.$modalForm(getUserSaveForm())\n      //   .then(() => {\n      //     this.userFrom.page = 1;\n      //     this.getList();\n      //   })\n      //   .catch((res) => {\n      //     this.$message.error(res.msg);\n      //   });\n    },\n    synchro() {\n      userSynchro()\n        .then((res) => {\n          this.$message.success(res.msg);\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    isSel(row) {\n      return !!!row.is_del;\n    },\n    // 分组列表\n    groupLists() {\n      this.loading = true;\n      userLabelApi(this.labelFrom)\n        .then(async (res) => {\n          let data = res.data;\n          this.labelLists = data.list;\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$message.error(res.msg);\n        });\n    },\n    onClickTab() {\n      this.userFrom.page = 1;\n      this.getList();\n    },\n    userGroup() {\n      let data = {\n        page: 1,\n        limit: '',\n      };\n      userGroupApi(data).then((res) => {\n        this.groupList = res.data.list;\n      });\n    },\n    levelLists() {\n      let data = {\n        page: 1,\n        limit: '',\n        title: '',\n        is_show: 1,\n      };\n      levelListApi(data).then((res) => {\n        this.levelList = res.data.list;\n      });\n    },\n    membershipDataList() {\n      let data = {\n        page: 1,\n        limit: 0,\n        staus: 1,\n      };\n      membershipDataListApi(data).then((res) => {\n        this.membershipList = res.data.list;\n      });\n    },\n    // 批量设置分组；\n    setGroup() {\n      if (this.ids.length === 0) {\n        this.$message.warning('请选择要设置分组的用户');\n      } else {\n        let uids = { uids: this.ids };\n        this.$modalForm(userSetGroup(uids)).then(() => {\n          this.ids = [];\n          this.selectedIds = [];\n          this.getList();\n        });\n      }\n    },\n    // 批量设置标签；\n    setLabel() {\n      if (this.ids.length === 0) {\n        this.$message.warning('请选择要设置标签的用户');\n      } else {\n        let uids = { uids: this.ids };\n        this.labelActive.uid = 0;\n        this.labelShow = true;\n        // this.$modalForm(userSetLabelApi(uids)).then(() =>\n        //   this.$refs.sends.getList()\n        // );\n      }\n    },\n    activeSelectData(data) {\n      this.selectLabelShow = false;\n      this.selectDataLabel = data || [];\n      if (this.selectDataLabel.length) {\n        let activeIds = [];\n        this.selectDataLabel.map((item) => {\n          activeIds.push(item.id);\n        });\n        this.userFrom.label_id = activeIds.join(',');\n        this.getList();\n      } else {\n        this.userFrom.label_id = '';\n      }\n    },\n    handleClose(tag) {\n      let i = this.selectDataLabel.findIndex((item) => item.id === tag.id);\n      if (i !== -1) {\n        this.selectDataLabel.splice(i, 1);\n      }\n      this.$nextTick(() => {\n        if (this.selectDataLabel.length) {\n          let activeIds = [];\n          this.selectDataLabel.map((item) => {\n            activeIds.push(item.id);\n          });\n          this.userFrom.label_id = activeIds.join(',');\n        } else {\n          this.userFrom.label_id = '';\n        }\n      });\n      // this.userSearchs();\n    },\n    // 批量设置标签\n    activeData(data) {\n      let labels = [];\n      if (!data.length) return;\n      data.map((i) => {\n        labels.push(i.id);\n      });\n      saveSetLabel({\n        uids: this.ids.join(','),\n        label_id: labels,\n      }).then((res) => {\n        this.labelShow = false;\n        this.selectedIds = new Set();\n        this.getList();\n        this.$message.success(res.msg);\n      });\n    },\n    //是否为付费会员；\n    changeMember() {\n      this.userFrom.page = 1;\n      this.getList();\n    },\n    // 选择国家\n    changeCountry() {\n      if (this.userFrom.country === 'abroad' || !this.userFrom.country) {\n        this.selectedData = [];\n        this.userFrom.province = '';\n        this.userFrom.city = '';\n        this.address = [];\n      }\n    },\n    // 选择地址\n    handleChange(selectedData) {\n      this.selectedData = selectedData.map((o) => o.label);\n      this.userFrom.province = this.selectedData[0];\n      this.userFrom.city = this.selectedData[1];\n    },\n    // 具体日期\n    onchangeTime(e, type) {\n      this.userFrom[type] = e ? e.join('-') : '';\n    },\n    userDetail(row) {\n      this.$refs.userDetails.modals = true;\n      this.$refs.userDetails.getDetails(row.uid);\n    },\n    // 操作\n    changeMenu(row, name, index) {\n      let uid = [];\n      uid.push(row.uid);\n      let uids = { uids: uid };\n      switch (name) {\n        case '1':\n          this.edit(row);\n          break;\n        case '2':\n          this.getOtherFrom(row.uid, 'money');\n          break;\n        case '3':\n          this.giveLevelTime(row.uid);\n          break;\n        case '4':\n          this.del(row, '清除 【 ' + this.tenText(row.nickname) + ' 】的会员等级', index, 'user');\n          break;\n        case '5':\n          this.$modalForm(userSetGroup(uids)).then(() => this.getList());\n          break;\n        case '6':\n          this.openLabel(row);\n          break;\n        case '7':\n          this.editS(row);\n          break;\n        case '8':\n          this.getOtherFrom(row.uid, 'point');\n          break;\n        default:\n          this.del(row, '解除【 ' + this.tenText(row.nickname) + ' 】的上级推广人', index, 'tuiguang');\n      }\n    },\n    tenText(str) {\n      if (str.length > 10) {\n        //如果字符长度超过10，后面的字符就变成...可自行调整长度和代替字符\n        str = str.substr(0, 10) + '...'; //截取从第一个字符开始，往后取10个字符，剩余的用...代替\n      }\n      return str;\n    },\n    openLabel(row) {\n      this.labelShow = true;\n      this.labelActive.uid = row.uid;\n    },\n    openSelectLabel() {\n      this.selectLabelShow = true;\n    },\n    editS(row) {\n      this.promoterShow = true;\n      this.formInline.uid = row.uid;\n    },\n    customer() {\n      this.customerShow = true;\n    },\n    imageObject(e) {\n      this.customerShow = false;\n      this.formInline.spread_uid = e.uid;\n      this.formInline.image = e.image;\n    },\n    cancel(name) {\n      this.promoterShow = false;\n      this.$refs[name].resetFields();\n      this.formInline = {\n        uid: 0,\n        spread_uid: 0,\n        image: '',\n      };\n    },\n    // 赠送会员等级\n    giveLevel(id) {\n      this.$modalForm(giveLevelApi(id)).then(() => this.getList(1));\n\n      // giveLevelApi(id)\n      //   .then(async (res) => {\n      //     if (res.data.status === false) {\n      //       return this.$authLapse(res.data);\n      //     }\n\n      //     this.FromData = res.data;\n      //     this.$refs.edits.modals = true;\n      //   })\n      //   .catch((res) => {\n      //     this.$message.error(res.msg);\n      //   });\n    },\n    // 赠送会员等级\n    giveLevelTime(id) {\n      this.$modalForm(giveLevelTimeApi(id)).then(() => this.getList(1));\n\n      // giveLevelTimeApi(id)\n      //   .then(async (res) => {\n      //     if (res.data.status === false) {\n      //       return this.$authLapse(res.data);\n      //     }\n      //     this.FromData = res.data;\n      //     this.$refs.edits.modals = true;\n      //   })\n      //   .catch((res) => {\n      //     this.$message.error(res.msg);\n      //   });\n    },\n    // 删除\n    del(row, tit, num, name) {\n      let delfromData = {\n        title: tit,\n        num: num,\n        url: name === 'user' ? `user/del_level/${row.uid}` : `agent/stair/delete_spread/${row.uid}`,\n        method: name === 'user' ? 'DELETE' : 'PUT',\n        ids: '',\n        width: 600,\n      };\n      this.$modalSure(delfromData)\n        .then((res) => {\n          this.$message.success(res.msg);\n          this.getList();\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 清除会员删除成功\n    submitModel() {\n      this.getList();\n    },\n    // 会员列表\n    getList() {\n      // if (this.selectDataLabel.length) {\n      //   let activeIds = [];\n      //   this.selectDataLabel.forEach((item) => {\n      //     activeIds.push(item.id);\n      //   });\n      //   this.userFrom.label_id = activeIds.join(',');\n      // }\n      this.userFrom.user_type = this.userFrom.user_type || '';\n      this.userFrom.status = this.userFrom.status || '';\n      this.userFrom.sex = this.userFrom.sex || '';\n      this.userFrom.is_promoter = this.userFrom.is_promoter || '';\n      this.userFrom.country = this.userFrom.country || '';\n      this.userFrom.pay_count = this.pay_count === 'all' ? '' : this.pay_count;\n      this.userFrom.user_time_type = this.user_time_type === 'all' ? '' : this.user_time_type;\n      this.userFrom.field_key = this.field_key === 'all' ? '' : this.field_key;\n      this.userFrom.level = this.level === 'all' ? '' : this.level;\n      this.userFrom.group_id = this.group_id === 'all' ? '' : this.group_id;\n      this.userFrom.agent_level = this.agent_level === 'all' ? '' : this.agent_level;\n      this.loading = true;\n      userList(this.userFrom)\n        .then(async (res) => {\n          let data = res.data;\n          this.userLists = data.list;\n\n          this.total = data.count;\n          this.loading = false;\n          this.$nextTick(() => {\n            this.setChecked();\n          });\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$message.error(res.msg);\n        });\n    },\n    // 用户导出\n    async exportList() {\n      if (this.ids.length) {\n        this.userFrom.ids = this.ids;\n      }\n      this.userFrom.user_type = this.userFrom.user_type || '';\n      this.userFrom.status = this.userFrom.status || '';\n      this.userFrom.sex = this.userFrom.sex || '';\n      this.userFrom.is_promoter = this.userFrom.is_promoter || '';\n      this.userFrom.country = this.userFrom.country || '';\n      this.userFrom.pay_count = this.pay_count === 'all' ? '' : this.pay_count;\n      this.userFrom.user_time_type = this.user_time_type === 'all' ? '' : this.user_time_type;\n      this.userFrom.field_key = this.field_key === 'all' ? '' : this.field_key;\n      this.userFrom.level = this.level === 'all' ? '' : this.level;\n      this.userFrom.group_id = this.group_id === 'all' ? '' : this.group_id;\n      this.userFrom.agent_level = this.agent_level === 'all' ? '' : this.agent_level;\n      let [th, filekey, data, fileName] = [[], [], [], ''];\n      //   let fileName = \"\";\n      let excelData = JSON.parse(JSON.stringify(this.userFrom));\n      excelData.page = 1;\n      for (let i = 0; i < excelData.page + 1; i++) {\n        let lebData = await this.getExcelData(excelData);\n        if (!fileName) fileName = lebData.filename;\n        if (!filekey.length) {\n          filekey = lebData.fileKey;\n        }\n        if (!th.length) th = lebData.header;\n        if (lebData.export.length) {\n          data = data.concat(lebData.export);\n          excelData.page++;\n        } else {\n          this.$exportExcel(th, filekey, fileName, data);\n          return;\n        }\n      }\n    },\n    getExcelData(excelData) {\n      return new Promise((resolve, reject) => {\n        exportUserList(excelData).then((res) => {\n          resolve(res.data);\n        });\n      });\n    },\n    pageChange() {\n      this.selectionList = [];\n      this.getList();\n    },\n\n    // 搜索\n    userSearchs() {\n      this.userFrom.page = 1;\n      this.getList();\n    },\n    // 重置\n    reset(name) {\n      this.userFrom = {\n        label_id: '',\n        status: '',\n        sex: '',\n        is_promoter: '',\n        country: '',\n        isMember: '',\n        pay_count_num: ['', ''],\n        balance: ['', ''],\n        integral: ['', ''],\n        pay_count_money: ['', ''],\n        recharge_count: ['', ''],\n        user_time_type: '',\n        user_time: '',\n        before_pay_time: '',\n        nickname: '',\n        province: '',\n        city: '',\n        page: 1,\n        limit: 15,\n        level: '',\n        group_id: '',\n        agent_level: '',\n        field_key: '',\n        page: 1, // 当前页\n        limit: 20, // 每页显示条数\n      };\n      this.field_key = '';\n      this.level = '';\n      this.group_id = '';\n      this.agent_level = '';\n      this.dataLabel = [];\n      this.selectDataLabel = [];\n      this.user_time_type = '';\n      this.pay_count = '';\n      this.timeVal = [];\n      this.selectedIds = new Set();\n      this.getList();\n    },\n    // 获取编辑表单数据\n    getUserFrom(id) {\n      getUserInfo(id)\n        .then(async (res) => {\n          this.modals = true;\n          this.userData = res.data;\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 获取积分余额表单\n    getOtherFrom(id, type) {\n      this.$modalForm(editOtherApi(id, type)).then(() => this.getList(1));\n    },\n    // 修改状态\n    onchangeIsShow(row) {\n      let data = {\n        id: row.uid,\n        status: row.status,\n      };\n      isShowApi(data)\n        .then(async (res) => {\n          this.$message.success(res.msg);\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 点击发送优惠券\n    onSend() {\n      if (this.ids.length === 0) {\n        this.$message.warning('请选择要发送优惠券的用户');\n      } else {\n        this.$refs.sends.modals = true;\n        this.$refs.sends.getList();\n      }\n    },\n    // 发送图文消息\n    onSendPic() {\n      if (this.ids.length === 0) {\n        this.$message.warning('请选择要发送图文消息的用户');\n      } else {\n        this.modal13 = true;\n      }\n    },\n    // 编辑\n    edit(row) {\n      this.getUserFrom(row.uid);\n    },\n    // 修改成功\n    submitFail() {\n      // this.getList();\n    },\n    // 排序\n    sortChanged(e, props, order) {\n      this.userFrom[e.prop] = e.order;\n      this.getList();\n    },\n    //全选和取消全选时触发\n    handleSelectAll(selection) {\n      let ids = [];\n      selection.map((e) => {\n        ids.push(e.uid);\n      });\n      this.selectedIds = ids;\n      this.$nextTick(() => {\n        //确保dom加载完毕\n        this.setChecked();\n      });\n    },\n    //  选中某一行\n    handleSelectRow(selection, row) {\n      let ids = [];\n      selection.map((e) => {\n        ids.push(e.uid);\n      });\n      this.selectedIds = ids;\n      this.$nextTick(() => {\n        //确保dom加载完毕\n        this.setChecked();\n      });\n    },\n    setChecked() {\n      //将new Set()转化为数组\n      this.ids = [...this.selectedIds];\n      // 找到绑定的table的ref对应的dom，找到table的objData对象，objData保存的是当前页的数据\n      let objData = this.$refs.table.objData;\n      for (let index in objData) {\n        if (this.selectedIds.has(objData[index].uid)) {\n          objData[index]._isChecked = true;\n        }\n      }\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n::v-deep .el-tabs__item {\n  height: 54px !important;\n  line-height: 54px !important;\n}\n\n.picBox {\n  display: inline-block;\n  cursor: pointer;\n\n  .upLoad {\n    width: 58px;\n    height: 58px;\n    line-height: 58px;\n    border: 1px dotted rgba(0, 0, 0, 0.1);\n    border-radius: 4px;\n    background: rgba(0, 0, 0, 0.02);\n    font-size: 24px;\n    font-weight: 500;\n  }\n\n  .pictrue {\n    width: 60px;\n    height: 60px;\n    border: 1px dotted rgba(0, 0, 0, 0.1);\n    margin-right: 10px;\n\n    img {\n      width: 100%;\n      height: 100%;\n    }\n  }\n}\n.fix_footer {\n  position: fixed;\n  bottom: 0;\n  width: -webkit-fill-available;\n  background: #fff;\n  padding: 20px 0px;\n  box-sizing: border-box;\n  z-index: 100;\n}\n.userFrom {\n  ::v-deep .ivu-form-item-content {\n    margin-left: 0px !important;\n  }\n}\n\n.userAlert {\n  margin-top: 20px;\n}\n\n.userI {\n  color: var(--prev-color-primary);\n  font-style: normal;\n}\n\nimg {\n  height: 36px;\n  display: block;\n}\n\n.tabBox_img {\n  width: 36px;\n  height: 36px;\n  border-radius: 4px;\n  cursor: pointer;\n\n  img {\n    width: 100%;\n    height: 100%;\n  }\n}\n\n.tabBox_tit {\n  width: 60%;\n  font-size: 12px !important;\n  margin: 0 2px 0 10px;\n  letter-spacing: 1px;\n  padding: 5px 0;\n  box-sizing: border-box;\n}\n\n.modelBox {\n  ::v-deep .ivu-modal-body {\n    padding: 0 16px 16px 16px !important;\n  }\n}\n\n.vipName {\n  color: #dab176;\n}\n\n.listbox {\n  ::v-deep .ivu-divider-horizontal {\n    margin: 0 !important;\n  }\n}\n\n.labelInput {\n  width: 250px;\n  border: 1px solid #dcdee2;\n  padding: 0 15px;\n  border-radius: 5px;\n  min-height: 30px;\n  cursor: pointer;\n  font-size: 12px;\n\n  .span {\n    color: #c5c8ce;\n  }\n\n  .ivu-icon-ios-arrow-down {\n    font-size: 14px;\n    color: #808695;\n  }\n}\n\n.demo-drawer-footer {\n  width: 100%;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  border-top: 1px solid #e8e8e8;\n  padding: 10px 16px;\n  text-align: right;\n  background: #fff;\n}\n\n.search-form {\n  display: flex;\n  justify-content: space-between;\n\n  .search-form-box {\n    display: flex;\n    flex-wrap: wrap;\n    flex: 1;\n  }\n}\n\n.search-form-sub {\n  display: flex;\n}\n</style>\n"]}]}