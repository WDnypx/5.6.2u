{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\product\\paramList\\paramAdd.vue?vue&type=style&index=0&id=6d09763c&lang=scss&scoped=true","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\product\\paramList\\paramAdd.vue","mtime":1745474911001},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\css-loader\\index.js","mtime":1753254259822},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1753254262918},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\postcss-loader\\src\\index.js","mtime":1753254258547},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1753254255270},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5ydWxlc0JveCB7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIGZsZXgtd3JhcDogd3JhcDsKfQouYXR0ckZyb20gewogIDo6di1kZWVwIC5pdnUtZm9ybS1pdGVtIHsKICAgIG1hcmdpbi1ib3R0b206IDBweCAhaW1wb3J0YW50OwogIH0KfQoubm9Gb3JtIHsKICBtYXJnaW4tbGVmdDogMTJweDsKfQouYWRkIHsKICBtYXJnaW4tbGVmdDogMTMycHg7Cn0KLmRyYWcgewogIGN1cnNvcjogbW92ZTsKfQoudmFsdWUgewogIGRpc3BsYXk6IGJsb2NrOwogIG1hcmdpbjogNXB4IDA7CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIC5lbC1pY29uLWVycm9yIHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIGRpc3BsYXk6IG5vbmU7CiAgICByaWdodDogLTNweDsKICAgIHRvcDogLTNweDsKICAgIHotaW5kZXg6IDk7CiAgfQp9Ci52YWx1ZTpob3ZlciB7CiAgLmVsLWljb24tZXJyb3IgewogICAgZGlzcGxheTogYmxvY2s7CiAgICB6LWluZGV4OiA5OTk7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgfQp9Ci5tb3ZlLWljb24gewogIHdpZHRoOiAzMHB4OwogIGN1cnNvcjogbW92ZTsKICBtYXJnaW4tcmlnaHQ6IDEwcHg7Cn0KLm1vdmUtaWNvbiAuaWNvbmRyYWcyIHsKICBmb250LXNpemU6IDI2cHg7CiAgY29sb3I6ICNiYmI7Cn0KLnNwZWNpZmljYXRpb25zIHsKICAuc3BlY2lmaWNhdGlvbnMtaXRlbTpob3ZlciB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1wcmV2LWJnLW1lbnUtaG92ZXItYmEtY29sb3IpOwogIH0KICAuc3BlY2lmaWNhdGlvbnMtaXRlbTpob3ZlciAuZGVsIHsKICAgIGRpc3BsYXk6IGJsb2NrOwogIH0KICAuc3BlY2lmaWNhdGlvbnMtaXRlbTpsYXN0LWNoaWxkIHsKICAgIG1hcmdpbi1ib3R0b206IDE0cHg7CiAgfQogIC5zcGVjaWZpY2F0aW9ucy1pdGVtIHsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgcGFkZGluZzogMjBweCAxNXB4OwogICAgdHJhbnNpdGlvbjogYWxsIDAuMXM7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmFmYWZhOwogICAgbWFyZ2luLWJvdHRvbTogMTBweDsKICAgIGJvcmRlci1yYWRpdXM6IDRweDsKICAgIC5kZWwgewogICAgICBkaXNwbGF5OiBub25lOwogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHJpZ2h0OiAxNXB4OwogICAgICB0b3A6IDE1cHg7CiAgICAgIGZvbnQtc2l6ZTogMjJweDsKICAgICAgY29sb3I6IHZhcigtLXByZXYtY29sb3ItcHJpbWFyeSk7CiAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIH0KICAgIC5zcGVjaWZpY2F0aW9ucy1pdGVtLWJveCB7CiAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgLmxpbmVCb3ggewogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICBsZWZ0OiAxM3B4OwogICAgICAgIHRvcDogMjRweDsKICAgICAgICB3aWR0aDogMzBweDsKICAgICAgICBoZWlnaHQ6IDQ1cHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgICAgIGJvcmRlci1sZWZ0OiAxcHggc29saWQgI2RjZGZlNjsKICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2RjZGZlNjsKICAgICAgfQogICAgICAuc3BlY2lmaWNhdGlvbnMtaXRlbS1uYW1lLWlucHV0IHsKICAgICAgICB3aWR0aDogMjAwcHg7CiAgICAgIH0KICAgIH0KICB9CiAgLnJ1bGVzQm94IHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgLml0ZW0gewogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICB9CiAgICAuYWRkZm9udCB7CiAgICAgIG1hcmdpbi10b3A6IDVweDsKICAgIH0KICAgIDo6di1kZWVwIC5lbC1wb3BvdmVyIHsKICAgICAgYm9yZGVyOiBub25lOwogICAgICBib3gtc2hhZG93OiBub25lOwogICAgICBwYWRkaW5nOiAwOwogICAgICBtYXJnaW4tdG9wOiA1cHg7CiAgICAgIGxpbmUtaGVpZ2h0OiAxLjU7CiAgICB9CiAgfQogIC5hZGRmb250IHsKICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgIGZvbnQtc2l6ZTogMTJweDsKICAgIGZvbnQtd2VpZ2h0OiA0MDA7CiAgICBjb2xvcjogdmFyKC0tcHJldi1jb2xvci1wcmltYXJ5KTsKICAgIG1hcmdpbi1sZWZ0OiAxNHB4OwogICAgY3Vyc29yOiBwb2ludGVyOwogIH0KfQo="},{"version":3,"sources":["paramAdd.vue"],"names":[],"mappings":";AAuPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"paramAdd.vue","sourceRoot":"src/pages/product/paramList","sourcesContent":["<template>\n  <el-dialog :visible.sync=\"modal\" @closed=\"onCancel\" title=\"商品参数\" width=\"1000px\" v-loading=\"spinShow\">\n    <el-form\n      ref=\"formDynamic\"\n      :model=\"formDynamic\"\n      class=\"attrFrom\"\n      label-position=\"right\"\n      label-width=\"auto\"\n      @submit.native.prevent\n    >\n      <el-row :gutter=\"24\">\n        <el-col :span=\"24\">\n          <el-col :span=\"8\">\n            <el-form-item label=\"模板名称：\" prop=\"rule_name\">\n              <el-input placeholder=\"请输入模板名称\" :maxlength=\"20\" v-model.trim=\"formDynamic.name\" />\n            </el-form-item>\n          </el-col>\n        </el-col>\n        <el-col :span=\"24\">\n          <el-col :span=\"8\">\n            <el-form-item label=\"排序：\" prop=\"rule_name\">\n              <el-input type=\"number\" placeholder=\"请输入排序\" :maxlength=\"20\" v-model.trim=\"formDynamic.sort\" />\n            </el-form-item>\n          </el-col>\n        </el-col>\n        <el-col :span=\"24\" class=\"noForm\" :key=\"index\">\n          <el-form-item label=\"\">\n            <div class=\"specifications\">\n              <el-table ref=\"selection\" :data=\"formDynamic.value\">\n                <el-table-column width=\"50\">\n                  <template slot-scope=\"scope\">\n                    <div class=\"drag\" @on-drag-drop=\"onDragDrop\">\n                      <img class=\"handle\" src=\"@/assets/images/drag-icon.png\" alt=\"\" />\n                    </div>\n                  </template>\n                </el-table-column>\n                <el-table-column label=\"参数名称\" min-width=\"80\">\n                  <template slot-scope=\"scope\">\n                    <el-input v-model=\"scope.row.name\"></el-input>\n                  </template>\n                </el-table-column>\n                <el-table-column label=\"参数值\" min-width=\"80\">\n                  <template slot-scope=\"scope\">\n                    <el-input v-model=\"scope.row.value\"></el-input>\n                  </template>\n                </el-table-column>\n\n                <el-table-column label=\"操作\" fixed=\"right\" width=\"80\">\n                  <template slot-scope=\"scope\">\n                    <a class=\"submission mr15\" v-db-click @click=\"deleteRow(scope.$index)\">删除</a>\n                  </template>\n                </el-table-column>\n              </el-table>\n              <el-button\n                v-if=\"formDynamic.value.length < 8\"\n                type=\"primary\"\n                class=\"submission mr15 mt20\"\n                v-db-click\n                @click=\"handleAddRole\"\n                >添加参数</el-button\n              >\n            </div>\n          </el-form-item>\n        </el-col>\n      </el-row>\n    </el-form>\n    <span slot=\"footer\" class=\"dialog-footer\">\n      <el-button v-db-click @click=\"onClose\">取消</el-button>\n      <el-button type=\"primary\" :loading=\"modal_loading\" v-db-click @click=\"handleSubmit('formDynamic')\"\n        >确定</el-button\n      >\n    </span>\n  </el-dialog>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport { paramSaveApi, paramInfoApi } from '@/api/product';\nimport vuedraggable from 'vuedraggable';\nimport Sortable from 'sortablejs';\nexport default {\n  name: 'addAttr',\n  components: {\n    draggable: vuedraggable,\n  },\n  data() {\n    return {\n      spinShow: false,\n      modal_loading: false,\n      grid: {\n        xl: 3,\n        lg: 3,\n        md: 12,\n        sm: 24,\n        xs: 24,\n      },\n      modal: false,\n      index: 1,\n      formDynamic: {\n        id: 0,\n        name: '',\n        sort: 0,\n        value: [],\n      },\n      attrsName: '',\n      attrsVal: '',\n      formDynamicNameData: [],\n      isBtn: false,\n      formDynamicName: [],\n      results: [],\n      result: [],\n      ids: 0,\n    };\n  },\n  watch: {\n    modal(val) {\n      if (val) {\n        this.$nextTick(() => {\n          this.setSort();\n        });\n      }\n    },\n  },\n  mounted() {},\n  methods: {\n    setSort() {\n      // ref一定跟table上面的ref一致\n      const el = this.$refs.selection.$el.querySelectorAll('.el-table__body-wrapper > table > tbody')[0];\n      this.sortable = Sortable.create(el, {\n        ghostClass: 'sortable-ghost',\n        handle: '.handle',\n        setData: function (dataTransfer) {\n          dataTransfer.setData('Text', '');\n        },\n        // 监听拖拽事件结束时触发\n        onEnd: (evt) => {\n          this.elChangeExForArray(evt.oldIndex, evt.newIndex, this.formDynamic.value);\n        },\n      });\n    },\n    elChangeExForArray(index1, index2, array, init) {\n      const arr = array;\n      const temp = array[index1];\n      const tempt = array[index2];\n      if (init) {\n        arr[index2] = tempt;\n        arr[index1] = temp;\n      } else {\n        arr[index1] = tempt;\n        arr[index2] = temp;\n      }\n      this.formDynamic.value = [];\n      this.$nextTick((e) => {\n        this.formDynamic.value = arr;\n      });\n    },\n    handleShowPop(index) {\n      this.$refs['inputRef_' + index][0].focus();\n    },\n    handleAddRole() {\n      let data = {\n        name: '',\n        value: '',\n      };\n      this.formDynamic.value.push(data);\n    },\n    onCancel() {\n      this.ids = 0;\n      this.clear();\n    },\n    onClose() {\n      this.ids = 0;\n      this.clear();\n      this.modal = false;\n    },\n    deleteRow(index) {\n      this.formDynamic.value.splice(index, 1);\n    },\n    // 添加按钮\n    addBtn() {\n      this.isBtn = true;\n    },\n    //修改排序\n    onDragDrop(a, b) {\n      console.log(a, b);\n      this.formDynamic.value.splice(b, 1, ...this.formDynamic.value.splice(a, 1, this.formDynamic.value[b]));\n    },\n    // 详情\n    getIofo(row) {\n      this.ids = row.id;\n      paramInfoApi(row.id)\n        .then((res) => {\n          this.formDynamic = res.data;\n        })\n        .catch((res) => {\n          this.spinShow = false;\n          this.$message.error(res.msg);\n        });\n    },\n    // 提交\n    handleSubmit(name) {\n      this.$refs[name].validate((valid) => {\n        if (valid) {\n          if (this.formDynamic.value.length === 0) {\n            return this.$message.warning('请至少添加一条商品参数！');\n          }\n          this.modal_loading = true;\n          paramSaveApi(this.formDynamic)\n            .then((res) => {\n              this.$message.success(res.msg);\n              setTimeout(() => {\n                this.modal = false;\n                this.modal_loading = false;\n              }, 500);\n              setTimeout(() => {\n                this.$emit('getList');\n                this.clear();\n              }, 600);\n            })\n            .catch((res) => {\n              this.modal_loading = false;\n              this.$message.error(res.msg);\n            });\n        } else {\n          return false;\n        }\n      });\n    },\n    clear() {\n      this.$refs['formDynamic'].resetFields();\n      this.formDynamic.value = [];\n      this.formDynamic.name = '';\n      this.formDynamic.sort = '';\n      this.isBtn = false;\n      this.attrsName = '';\n      this.attrsVal = '';\n      this.ids = 0;\n    },\n    // 删除\n    handleRemove(index) {\n      this.formDynamic.value.splice(index, 1);\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.rulesBox {\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n}\n.attrFrom {\n  ::v-deep .ivu-form-item {\n    margin-bottom: 0px !important;\n  }\n}\n.noForm {\n  margin-left: 12px;\n}\n.add {\n  margin-left: 132px;\n}\n.drag {\n  cursor: move;\n}\n.value {\n  display: block;\n  margin: 5px 0;\n  position: relative;\n  .el-icon-error {\n    position: absolute;\n    display: none;\n    right: -3px;\n    top: -3px;\n    z-index: 9;\n  }\n}\n.value:hover {\n  .el-icon-error {\n    display: block;\n    z-index: 999;\n    cursor: pointer;\n  }\n}\n.move-icon {\n  width: 30px;\n  cursor: move;\n  margin-right: 10px;\n}\n.move-icon .icondrag2 {\n  font-size: 26px;\n  color: #bbb;\n}\n.specifications {\n  .specifications-item:hover {\n    background-color: var(--prev-bg-menu-hover-ba-color);\n  }\n  .specifications-item:hover .del {\n    display: block;\n  }\n  .specifications-item:last-child {\n    margin-bottom: 14px;\n  }\n  .specifications-item {\n    position: relative;\n    display: flex;\n    align-items: center;\n    padding: 20px 15px;\n    transition: all 0.1s;\n    background-color: #fafafa;\n    margin-bottom: 10px;\n    border-radius: 4px;\n    .del {\n      display: none;\n      position: absolute;\n      right: 15px;\n      top: 15px;\n      font-size: 22px;\n      color: var(--prev-color-primary);\n      cursor: pointer;\n    }\n    .specifications-item-box {\n      position: relative;\n      .lineBox {\n        position: absolute;\n        left: 13px;\n        top: 24px;\n        width: 30px;\n        height: 45px;\n        border-radius: 6px;\n        border-left: 1px solid #dcdfe6;\n        border-bottom: 1px solid #dcdfe6;\n      }\n      .specifications-item-name-input {\n        width: 200px;\n      }\n    }\n  }\n  .rulesBox {\n    display: flex;\n    flex-wrap: wrap;\n    align-items: center;\n    .item {\n      display: flex;\n      flex-wrap: wrap;\n    }\n    .addfont {\n      margin-top: 5px;\n    }\n    ::v-deep .el-popover {\n      border: none;\n      box-shadow: none;\n      padding: 0;\n      margin-top: 5px;\n      line-height: 1.5;\n    }\n  }\n  .addfont {\n    display: inline-block;\n    font-size: 12px;\n    font-weight: 400;\n    color: var(--prev-color-primary);\n    margin-left: 14px;\n    cursor: pointer;\n  }\n}\n</style>\n"]}]}