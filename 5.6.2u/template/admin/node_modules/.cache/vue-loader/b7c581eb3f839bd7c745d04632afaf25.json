{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\setting\\ticket\\content.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\setting\\ticket\\content.vue","mtime":1739958947277},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1753254258567},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IG1hcFN0YXRlLCBtYXBNdXRhdGlvbnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IHsgcHJpbnRDb250ZW50LCBwcmludFNhdmVDb250ZW50IH0gZnJvbSAnQC9hcGkvc2V0dGluZyc7CmltcG9ydCBsaW5rYWRkcmVzcyBmcm9tICdAL2NvbXBvbmVudHMvbGlua2FkZHJlc3MnOwppbXBvcnQgUVJDb2RlIGZyb20gJ3FyY29kZWpzMic7CmltcG9ydCBTZXR0aW5nIGZyb20gJ0Avc2V0dGluZyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnY29udGVudCcsCiAgY29tcG9uZW50czogeyBsaW5rYWRkcmVzcyB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBmb3JtSXRlbTogewogICAgICAgIGhlYWRlcjogMSwKICAgICAgICBkZWxpdmVyeTogMSwKICAgICAgICBidXllcl9yZW1hcmtzOiAxLAogICAgICAgIGdvb2RzOiBbMF0sCiAgICAgICAgZnJlaWdodDogMSwKICAgICAgICBwcmVmZXJlbnRpYWw6IDEsCiAgICAgICAgcGF5OiBbMCwgMV0sCiAgICAgICAgb3JkZXI6IFswLCAxXSwKICAgICAgICBjb2RlOiAwLAogICAgICAgIGNvZGVfdXJsOiAnJywKICAgICAgICBzaG93X25vdGljZTogMCwKICAgICAgICBub3RpY2VfY29udGVudDogJycsCiAgICAgIH0sCiAgICAgIGNvZGU6ICcnLAogICAgICBCYXNlVVJMOiBTZXR0aW5nLmFwaUJhc2VVUkwucmVwbGFjZSgvXC9hZG1pbmFwaS8sICcnKSwKICAgICAgaWQ6IHRoaXMuJHJvdXRlLnF1ZXJ5LmlkLAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZSgnYWRtaW4vbGF5b3V0JywgWydpc01vYmlsZScsICdtZW51Q29sbGFwc2UnXSksCiAgICBsYWJlbFdpZHRoKCkgewogICAgICByZXR1cm4gdGhpcy5pc01vYmlsZSA/IHVuZGVmaW5lZCA6IDEyMDsKICAgIH0sCiAgICBsYWJlbFBvc2l0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5pc01vYmlsZSA/ICd0b3AnIDogJ3JpZ2h0JzsKICAgIH0sCiAgICBsYWJlbEJvdHRvbSgpIHsKICAgICAgcmV0dXJuIHRoaXMuaXNNb2JpbGUgPyB1bmRlZmluZWQgOiAxNTsKICAgIH0sCiAgfSwKICBjcmVhdGVkKCkgewogICAgaWYgKHRoaXMuaWQpIHRoaXMuZ2V0UHJpbnRDb250ZW50KCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRQcmludENvbnRlbnQoKSB7CiAgICAgIHByaW50Q29udGVudCh0aGlzLmlkKS50aGVuKChyZXMpID0+IHsKICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkocmVzLmRhdGEpKSB0aGlzLmZvcm1JdGVtID0gcmVzLmRhdGE7CiAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgJiYgcmVzLmRhdGEuY29kZV91cmwpIHsKICAgICAgICAgIHRoaXMuY29kZSA9IHRoaXMuQmFzZVVSTCArIHJlcy5kYXRhLmNvZGVfdXJsOwogICAgICAgICAgdGhpcy4kbmV4dFRpY2soKGUpID0+IHsKICAgICAgICAgICAgdGhpcy5kcmF3Q29kZSh0aGlzLmNvZGUpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBzYXZlKCkgewogICAgICBwcmludFNhdmVDb250ZW50KHRoaXMuaWQsIHRoaXMuZm9ybUl0ZW0pCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfkv53lrZjmiJDlip8nKTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfkv53lrZjlpLHotKUnKTsKICAgICAgICB9KTsKICAgIH0sCiAgICBnZXRMaW5rKGluZGV4KSB7CiAgICAgIHRoaXMuJHJlZnMubGlua2FkZHJlcy5tb2RhbHMgPSB0cnVlOwogICAgfSwKICAgIGxpbmtVcmwoZSkgewogICAgICB0aGlzLmZvcm1JdGVtLmNvZGVfdXJsID0gZTsKICAgICAgbGV0IHVybCA9IHRoaXMuQmFzZVVSTCArIGU7CiAgICAgIHRoaXMuZHJhd0NvZGUodXJsKTsKICAgIH0sCiAgICBkcmF3Q29kZSh1cmwpIHsKICAgICAgbGV0IHFyY29kZSA9ICcnOwogICAgICBsZXQgb2JqID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3FyY29kZScpOwogICAgICBvYmouaW5uZXJIVE1MID0gJyc7CiAgICAgIHFyY29kZSA9IG5ldyBRUkNvZGUob2JqLCB7CiAgICAgICAgdGV4dDogdXJsLCAvLyDpnIDopoHovazmjaLkuLrkuoznu7TnoIHnmoTlhoXlrrkKICAgICAgICB3aWR0aDogMTI4LAogICAgICAgIGhlaWdodDogMTI4LAogICAgICAgIGNvbG9yRGFyazogJyMwMDAwMDAnLAogICAgICAgIGNvbG9yTGlnaHQ6ICcjZmZmZmZmJywKICAgICAgICBjb3JyZWN0TGV2ZWw6IFFSQ29kZS5Db3JyZWN0TGV2ZWwuSCwKICAgICAgfSk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["content.vue"],"names":[],"mappings":";AAoMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"content.vue","sourceRoot":"src/pages/setting/ticket","sourcesContent":["<template>\n  <div>\n    <pages-header ref=\"pageHeader\" title=\"小票配置\" :backUrl=\"$routeProStr + '/setting/ticket'\"></pages-header>\n    <el-card :bordered=\"false\" shadow=\"never\" class=\"mt16\">\n      <div class=\"flex justify-between warpper\">\n        <el-form :model=\"formItem\" label-width=\"120px\">\n          <el-form-item label=\"小票头部：\">\n            <el-checkbox v-model=\"formItem.header\" :true-label=\"1\" :false-label=\"0\">商家名称</el-checkbox>\n          </el-form-item>\n          <el-form-item label=\"配送信息：\">\n            <el-checkbox v-model=\"formItem.delivery\" :true-label=\"1\" :false-label=\"0\">配送信息</el-checkbox>\n          </el-form-item>\n          <el-form-item label=\"买家备注：\">\n            <el-checkbox v-model=\"formItem.buyer_remarks\" :true-label=\"1\" :false-label=\"0\">买家备注</el-checkbox>\n          </el-form-item>\n          <el-form-item label=\"商品信息：\">\n            <el-checkbox-group v-model=\"formItem.goods\">\n              <el-checkbox :label=\"0\">商品基础信息</el-checkbox>\n              <el-checkbox :label=\"1\">规格编码</el-checkbox>\n            </el-checkbox-group>\n          </el-form-item>\n          <el-form-item label=\"运费信息：\">\n            <el-checkbox v-model=\"formItem.freight\" :true-label=\"1\" :false-label=\"0\">运费</el-checkbox>\n          </el-form-item>\n          <el-form-item label=\"优惠信息：\">\n            <el-checkbox v-model=\"formItem.preferential\" :true-label=\"1\" :false-label=\"0\">优惠总计</el-checkbox>\n          </el-form-item>\n          <el-form-item label=\"支付信息：\">\n            <el-checkbox-group v-model=\"formItem.pay\">\n              <el-checkbox :label=\"0\">支付方式</el-checkbox>\n              <el-checkbox :label=\"1\">实收金额</el-checkbox>\n            </el-checkbox-group>\n          </el-form-item>\n          <el-form-item label=\"其他订单信息：\">\n            <el-checkbox-group v-model=\"formItem.order\">\n              <el-checkbox :label=\"0\">订单编号</el-checkbox>\n              <el-checkbox :label=\"1\">下单时间</el-checkbox>\n              <el-checkbox :label=\"2\">支付时间</el-checkbox>\n              <el-checkbox :label=\"3\">打印时间</el-checkbox>\n            </el-checkbox-group>\n          </el-form-item>\n          <el-form-item label=\"推广二维码：\">\n            <el-checkbox v-model=\"formItem.code\" :true-label=\"1\" :false-label=\"0\">选择系统链接</el-checkbox>\n            <div v-if=\"formItem.code\" class=\"link\">\n              <div class=\"select-link\">\n                链接：{{ formItem.code_url }}\n                <span class=\"change\" @click=\"getLink(index)\">{{ formItem.code_url ? '修改' : '选择' }}</span>\n              </div>\n            </div>\n          </el-form-item>\n          <el-form-item label=\"底部公告：\">\n            <el-checkbox v-model=\"formItem.show_notice\" :true-label=\"1\" :false-label=\"0\">底部公告</el-checkbox>\n            <div v-if=\"formItem.show_notice\">\n              <el-input\n                v-model=\"formItem.notice_content\"\n                maxlength=\"80\"\n                show-word-limit\n                type=\"textarea\"\n                placeholder=\"请输入公告内容\"\n                style=\"width: 500px\"\n              />\n            </div>\n          </el-form-item>\n        </el-form>\n        <div class=\"ticket-preview\">\n          <div class=\"out-line\"></div>\n          <div class=\"ticket-content\">\n            <div v-if=\"formItem.header === 1\" class=\"ticket-header\">商家名称</div>\n            <!-- 配送方式 -->\n            <div class=\"delivery btn-line\" v-if=\"formItem.delivery === 1\">\n              <div class=\"form-box\">\n                <div class=\"label\">配送方式：</div>\n                <div class=\"content\">商家配送</div>\n              </div>\n              <div class=\"form-box\">\n                <div class=\"label\">客户姓名：</div>\n                <div class=\"content\">收货人姓名</div>\n              </div>\n              <div class=\"form-box\">\n                <div class=\"label\">客户电话：</div>\n                <div class=\"content\">13023354455</div>\n              </div>\n              <div class=\"form-box\">\n                <div class=\"label\">收货地址：</div>\n                <div class=\"content\">上海市浦东新区世界大道25号B座309室</div>\n              </div>\n            </div>\n            <!-- 备注 -->\n            <div class=\"buyer-remarks btn-line\" v-if=\"formItem.buyer_remarks === 1\">\n              <div class=\"form-box\">\n                <div class=\"label\">买家备注：</div>\n                <div class=\"content\">请在收货时向商家留言，谢谢！</div>\n              </div>\n            </div>\n            <!-- 商品 -->\n            <div v-if=\"formItem.goods.includes(0)\">\n              <div class=\"goods btn-line\">\n                <div class=\"xing\">*************************商品***********************</div>\n                <div class=\"flex justify-between\">\n                  <span>商品</span>\n                  <span>单价</span>\n                  <span>数量</span>\n                  <span>金额</span>\n                </div>\n              </div>\n              <div class=\"goods-msg btn-line\">\n                <div class=\"flex justify-between\">\n                  <span>商品1</span>\n                  <span>100.0</span>\n                  <span>2</span>\n                  <span>200.0</span>\n                </div>\n                <div class=\"flex justify-between\">\n                  <span>(规格1)</span>\n                  <span></span>\n                  <span></span>\n                  <span></span>\n                </div>\n                <div v-if=\"formItem.goods.includes(1)\" class=\"flex py-10\">\n                  <span>规格编码：</span>\n                  <span>FKXQW4567vw59</span>\n                </div>\n              </div>\n              <div class=\"goods-msg pb-10 pt-10\">\n                <div class=\"flex justify-between\">\n                  <span>商品2</span>\n                  <span>100.0</span>\n                  <span>2</span>\n                  <span>200.0</span>\n                </div>\n                <div class=\"flex justify-between\">\n                  <span>(规格2)</span>\n                  <span></span>\n                  <span></span>\n                  <span></span>\n                </div>\n                <div v-if=\"formItem.goods.includes(1)\" class=\"flex py-10\">\n                  <span>规格编码：</span>\n                  <span>FKXQW4567vw50</span>\n                </div>\n              </div>\n              <div class=\"xing\">**************************************************</div>\n              <!-- 合计 -->\n              <div class=\"pay flex flex-col align-end btn-line\">\n                <template>\n                  <div class=\"fw-500\">合计：400.00元</div>\n                </template>\n              </div>\n            </div>\n            <!-- 运费优惠 -->\n            <div\n              class=\"pay flex flex-col align-end btn-line\"\n              v-if=\"formItem.freight === 1 || formItem.preferential === 1\"\n            >\n              <template>\n                <div v-if=\"formItem.freight === 1\">运费：+30.00元</div>\n                <div v-if=\"formItem.preferential === 1\">优惠：-80.00元</div>\n                <div v-if=\"formItem.preferential === 1\">抵扣：-20.00元</div>\n              </template>\n            </div>\n            <!-- 支付信息 -->\n\n            <div class=\"pay flex flex-col align-end btn-line\" v-if=\"formItem.pay.length > 0\">\n              <div v-if=\"formItem.pay.includes(0)\">支付方式：微信支付</div>\n              <div v-if=\"formItem.pay.includes(1)\" class=\"fw-500\">实际支付：330.00元</div>\n            </div>\n            <!-- 订单信息 -->\n\n            <div class=\"order pt-10 btn-line\" v-if=\"formItem.order.length > 0\">\n              <div v-if=\"formItem.order.includes(0)\">订单编号：wx1234567890</div>\n              <div v-if=\"formItem.order.includes(1)\">下单时间：2022/06/18 12:00:00</div>\n              <div v-if=\"formItem.order.includes(2)\">支付时间：2022/06/18 12:00:00</div>\n              <div v-if=\"formItem.order.includes(3)\">打印时间：2022/06/18 14:20:00</div>\n            </div>\n            <!-- 二维码 -->\n            <div class=\"code\">\n              <div v-show=\"formItem.code\" id=\"qrcode\"></div>\n              <div class=\"mt-20\" v-if=\"formItem.show_notice\">\n                {{ formItem.notice_content }}\n              </div>\n            </div>\n          </div>\n          <div class=\"bottom-notice\">\n            <img class=\"image\" src=\"@/assets/images/p-btn.png\" alt=\"\" />\n          </div>\n        </div>\n      </div>\n    </el-card>\n    <el-card :bordered=\"false\" dis-hover class=\"fixed-card\">\n      <el-button type=\"primary\" class=\"submission\" @click=\"save\">保存</el-button>\n    </el-card>\n    <linkaddress ref=\"linkaddres\" @linkUrl=\"linkUrl\"></linkaddress>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapMutations } from 'vuex';\nimport { printContent, printSaveContent } from '@/api/setting';\nimport linkaddress from '@/components/linkaddress';\nimport QRCode from 'qrcodejs2';\nimport Setting from '@/setting';\nexport default {\n  name: 'content',\n  components: { linkaddress },\n  data() {\n    return {\n      formItem: {\n        header: 1,\n        delivery: 1,\n        buyer_remarks: 1,\n        goods: [0],\n        freight: 1,\n        preferential: 1,\n        pay: [0, 1],\n        order: [0, 1],\n        code: 0,\n        code_url: '',\n        show_notice: 0,\n        notice_content: '',\n      },\n      code: '',\n      BaseURL: Setting.apiBaseURL.replace(/\\/adminapi/, ''),\n      id: this.$route.query.id,\n    };\n  },\n  computed: {\n    ...mapState('admin/layout', ['isMobile', 'menuCollapse']),\n    labelWidth() {\n      return this.isMobile ? undefined : 120;\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'right';\n    },\n    labelBottom() {\n      return this.isMobile ? undefined : 15;\n    },\n  },\n  created() {\n    if (this.id) this.getPrintContent();\n  },\n  methods: {\n    getPrintContent() {\n      printContent(this.id).then((res) => {\n        if (!Array.isArray(res.data)) this.formItem = res.data;\n        if (res.data.code && res.data.code_url) {\n          this.code = this.BaseURL + res.data.code_url;\n          this.$nextTick((e) => {\n            this.drawCode(this.code);\n          });\n        }\n      });\n    },\n    save() {\n      printSaveContent(this.id, this.formItem)\n        .then((res) => {\n          this.$message.success('保存成功');\n        })\n        .catch((err) => {\n          this.$message.error('保存失败');\n        });\n    },\n    getLink(index) {\n      this.$refs.linkaddres.modals = true;\n    },\n    linkUrl(e) {\n      this.formItem.code_url = e;\n      let url = this.BaseURL + e;\n      this.drawCode(url);\n    },\n    drawCode(url) {\n      let qrcode = '';\n      let obj = document.getElementById('qrcode');\n      obj.innerHTML = '';\n      qrcode = new QRCode(obj, {\n        text: url, // 需要转换为二维码的内容\n        width: 128,\n        height: 128,\n        colorDark: '#000000',\n        colorLight: '#ffffff',\n        correctLevel: QRCode.CorrectLevel.H,\n      });\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n::v-deep .ivu-checkbox-wrapper {\n  font-size: 12px;\n  margin-right: 30px;\n}\n::v-deep .el-checkbox__input {\n  margin-right: 6px;\n}\n::v-deep .el-checkbox__input {\n  width: 14px;\n  height: 14px;\n  font-size: 12px;\n}\n.warpper {\n  max-width: 1200px;\n}\n.fixed-card {\n  position: fixed;\n  right: 0;\n  bottom: 0;\n  left: 265px;\n  z-index: 45;\n  box-shadow: 0 -1px 2px rgb(240, 240, 240);\n}\n.link {\n  background: #f6f7f9;\n  border-radius: 2px;\n  padding: 15px;\n}\n.select-link {\n  font-size: 12px;\n}\n.change {\n  color: #2d8cf0;\n  cursor: pointer;\n}\n.ticket-content::-webkit-scrollbar {\n  display: none;\n}\n.ticket-preview {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n.out-line {\n  width: 271px;\n  height: 7px;\n  background: #eeeeee;\n  border-radius: 4px;\n}\n\n@-webkit-keyframes show {\n  0% {\n    margin-top: -70vh;\n  }\n  100% {\n    margin-top: 0;\n  }\n}\n\n@-moz-keyframes show {\n  0% {\n    margin-top: -70vh;\n  }\n  100% {\n    margin-top: 0;\n  }\n}\n\n@-ms-keyframes show {\n  0% {\n    margin-top: -70vh;\n  }\n  100% {\n    margin-top: 0;\n  }\n}\n\n@-o-keyframes show {\n  0% {\n    margin-top: -70vh;\n  }\n  100% {\n    margin-top: 0;\n  }\n}\n\n@keyframes show {\n  0% {\n    margin-top: -70vh;\n  }\n  100% {\n    margin-top: 0;\n  }\n}\n.ticket-preview {\n  overflow: hidden;\n  height: 70vh;\n}\n.ticket-content {\n  position: relative;\n  top: -3px;\n  animation: show 2s ease-in-out forwards;\n  width: 260px;\n  max-height: 70vh;\n  overflow-y: scroll;\n  overflow-x: hidden;\n  background-color: #fff;\n  padding: 20px 15px 15px 15px;\n  box-shadow: 0px 4px 10px 0px rgba(0, 0, 0, 0.1);\n  border-radius: 1px 1px 1px 1px;\n  font-size: 12px;\n  font-weight: 400;\n  color: #333;\n  line-height: 18px;\n  .form-box {\n    display: flex;\n    .label {\n      white-space: nowrap;\n    }\n  }\n  .ticket-header {\n    font-weight: 500;\n    font-size: 18px;\n    text-align: center;\n    margin-bottom: 20px;\n  }\n  .btn-line {\n    border-bottom: 1px dashed #eee;\n    padding: 10px 0;\n    word-break: break-all;\n  }\n  .fw-500 {\n    font-weight: 500;\n  }\n  .code {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n\n    text-align: center;\n    #qrcode {\n      margin: 25px 0 0px;\n    }\n  }\n}\n.bottom-notice {\n  width: 260px;\n  margin-left: 1px;\n  height: 13px;\n  position: relative;\n}\n.image {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: -6px;\n}\n.xing {\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  overflow: hidden;\n  white-space: nowrap;\n}\n</style>\n"]}]}