{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\notify\\smsConfig\\elecInvoice.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\notify\\smsConfig\\elecInvoice.vue","mtime":1731313973084},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1753254258567},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IGludm9pY2VDYXRlZ29yeSwgc2F2ZUJhc2ljcywgaW52b2ljZUNvbmZpZyB9IGZyb20gJ0AvYXBpL29yZGVyJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICcnLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBydWxlVmFsaWRhdGU6IHt9LAogICAgICBmb3JtSXRlbTogewogICAgICAgIGVsZWNfaW52b2ljZTogMCwKICAgICAgICBhdXRvX2ludm9pY2U6IDAsCiAgICAgICAgZWxlY19pbnZvaWNlX2NhdGU6ICcnLAogICAgICAgIGVsZWNfaW52b2ljZV90YXhfcmF0ZTogbnVsbCwKICAgICAgfSwKICAgICAgb3B0aW9uc0NvbmZpZzogewogICAgICAgIGxhYmVsOiAnbmFtZScsCiAgICAgICAgdmFsdWU6ICdpZCcsCiAgICAgIH0sCiAgICAgIGdyaWQ6IHsKICAgICAgICB4bDogOCwKICAgICAgICBsZzogMTIsCiAgICAgICAgbWQ6IDE4LAogICAgICAgIHNtOiAxNiwKICAgICAgICB4czogMjQsCiAgICAgIH0sCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBvcHRpb25zOiBbXSwKICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRJbnZvaWNlQ29uZmlnKCk7CiAgfSwKICBtb3VudGVkKCkge30sCiAgbWV0aG9kczogewogICAgZ2V0SW52b2ljZUNvbmZpZygpIHsKICAgICAgaW52b2ljZUNvbmZpZygpLnRoZW4oKHJlcykgPT4gewogICAgICAgIHRoaXMuZm9ybUl0ZW0gPSByZXMuZGF0YTsKICAgICAgICB0aGlzLmZvcm1JdGVtLmVsZWNfaW52b2ljZV9jYXRlID0gcmVzLmRhdGEuZWxlY19pbnZvaWNlX2NhdGUgfHwgJyc7CiAgICAgICAgbGV0IHsgZWxlY19pbnZvaWNlX2NhdGUsIGVsZWNfaW52b2ljZV9jYXRlX25hbWUgfSA9IHJlcy5kYXRhOwogICAgICAgIGlmIChlbGVjX2ludm9pY2VfY2F0ZSkgewogICAgICAgICAgdGhpcy5vcHRpb25zID0gW3sgaWQ6IGVsZWNfaW52b2ljZV9jYXRlLCBuYW1lOiBlbGVjX2ludm9pY2VfY2F0ZV9uYW1lIH1dOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgc2VsZWN0Q2hhbmdlKGUpIHsKICAgICAgbGV0IG9iaiA9IHt9OwogICAgICBvYmogPSB0aGlzLm9wdGlvbnMuZmluZCgoaXRlbSkgPT4gewogICAgICAgIHJldHVybiBpdGVtLmlkID09PSBlOwogICAgICB9KTsKICAgICAgdGhpcy5mb3JtSXRlbS5lbGVjX2ludm9pY2VfY2F0ZV9uYW1lID0gb2JqLm5hbWU7CiAgICAgIHRoaXMuZm9ybUl0ZW0uZWxlY19pbnZvaWNlX3RheF9yYXRlID0gb2JqLnRheF9yYXRlX251bTsKICAgIH0sCiAgICBoYW5kbGVTdWJtaXQoZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUoKHZhbGlkKSA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBzYXZlQmFzaWNzKHRoaXMuZm9ybUl0ZW0pLnRoZW4oKCkgPT4gewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+S/neWtmOaIkOWKnycpOwogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnJvciBzdWJtaXQhIScpOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgcmVtb3RlTWV0aG9kKHF1ZXJ5KSB7CiAgICAgIGlmIChxdWVyeSAhPT0gJycpIHsKICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgICAgIGludm9pY2VDYXRlZ29yeSh7IG5hbWU6IHF1ZXJ5IH0pLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICB0aGlzLm9wdGlvbnMgPSByZXMuZGF0YS5saXN0LmZpbHRlcigoaXRlbSkgPT4gewogICAgICAgICAgICByZXR1cm4gaXRlbS5uYW1lLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihxdWVyeS50b0xvd2VyQ2FzZSgpKSA+IC0xOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5vcHRpb25zID0gW107CiAgICAgIH0KICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["elecInvoice.vue"],"names":[],"mappings":";AA6FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"elecInvoice.vue","sourceRoot":"src/pages/notify/smsConfig","sourcesContent":["<template>\n  <div class=\"main\">\n    <div class=\"i-layout-page-header header-title\">\n      <span class=\"ivu-page-header-title\">{{ $route.meta.title }}</span>\n    </div>\n    <el-card :bordered=\"false\" shadow=\"never\">\n      <el-form\n        ref=\"formItem\"\n        :model=\"formItem\"\n        label-width=\"110px\"\n        label-position=\"right\"\n        :rules=\"ruleValidate\"\n        @submit.native.prevent\n      >\n        <el-row :gutter=\"24\">\n          <el-col :span=\"24\">\n            <el-col v-bind=\"grid\">\n              <el-form-item label=\"电子发票状态：\" prop=\"name\" label-for=\"name\">\n                <el-radio-group v-model=\"formItem.elec_invoice\">\n                  <el-radio :label=\"1\">开启</el-radio>\n                  <el-radio :label=\"0\">关闭</el-radio>\n                </el-radio-group>\n                <div class=\"tips-info\">是否开启电子发票</div>\n              </el-form-item>\n            </el-col>\n          </el-col>\n          <template v-if=\"formItem.elec_invoice === 1\">\n            <el-col :span=\"24\">\n              <el-col v-bind=\"grid\">\n                <el-form-item label=\"是否自动开票：\" prop=\"name\" label-for=\"name\">\n                  <div>\n                    <el-radio-group v-model=\"formItem.auto_invoice\">\n                      <el-radio :label=\"1\">开启</el-radio>\n                      <el-radio :label=\"0\">关闭</el-radio>\n                    </el-radio-group>\n                    <div class=\"tips-info\">是否开启自动开票功能</div>\n                  </div>\n                </el-form-item>\n              </el-col>\n            </el-col>\n            <template v-if=\"formItem.auto_invoice === 1 && formItem.elec_invoice === 1\">\n              <el-col :span=\"24\">\n                <el-col v-bind=\"grid\">\n                  <el-form-item label=\"电子发票分类：\">\n                    <el-select\n                      class=\"input-width\"\n                      v-model=\"formItem.elec_invoice_cate\"\n                      filterable\n                      remote\n                      reserve-keyword\n                      :remote-method=\"remoteMethod\"\n                      :loading=\"loading\"\n                      placeholder=\"请输入并选择电子发票的商品分类\"\n                      @change=\"selectChange\"\n                    >\n                      <el-option v-for=\"item in options\" :key=\"item.id\" :label=\"item.name\" :value=\"item.id\">\n                      </el-option>\n                    </el-select>\n                    <div class=\"tips-info\">电子发票需输入搜索并选择商品分类，如：电子产品、电子服务等</div>\n                  </el-form-item>\n                </el-col>\n              </el-col>\n              <el-col :span=\"24\">\n                <el-col v-bind=\"grid\">\n                  <el-form-item label=\"电子发票税率：\">\n                    <el-input\n                      type=\"number\"\n                      class=\"input-width\"\n                      v-model=\"formItem.elec_invoice_tax_rate\"\n                      placeholder=\"请输入电子发票税率\"\n                    />\n                    <div class=\"tips-info\">\n                      默认填充税率可能存在误差，请确认无误后再保存电子发票的税率，填写0-100直接的整数，如：13%的税率请填写13\n                    </div>\n                  </el-form-item>\n                </el-col>\n              </el-col>\n            </template>\n          </template>\n          <el-col :span=\"24\">\n            <el-col v-bind=\"grid\">\n              <el-form-item>\n                <el-button type=\"primary\" long v-db-click @click=\"handleSubmit('formItem')\">保存</el-button>\n              </el-form-item>\n            </el-col>\n          </el-col>\n        </el-row>\n      </el-form>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { invoiceCategory, saveBasics, invoiceConfig } from '@/api/order';\nexport default {\n  name: '',\n  data() {\n    return {\n      ruleValidate: {},\n      formItem: {\n        elec_invoice: 0,\n        auto_invoice: 0,\n        elec_invoice_cate: '',\n        elec_invoice_tax_rate: null,\n      },\n      optionsConfig: {\n        label: 'name',\n        value: 'id',\n      },\n      grid: {\n        xl: 8,\n        lg: 12,\n        md: 18,\n        sm: 16,\n        xs: 24,\n      },\n      loading: false,\n      options: [],\n    };\n  },\n  created() {\n    this.getInvoiceConfig();\n  },\n  mounted() {},\n  methods: {\n    getInvoiceConfig() {\n      invoiceConfig().then((res) => {\n        this.formItem = res.data;\n        this.formItem.elec_invoice_cate = res.data.elec_invoice_cate || '';\n        let { elec_invoice_cate, elec_invoice_cate_name } = res.data;\n        if (elec_invoice_cate) {\n          this.options = [{ id: elec_invoice_cate, name: elec_invoice_cate_name }];\n        }\n      });\n    },\n    selectChange(e) {\n      let obj = {};\n      obj = this.options.find((item) => {\n        return item.id === e;\n      });\n      this.formItem.elec_invoice_cate_name = obj.name;\n      this.formItem.elec_invoice_tax_rate = obj.tax_rate_num;\n    },\n    handleSubmit(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          saveBasics(this.formItem).then(() => {\n            this.$message.success('保存成功');\n          });\n        } else {\n          console.log('error submit!!');\n          return false;\n        }\n      });\n    },\n    remoteMethod(query) {\n      if (query !== '') {\n        this.loading = true;\n        invoiceCategory({ name: query }).then((res) => {\n          this.loading = false;\n          this.options = res.data.list.filter((item) => {\n            return item.name.toLowerCase().indexOf(query.toLowerCase()) > -1;\n          });\n        });\n      } else {\n        this.options = [];\n      }\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n.input-width {\n  width: 100%;\n}\n</style>\n"]}]}