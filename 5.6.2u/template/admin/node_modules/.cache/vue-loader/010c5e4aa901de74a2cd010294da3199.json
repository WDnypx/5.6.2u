{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\product\\productAdd\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\product\\productAdd\\index.vue","mtime":1751246651273},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1753254256661},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1753254258567},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB1c2VyTGFiZWwgZnJvbSAnQC9jb21wb25lbnRzL2xhYmVsTGlzdCc7CmltcG9ydCB1c2VMYWJlbCBmcm9tICdAL2NvbXBvbmVudHMvZ29vZHNMYWJlbC91c2VMYWJlbCc7CmltcG9ydCBnb29kc0xhYmVsIGZyb20gJ0AvY29tcG9uZW50cy9nb29kc0xhYmVsJzsKaW1wb3J0IHsgbWFwU3RhdGUgfSBmcm9tICd2dWV4JzsKaW1wb3J0IHVwbG9hZFBpY3R1cmVzIGZyb20gJ0AvY29tcG9uZW50cy91cGxvYWRQaWN0dXJlcyc7CmltcG9ydCBmcmVpZ2h0VGVtcGxhdGUgZnJvbSAnQC9jb21wb25lbnRzL2ZyZWlnaHRUZW1wbGF0ZSc7CmltcG9ydCBjb3Vwb25MaXN0IGZyb20gJ0AvY29tcG9uZW50cy9jb3Vwb25MaXN0JzsKaW1wb3J0IGFkZEF0dHIgZnJvbSAnLi4vcHJvZHVjdEF0dHIvYWRkQXR0cic7CmltcG9ydCBnb29kc0xpc3QgZnJvbSAnQC9jb21wb25lbnRzL2dvb2RzTGlzdC9pbmRleCc7CmltcG9ydCB0YW9CYW8gZnJvbSAnLi90YW9CYW8nOwppbXBvcnQgeyB1c2VyTGFiZWxBZGRBcGkgfSBmcm9tICdAL2FwaS91c2VyJzsKaW1wb3J0IHsKICBwcm9kdWN0SW5mb0FwaSwKICBjYXNjYWRlckxpc3RBcGksCiAgcHJvZHVjdEFkZEFwaSwKICBnZW5lcmF0ZUF0dHJBcGksCiAgcHJvZHVjdEdldFJ1bGVBcGksCiAgcHJvZHVjdEdldFRlbXBsYXRlQXBpLAogIHByb2R1Y3RHZXRUZW1wS2V5c0FwaSwKICBjaGVja0FjdGl2aXR5QXBpLAogIHByb2R1Y3RDYWNoZSwKICBjYWNoZURlbGV0ZSwKICB1cGxvYWRUeXBlLAogIGltcG9ydENhcmQsCiAgcHJvZHVjdENyZWF0ZUFwaSwKICBnZXRQcm9kdWN0VHlwZUNvbmZpZywKICBydWxlQWRkQXBpLAogIHBhcmFtTGlzdEFwaSwKICBwYXJhbUluZm9BcGksCiAgcHJvZHVjdFByb3RlY3Rpb25MaXN0QXBpLAogIHByb2R1Y3RMYWJlbFVzZUxpc3RBcGksCn0gZnJvbSAnQC9hcGkvcHJvZHVjdCc7CmltcG9ydCBTZXR0aW5nIGZyb20gJ0Avc2V0dGluZyc7CmltcG9ydCB7IGdldENvb2tpZXMgfSBmcm9tICdAL2xpYnMvdXRpbCc7CmltcG9ydCB7IHVwbG9hZEJ5UGllY2VzIH0gZnJvbSAnQC91dGlscy91cGxvYWQnOyAvL+W8leWFpXVwbG9hZEJ5UGllY2Vz5pa55rOVCmltcG9ydCB7IGlzRmlsZVVwbG9hZCwgaXNWaWRlb1VwbG9hZCwgYXJyYXlzRXF1YWwgfSBmcm9tICdAL3V0aWxzJzsKaW1wb3J0IGNoZWNrQXJyYXkgZnJvbSAnQC9saWJzL3Blcm1pc3Npb24nOwppbXBvcnQgewogIEdvb2RzVGFibGVIZWFkLAogIFZpcnR1YWxUYWJsZUhlYWQsCiAgVmlydHVhbFRhYmxlSGVhZDIsCiAgY29sdW1uczIsCiAgY29sdW1uczMsCiAgQ3VzdG9tTGlzdCwKICBSdWxlVmFsaWRhdGUsCn0gZnJvbSAnLi9kZWZhdWx0RGF0YS5qcyc7CmltcG9ydCBCYXNpY0luZm8gZnJvbSAnLi9jb21wb25lbnRzL0Jhc2ljSW5mby52dWUnOwppbXBvcnQgU3BlY1N0b2NrIGZyb20gJy4vY29tcG9uZW50cy9TcGVjU3RvY2sudnVlJzsKaW1wb3J0IFByb2R1Y3REZXRhaWwgZnJvbSAnLi9jb21wb25lbnRzL1Byb2R1Y3REZXRhaWwudnVlJzsKaW1wb3J0IExvZ2lzdGljc1NldHRpbmcgZnJvbSAnLi9jb21wb25lbnRzL0xvZ2lzdGljc1NldHRpbmcudnVlJzsKaW1wb3J0IFByaWNlQ29tbWlzc2lvbiBmcm9tICcuL2NvbXBvbmVudHMvUHJpY2VDb21taXNzaW9uLnZ1ZSc7CmltcG9ydCBNYXJrZXRpbmdTZXR0aW5nIGZyb20gJy4vY29tcG9uZW50cy9NYXJrZXRpbmdTZXR0aW5nLnZ1ZSc7CmltcG9ydCBPdGhlclNldHRpbmcgZnJvbSAnLi9jb21wb25lbnRzL090aGVyU2V0dGluZy52dWUnOwppbXBvcnQgeyBmb3JtYXRSaWNoVGV4dCB9IGZyb20gJ0AvdXRpbHMvZWRpdG9ySW1nJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnUHJvZHVjdEFkZCcsCiAgY29tcG9uZW50czogewogICAgdXBsb2FkUGljdHVyZXMsCiAgICBmcmVpZ2h0VGVtcGxhdGUsCiAgICBhZGRBdHRyLAogICAgY291cG9uTGlzdCwKICAgIHRhb0JhbywKICAgIGdvb2RzTGlzdCwKICAgIHVzZXJMYWJlbCwKICAgIGdvb2RzTGFiZWwsCiAgICB1c2VMYWJlbCwKICAgIEJhc2ljSW5mbywKICAgIFNwZWNTdG9jaywKICAgIFByb2R1Y3REZXRhaWwsCiAgICBMb2dpc3RpY3NTZXR0aW5nLAogICAgUHJpY2VDb21taXNzaW9uLAogICAgTWFya2V0aW5nU2V0dGluZywKICAgIE90aGVyU2V0dGluZywKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsYWJlbFNob3c6IGZhbHNlLAogICAgICB0YWdTaG93OiBmYWxzZSwKICAgICAgZGF0YUxhYmVsOiBbXSwKICAgICAgaGVhZFRhYjogWwogICAgICAgIHsgdGl0OiAn5Z+656GA5L+h5oGvJywgbmFtZTogJzEnIH0sCiAgICAgICAgeyB0aXQ6ICfop4TmoLzlupPlrZgnLCBuYW1lOiAnMicgfSwKICAgICAgICB7IHRpdDogJ+WVhuWTgeivpuaDhScsIG5hbWU6ICczJyB9LAogICAgICAgIHsgdGl0OiAn54mp5rWB6K6+572uJywgbmFtZTogJzQnIH0sCiAgICAgICAgeyB0aXQ6ICfkvJrlkZjku7cv5L2j6YeRJywgbmFtZTogJzUnIH0sCiAgICAgICAgeyB0aXQ6ICfokKXplIDorr7nva4nLCBuYW1lOiAnNicgfSwKICAgICAgICB7IHRpdDogJ+WFtuS7luiuvue9ricsIG5hbWU6ICc3JyB9LAogICAgICBdLAogICAgICB2aXJ0dWFsOiBbCiAgICAgICAgeyB0aXQ6ICfmma7pgJrllYblk4EnLCBpZDogMCwgdGl0MjogJ+eJqea1geWPkei0pycgfSwKICAgICAgICB7IHRpdDogJ+WNoeWvhi/nvZHnm5gnLCBpZDogMSwgdGl0MjogJ+iHquWKqOWPkei0pycgfSwKICAgICAgICB7IHRpdDogJ+S8mOaDoOWIuCcsIGlkOiAyLCB0aXQyOiAn6Ieq5Yqo5Y+R6LSnJyB9LAogICAgICAgIHsgdGl0OiAn6Jma5ouf5ZWG5ZOBJywgaWQ6IDMsIHRpdDI6ICfomZrmi5/lj5HotKcnIH0sCiAgICAgIF0sCiAgICAgIHNlbGV0VmlkZW86IDAsIC8v6YCJ5oup6KeG6aKR57G75Z6LCiAgICAgIGN1c3RvbUJ0bjogMCwgLy/oh6rlrprkuYnnlZnoqIDlvIDlhbMKICAgICAgY29udGVudDogJycsCiAgICAgIGNvbnRlbnRzOiAnJywKICAgICAgZmlsZVVybDogU2V0dGluZy5hcGlCYXNlVVJMICsgJy9maWxlL3VwbG9hZCcsCiAgICAgIGZpbGVVcmwyOiBTZXR0aW5nLmFwaUJhc2VVUkwgKyAnL2ZpbGUvdmlkZW9fdXBsb2FkJywKICAgICAgY2FyZFVybDogU2V0dGluZy5hcGlCYXNlVVJMICsgJy9maWxlL3VwbG9hZC8xJywKICAgICAgdXBsb2FkX3R5cGU6ICcnLCAvL+inhumikeS4iuS8oOexu+WeiyAxIOacrOWcsOS4iuS8oCAyIDMgNCBPU1PkuIrkvKAKICAgICAgdXBsb2FkRGF0YToge30sIC8vIOS4iuS8oOWPguaVsAogICAgICBoZWFkZXI6IHt9LAogICAgICB0eXBlOiAwLAogICAgICBtb2RhbHM6IGZhbHNlLAogICAgICBnb29kc19tb2RhbHM6IGZhbHNlLAogICAgICBzcGluU2hvdzogZmFsc2UsCiAgICAgIG9wZW5TdWJpbWl0OiBmYWxzZSwKICAgICAgdmlydHVhbExpc3Q6IFsKICAgICAgICB7CiAgICAgICAgICBrZXk6ICcnLAogICAgICAgICAgdmFsdWU6ICcnLAogICAgICAgIH0sCiAgICAgIF0sCiAgICAgIC8vIOaJuemHj+iuvue9ruihqOagvGRhdGEKICAgICAgb25lRm9ybUJhdGNoOiBbCiAgICAgICAgewogICAgICAgICAgcGljOiAnJywKICAgICAgICAgIHByaWNlOiB2b2lkIDAsCiAgICAgICAgICBjb3N0OiB2b2lkIDAsCiAgICAgICAgICBvdF9wcmljZTogdm9pZCAwLAogICAgICAgICAgc3RvY2s6IHZvaWQgMCwKICAgICAgICAgIGJhcl9jb2RlOiAnJywKICAgICAgICAgIGJhcl9jb2RlX251bWJlcjogJycsCiAgICAgICAgICB3ZWlnaHQ6IHZvaWQgMCwKICAgICAgICAgIHZvbHVtZTogdm9pZCAwLAogICAgICAgICAgdmlydHVhbF9saXN0OiBbXSwKICAgICAgICB9LAogICAgICBdLAoKICAgICAgLy8g6KeE5qC85pWw5o2uCiAgICAgIGZvcm1EeW5hbWljOiB7CiAgICAgICAgYXR0cnNOYW1lOiAnJywKICAgICAgICBhdHRyc1ZhbDogJycsCiAgICAgIH0sCiAgICAgIGRpc2tfdHlwZTogMSwgLy/ljaHlr4bnsbvlnosKICAgICAgdGFiSW5kZXg6IDAsCiAgICAgIHRhYk5hbWU6ICcnLAogICAgICBmb3JtRHluYW1pY05hbWVEYXRhOiBbXSwKICAgICAgaXNCdG46IGZhbHNlLAogICAgICBjb2x1bW5zMjogY29sdW1uczIsCiAgICAgIGNvbHVtbnMzOiBjb2x1bW5zMywKICAgICAgY29sdW1uczogW10sCiAgICAgIGNvbHVtbnNJbnN0YWxsOiBbXSwKICAgICAgY29sdW1uc0luc3RhbDI6IFtdLAogICAgICBncmlkUGljOiB7CiAgICAgICAgeGw6IDYsCiAgICAgICAgbGc6IDgsCiAgICAgICAgbWQ6IDEyLAogICAgICAgIHNtOiAxMiwKICAgICAgICB4czogMTIsCiAgICAgIH0sCiAgICAgIGdyaWRCdG46IHsKICAgICAgICB4bDogNCwKICAgICAgICBsZzogOCwKICAgICAgICBtZDogOCwKICAgICAgICBzbTogOCwKICAgICAgICB4czogOCwKICAgICAgfSwKICAgICAgLy/oh6rlrprkuYnnlZnoqIDkuIvmi4npgInmi6kKICAgICAgQ3VzdG9tTGlzdDogQ3VzdG9tTGlzdCwKICAgICAgLy/oh6rlrprkuYnnlZnoqIDlhoXlrrkKICAgICAgY3VycmVudEluZGV4OiAwLAoKICAgICAgZm9ybVZhbGlkYXRlOiB7CiAgICAgICAgZGlza19pbmZvOiAnJywgLy/ljaHlr4bnsbvlnosKICAgICAgICBsb2dpc3RpY3M6IFsnMSddLCAvL+mAieaLqeeJqea1geaWueW8jwogICAgICAgIGZyZWlnaHQ6IDIsIC8v6L+Q6LS56K6+572uCiAgICAgICAgcG9zdGFnZTogMCwgLy/orr7nva7ov5DotLnph5Hpop0KICAgICAgICByZWNvbW1lbmQ6IFtdLCAvL+WVhuWTgeaOqOiNkAogICAgICAgIHByZXNhbGVfZGF5OiAxLCAvL+mihOWUruWPkei0p+aXtumXtC3nu5PmnZ8KICAgICAgICBwcmVzYWxlOiBmYWxzZSwgLy/pooTllK7llYblk4HlvIDlhbMKICAgICAgICBpc19saW1pdDogZmFsc2UsCiAgICAgICAgbGltaXRfdHlwZTogMCwKICAgICAgICBsaW1pdF9udW06IDAsCiAgICAgICAgdmlwX3Byb2R1Y3Q6IGZhbHNlLCAvL+S7mOi0ueS8muWRmOS4k+WxnuW8gOWFswogICAgICAgIGN1c3RvbV9mb3JtOiBbXSwgLy/oh6rlrprkuYnnlZnoqIAKICAgICAgICBzdG9yZV9uYW1lOiAnJywKICAgICAgICBjYXRlX2lkOiBbXSwKICAgICAgICBsYWJlbF9pZDogW10sCiAgICAgICAga2V5d29yZDogJycsCiAgICAgICAgdW5pdF9uYW1lOiAnJywKICAgICAgICBzdG9yZV9pbmZvOiAnJywKICAgICAgICBpbWFnZTogJycsCiAgICAgICAgcmVjb21tZW5kX2ltYWdlOiAnJywKICAgICAgICBzbGlkZXJfaW1hZ2U6IFtdLAogICAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgICBmaWN0aTogMCwKICAgICAgICBnaXZlX2ludGVncmFsOiAwLAogICAgICAgIHNvcnQ6IDAsCiAgICAgICAgaXNfc2hvdzogMSwKICAgICAgICBpc19naWZ0OiAwLCAvLyDlvIDlkK/pgIHnpLzlk4EKICAgICAgICBnaWZ0X3ByaWNlOiAwLAogICAgICAgIGlzX2hvdDogMCwKICAgICAgICBpc19iZW5lZml0OiAwLAogICAgICAgIGlzX2Jlc3Q6IDAsCiAgICAgICAgaXNfbmV3OiAwLAogICAgICAgIGlzX2dvb2Q6IDAsCiAgICAgICAgaXNfcG9zdGFnZTogMCwKICAgICAgICBpc19zdWI6IFtdLAogICAgICAgIHJlY29tbWVuZF9saXN0OiBbXSwKICAgICAgICBwYXJhbXNfbGlzdDogW10sIC8v5ZWG5ZOB5Y+C5pWwCiAgICAgICAgdmlydHVhbF90eXBlOiAwLAogICAgICAgIC8vIGlzX3N1YjogMCwKICAgICAgICBpZDogMCwKICAgICAgICBzcGVjX3R5cGU6IDAsCiAgICAgICAgaXNfdmlydHVhbDogMCwKICAgICAgICB2aWRlb19saW5rOiAnJywKICAgICAgICAvLyBwb3N0YWdlOiAwLAogICAgICAgIHRlbXBfaWQ6ICcnLAogICAgICAgIGF0dHJzOiBbXSwKICAgICAgICBpdGVtczogWwogICAgICAgICAgewogICAgICAgICAgICBwaWM6ICcnLAogICAgICAgICAgICBwcmljZTogMCwKICAgICAgICAgICAgY29zdDogMCwKICAgICAgICAgICAgb3RfcHJpY2U6IDAsCiAgICAgICAgICAgIHN0b2NrOiAwLAogICAgICAgICAgICBiYXJfY29kZTogJycsCiAgICAgICAgICAgIGJhcl9jb2RlX251bWJlcjogJycsCiAgICAgICAgICB9LAogICAgICAgIF0sCiAgICAgICAgYWN0aXZpdHk6IFsn6buY6K6kJywgJ+enkuadgCcsICfnoI3ku7cnLCAn5ou85ZuiJ10sCiAgICAgICAgY291cG9uTmFtZTogW10sCiAgICAgICAgaGVhZGVyOiBbXSwKICAgICAgICBzZWxlY3RSdWxlOiAnJywKICAgICAgICBjb3Vwb25faWRzOiBbXSwKICAgICAgICBjb21tYW5kX3dvcmQ6ICcnLAogICAgICAgIG1pbl9xdHk6IDEsCiAgICAgICAgbGFiZWxfbGlzdDogW10sCiAgICAgICAgcHJvdGVjdGlvbl9saXN0OiBbXSwKICAgICAgfSwKICAgICAgcnVsZUxpc3Q6IFtdLAogICAgICB0ZW1wbGF0ZUxpc3Q6IFtdLAogICAgICBjcmVhdGVCbnQ6IHRydWUsCiAgICAgIHNob3dJcHV0OiBmYWxzZSwKICAgICAgbWFueUZvcm1WYWxpZGF0ZTogW10sCiAgICAgIC8vIOWNleinhOagvOihqOagvGRhdGEKICAgICAgb25lRm9ybVZhbGlkYXRlOiBbCiAgICAgICAgewogICAgICAgICAgcGljOiAnJywKICAgICAgICAgIHByaWNlOiAwLAogICAgICAgICAgY29zdDogMCwKICAgICAgICAgIG90X3ByaWNlOiAwLAogICAgICAgICAgc3RvY2s6IDAsCiAgICAgICAgICBiYXJfY29kZTogJycsCiAgICAgICAgICBiYXJfY29kZV9udW1iZXI6ICcnLAogICAgICAgICAgd2VpZ2h0OiAwLAogICAgICAgICAgdm9sdW1lOiAwLAogICAgICAgICAgYnJva2VyYWdlOiAwLAogICAgICAgICAgYnJva2VyYWdlX3R3bzogMCwKICAgICAgICAgIHZpcF9wcmljZTogMCwKICAgICAgICAgIHZpcnR1YWxfbGlzdDogW10sCiAgICAgICAgICBjb3Vwb25faWQ6IDAsCiAgICAgICAgfSwKICAgICAgXSwKICAgICAgaW1hZ2VzOiBbXSwKICAgICAgaW1hZ2VzVGFibGU6ICcnLAogICAgICBjdXJyZW50VGFiOiAnMScsCiAgICAgIGlzQ2hvaWNlOiAnJywKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIG1vZGFsUGljOiBmYWxzZSwKICAgICAgYWRkVmlydHVhbE1vZGVsOiBmYWxzZSwKICAgICAgdGVtcGxhdGU6IGZhbHNlLAogICAgICB1cGxvYWRMaXN0OiBbXSwKICAgICAgdHJlZVNlbGVjdDogW10sCiAgICAgIHBpY1RpdDogJycsCiAgICAgIHRhYmxlSW5kZXg6IDAsCiAgICAgIHJ1bGVWYWxpZGF0ZTogUnVsZVZhbGlkYXRlLAogICAgICBtYW55QnJva2VyYWdlOiB1bmRlZmluZWQsCiAgICAgIG1hbnlCcm9rZXJhZ2VUd286IHVuZGVmaW5lZCwKICAgICAgbWFueVZpcFByaWNlOiB1bmRlZmluZWQsCiAgICAgIG1hbnlWaXBEaXNjb3VudDogdW5kZWZpbmVkLAogICAgICB1cGxvYWQ6IHsKICAgICAgICB2aWRlb0luZzogZmFsc2UsIC8vIOaYr+WQpuaYvuekuui/m+W6puadoe+8mwogICAgICB9LAogICAgICB2aWRlb0luZzogZmFsc2UsIC8vIOaYr+WQpuaYvuekuui/m+W6puadoe+8mwogICAgICBwcm9ncmVzczogMCwgLy8g6L+b5bqm5p2h6buY6K6kMAogICAgICBzdG9jazogMCwKICAgICAgZGlza19pbmZvOiAnJywKICAgICAgdmlkZW9MaW5rOiAnJywKICAgICAgYXR0cnM6IFtdLAogICAgICBhY3Rpdml0eTogeyDpu5jorqQ6ICdyZWQnLCDnp5LmnYA6ICdibHVlJywg56CN5Lu3OiAnZ3JlZW4nLCDmi7zlm6I6ICd5ZWxsb3cnIH0sCiAgICAgIGNvdXBvbk5hbWU6IFtdLAogICAgICB1cGRhdGVJZHM6IFtdLAogICAgICB1cGRhdGVOYW1lOiBbXSwKICAgICAgY291cG9uSWRzOiAnJywKICAgICAgY291cG9uTmFtZXM6IFtdLAogICAgICByYWtlQmFjazogWwogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiAn5LiA57qn6L+U5L2jKOWFgyknLAogICAgICAgICAgc2xvdDogJ2Jyb2tlcmFnZScsCiAgICAgICAgICBhbGlnbjogJ2NlbnRlcicsCiAgICAgICAgICB3aWR0aDogOTUsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogJ+S6jOe6p+i/lOS9oyjlhYMpJywKICAgICAgICAgIHNsb3Q6ICdicm9rZXJhZ2VfdHdvJywKICAgICAgICAgIGFsaWduOiAnY2VudGVyJywKICAgICAgICAgIHdpZHRoOiA5NSwKICAgICAgICB9LAogICAgICBdLAogICAgICBtZW1iZXI6IFsKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogJ+S8muWRmOS7tycsCiAgICAgICAgICBzbG90OiAndmlwX3ByaWNlJywKICAgICAgICAgIGFsaWduOiAnY2VudGVyJywKICAgICAgICAgIHdpZHRoOiA5NSwKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiAn5Lya5ZGY5oqY5omjJywKICAgICAgICAgIHNsb3Q6ICd2aXBfcHJvcG9ydGlvbicsCiAgICAgICAgICBhbGlnbjogJ2NlbnRlcicsCiAgICAgICAgICB3aWR0aDogOTUsCiAgICAgICAgfSwKICAgICAgXSwKICAgICAgY29sdW1uc0luc3RhbE06IFtdLAogICAgICBtb3ZlSW5kZXg6ICcnLAogICAgICBhZGRWYWx1ZTogJycsCiAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICB0eXBlQ29uZmlnOiBbXSwKICAgICAgZ29vZHNUeXBlOiBbXSwKICAgICAgcGFyYW1zVHlwZUxpc3Q6IFtdLAogICAgICBwYXJhbXNUeXBlOiBudWxsLAogICAgICBjYW5TZWw6IHRydWUsIC8vIOinhOagvOWbvueJh+a3u+WKoOWIpOaWrQogICAgICBjaGFuZ2VBdHRyVmFsdWU6ICcnLCAvL+S/ruaUueeahOinhOagvOWAvAogICAgICB0YWJsZUtleTogMCwKICAgICAgcHJvdGVjdGlvbkxpc3Q6IFtdLCAvLyDmnI3liqHkv53pmpwKICAgICAgbGFiZWxMaXN0OiBbXSwKICAgICAgdGlsZUxhYmVsTGlzdDogW10sCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcFN0YXRlKCdtZWRpYScsIFsnaXNNb2JpbGUnXSksCiAgICBsYWJlbFdpZHRoKCkgewogICAgICByZXR1cm4gdGhpcy5pc01vYmlsZSA/IHVuZGVmaW5lZCA6ICcxMjBweCc7CiAgICB9LAogICAgbGFiZWxQb3NpdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuaXNNb2JpbGUgPyAndG9wJyA6ICdyaWdodCc7CiAgICB9LAogICAgbGFiZWxCb3R0b20oKSB7CiAgICAgIHJldHVybiB0aGlzLmlzTW9iaWxlID8gdW5kZWZpbmVkIDogJzE1cHgnOwogICAgfSwKICB9LAogIHdhdGNoOiB7CiAgICB0eXBlQ29uZmlnKHZhbCkgewogICAgICBpZiAodmFsLmxlbmd0aCkgewogICAgICAgIC8vIOWvuXZpcnR1YWzkuK3nmoRpZOetieS6jnZhbOS4reeahGlk55qECiAgICAgICAgdGhpcy5nb29kc1R5cGUgPSB0aGlzLnZpcnR1YWwuZmlsdGVyKChpdGVtKSA9PiB7CiAgICAgICAgICByZXR1cm4gdmFsLmluY2x1ZGVzKGl0ZW0uaWQgKyAnJyk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5nb29kc1R5cGUgPSB0aGlzLnZpcnR1YWw7CiAgICAgIH0KICAgIH0sCiAgfSwKICBiZWZvcmVSb3V0ZVVwZGF0ZSh0bywgZnJvbSwgbmV4dCkgewogICAgdGhpcy5idXMuJGVtaXQoJ29uVGFnc1ZpZXdSZWZyZXNoUm91dGVyVmlldycsIHRoaXMuJHJvdXRlLnBhdGgpOwogICAgbmV4dCgpOwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuY29sdW1ucyA9IHRoaXMuY29sdW1uczIuc2xpY2UoMCwgOCk7CiAgICB0aGlzLmdldFRva2VuKCk7CiAgfSwKICBhc3luYyBtb3VudGVkKCkgewogICAgaWYgKHRoaXMuJHJvdXRlLnBhcmFtcy5pZCAhPT0gJzAnICYmIHRoaXMuJHJvdXRlLnBhcmFtcy5pZCkgewogICAgICBhd2FpdCB0aGlzLmdldEluZm8oKTsKICAgIH0gZWxzZSBpZiAodGhpcy4kcm91dGUucGFyYW1zLmlkID09PSAnMCcpIHsKICAgICAgdGhpcy5nZXRQcm9kdWN0Q2FjaGUoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZ2V0cHJvZHVjdExhYmVsVXNlTGlzdEFwaSgpOwogICAgfQogICAgaWYgKHRoaXMuJHJvdXRlLnF1ZXJ5LnR5cGUpIHsKICAgICAgdGhpcy5tb2RhbHMgPSB0cnVlOwogICAgICB0aGlzLnR5cGUgPSB0aGlzLiRyb3V0ZS5xdWVyeS50eXBlOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy50eXBlID0gMDsKICAgIH0KICAgIHRoaXMuZ29vZHNDYXRlZ29yeSgpOwogICAgdGhpcy5wcm9kdWN0R2V0UnVsZSgpOwogICAgdGhpcy5wcm9kdWN0R2V0VGVtcGxhdGUoKTsKICAgIHRoaXMucGFyYW1zR2V0VGVtcGxhdGUoKTsKICAgIHRoaXMudXBsb2FkVHlwZSgpOwogICAgdGhpcy5wcm9kdWN0Q29uZmlnKCk7CiAgICB0aGlzLndhdGNoQWN0aXZpdHkoKTsKICAgIHRoaXMuZ2V0UHJvdGVjdGlvbkxpc3QoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldFByb2R1Y3RDYWNoZSgpIHsKICAgICAgcHJvZHVjdENhY2hlKCkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBsZXQgZGF0YSA9IHJlcy5kYXRhLmluZm87CiAgICAgICAgICB0aGlzLmdldHByb2R1Y3RMYWJlbFVzZUxpc3RBcGkoKTsKCiAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZGF0YSkpIHsKICAgICAgICAgICAgbGV0IGNhdGVfaWQgPSBkYXRhLmNhdGVfaWQubWFwKE51bWJlcik7CiAgICAgICAgICAgIGxldCBsYWJlbF9pZCA9IGRhdGEubGFiZWxfaWQubWFwKE51bWJlcik7CiAgICAgICAgICAgIHRoaXMuYXR0cnMgPSBkYXRhLml0ZW1zIHx8IFtdOwogICAgICAgICAgICBsZXQgaWRzID0gW107CiAgICAgICAgICAgIGlmIChkYXRhLmNvdXBvbnMpIHsKICAgICAgICAgICAgICBkYXRhLmNvdXBvbnMubWFwKChpdGVtKSA9PiB7CiAgICAgICAgICAgICAgICBpZHMucHVzaChpdGVtLmlkKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB0aGlzLmNvdXBvbk5hbWUgPSBkYXRhLmNvdXBvbnM7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlID0gZGF0YTsKICAgICAgICAgICAgdGhpcy5kYXRhTGFiZWwgPSBkYXRhLmxhYmVsX2lkOwogICAgICAgICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5jb3Vwb25faWRzID0gaWRzOwogICAgICAgICAgICB0aGlzLnVwZGF0ZUlkcyA9IGlkczsKICAgICAgICAgICAgdGhpcy51cGRhdGVOYW1lID0gZGF0YS5jb3Vwb25zOwogICAgICAgICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5jYXRlX2lkID0gY2F0ZV9pZDsKICAgICAgICAgICAgdGhpcy5vbmVGb3JtVmFsaWRhdGUgPSBkYXRhLmF0dHJzOwogICAgICAgICAgICB0aGlzLmdlbmVyYXRlSGVhZGVyKHRoaXMuYXR0cnMpOwogICAgICAgICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5sb2dpc3RpY3MgPSBkYXRhLmxvZ2lzdGljcyB8fCBbJzEnXTsKICAgICAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGUuaGVhZGVyID0gW107CiAgICAgICAgICAgIHRoaXMubWFueUZvcm1WYWxpZGF0ZSA9IGRhdGEuYXR0cnM7CiAgICAgICAgICAgIHRoaXMuc3BlY190eXBlID0gZGF0YS5zcGVjX3R5cGU7CiAgICAgICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmlzX3ZpcnR1YWwgPSBkYXRhLmlzX3ZpcnR1YWw7CiAgICAgICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmN1c3RvbV9mb3JtID0gZGF0YS5jdXN0b21fZm9ybSB8fCBbXTsKICAgICAgICAgICAgaWYgKHRoaXMuZm9ybVZhbGlkYXRlLmN1c3RvbV9mb3JtLmxlbmd0aCAhPSAwKSB7CiAgICAgICAgICAgICAgdGhpcy5jdXN0b21CdG4gPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuYXR0cnMubWFwKChpdGVtKSA9PiB7CiAgICAgICAgICAgICAgaWYgKGl0ZW0uYWRkX3BpYykgdGhpcy5jYW5TZWwgPSBmYWxzZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMudmlydHVhbGJ0bihkYXRhLnZpcnR1YWxfdHlwZSwgMSk7CiAgICAgICAgICAgIGlmIChkYXRhLnNwZWNfdHlwZSA9PT0gMCkgewogICAgICAgICAgICAgIHRoaXMubWFueUZvcm1WYWxpZGF0ZSA9IFtdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuY3JlYXRlQm50ID0gdHJ1ZTsKICAgICAgICAgICAgICB0aGlzLm9uZUZvcm1WYWxpZGF0ZSA9IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgcGljOiBkYXRhLmltYWdlLAogICAgICAgICAgICAgICAgICBwcmljZTogMCwKICAgICAgICAgICAgICAgICAgY29zdDogMCwKICAgICAgICAgICAgICAgICAgb3RfcHJpY2U6IDAsCiAgICAgICAgICAgICAgICAgIHN0b2NrOiAwLAogICAgICAgICAgICAgICAgICBiYXJfY29kZTogJycsCiAgICAgICAgICAgICAgICAgIGJhcl9jb2RlX251bWJlcjogJycsCiAgICAgICAgICAgICAgICAgIHdlaWdodDogMCwKICAgICAgICAgICAgICAgICAgdm9sdW1lOiAwLAogICAgICAgICAgICAgICAgICBicm9rZXJhZ2U6IDAsCiAgICAgICAgICAgICAgICAgIGJyb2tlcmFnZV90d286IDAsCiAgICAgICAgICAgICAgICAgIHZpcF9wcmljZTogMCwKICAgICAgICAgICAgICAgICAgdmlydHVhbF9saXN0OiBbXSwKICAgICAgICAgICAgICAgICAgY291cG9uX2lkOiAwLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMud2F0Y2hBY3Rpdml0eSgpOwogICAgICAgICAgICB0aGlzLnNwaW5TaG93ID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycikgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihlcnIubXNnKTsKICAgICAgICB9KTsKICAgIH0sCiAgICBnZXRQcm90ZWN0aW9uTGlzdCgpIHsKICAgICAgcHJvZHVjdFByb3RlY3Rpb25MaXN0QXBpKHsgcGFnZTogMCwgbGltaXQ6IDAsIHN0YXR1czogMSB9KS50aGVuKChyZXMpID0+IHsKICAgICAgICB0aGlzLnByb3RlY3Rpb25MaXN0ID0gcmVzLmRhdGEubGlzdDsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0cHJvZHVjdExhYmVsVXNlTGlzdEFwaSgpIHsKICAgICAgcHJvZHVjdExhYmVsVXNlTGlzdEFwaSgpLnRoZW4oKHJlcykgPT4gewogICAgICAgIC8vIOWQiOW5tuaVsOe7hOS4reaJgOacieeahGxpc3QKICAgICAgICB0aGlzLnRpbGVMYWJlbExpc3QgPSByZXMuZGF0YS5mbGF0TWFwKChpdGVtKSA9PiBpdGVtLmxpc3QpOwogICAgICAgIGxldCBsYWJlbExpc3QgPSByZXMuZGF0YTsKICAgICAgICBpZiAodGhpcy5mb3JtVmFsaWRhdGUubGFiZWxfbGlzdC5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmxhYmVsX2xpc3QubWFwKChlbCkgPT4gewogICAgICAgICAgICBsYWJlbExpc3QubWFwKChyZSkgPT4gewogICAgICAgICAgICAgIHJlLmxpc3QubWFwKChsYWJlbCkgPT4gewogICAgICAgICAgICAgICAgaWYgKGxhYmVsLmlkID09PSBlbCkgewogICAgICAgICAgICAgICAgICBsYWJlbC5hY3RpdmUgPSB0cnVlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgbGFiZWwuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGxhYmVsTGlzdC5tYXAoKGVsKSA9PiB7CiAgICAgICAgICAgIGVsLmxpc3QubWFwKChsYWJlbCkgPT4gewogICAgICAgICAgICAgIGxhYmVsLmFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICB0aGlzLmxhYmVsTGlzdCA9IGxhYmVsTGlzdDsKICAgICAgfSk7CiAgICB9LAogICAgYWRkUHJvdGVjdGlvbigpIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBwYXRoOiB0aGlzLiRyb3V0ZVByb1N0ciArICcvcHJvZHVjdC9wcm90ZWN0aW9uL2xpc3QnIH0pOwogICAgfSwKICAgIHByb2R1Y3RDb25maWcoKSB7CiAgICAgIGdldFByb2R1Y3RUeXBlQ29uZmlnKCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgdGhpcy50eXBlQ29uZmlnID0gcmVzLmRhdGE7CiAgICAgIH0pOwogICAgfSwKICAgIGJlZm9yZVVwbG9hZChmaWxlKSB7CiAgICAgIHJldHVybiBpc0ZpbGVVcGxvYWQoZmlsZSk7CiAgICB9LAogICAgLy8g5YiG54mH5LiK5LygCiAgICB2aWRlb1NhdmVUb1VybChmaWxlKSB7CiAgICAgIGlmIChpc1ZpZGVvVXBsb2FkKGZpbGUpKSB7CiAgICAgICAgdXBsb2FkQnlQaWVjZXMoewogICAgICAgICAgZmlsZTogZmlsZSwgLy8g6KeG6aKR5a6e5L2TCiAgICAgICAgICBwaWVjZVNpemU6IDMsIC8vIOWIhueJh+Wkp+WwjwogICAgICAgICAgc3VjY2VzczogKGRhdGEpID0+IHsKICAgICAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGUudmlkZW9fbGluayA9IGRhdGEuZmlsZV9wYXRoOwogICAgICAgICAgICB0aGlzLnByb2dyZXNzID0gMTAwOwogICAgICAgICAgfSwKICAgICAgICAgIGVycm9yOiAoZSkgPT4gewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKGUubXNnKTsKICAgICAgICAgIH0sCiAgICAgICAgICB1cGxvYWRpbmc6IChjaHVuaywgYWxsQ2h1bmspID0+IHsKICAgICAgICAgICAgdGhpcy52aWRlb0luZyA9IHRydWU7CiAgICAgICAgICAgIGxldCBzdCA9IE1hdGguZmxvb3IoKGNodW5rIC8gYWxsQ2h1bmspICogMTAwKTsKICAgICAgICAgICAgdGhpcy5wcm9ncmVzcyA9IHN0OwogICAgICAgICAgfSwKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgLy8g57G75Z6L6YCJ5oupL+Whq+WFpeWGheWuueWIpOaWrQogICAgdmlydHVhbGJ0bihpbmRleCwgdHlwZSkgewogICAgICBpZiAodHlwZSAhPSAxKSB7CiAgICAgICAgaWYgKHRoaXMuJHJvdXRlLnBhcmFtcy5pZCkgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+e8lui+keWVhuWTgeS4jeaUr+aMgeWIh+aNouWVhuWTgeexu+WeiycpOwogICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmlzX3N1YiA9IFtdOwogICAgICAgIGxldCBpZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZDsKICAgICAgICBpZiAoaWQpIHsKICAgICAgICAgIGNoZWNrQWN0aXZpdHlBcGkoaWQpCiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHt9KQogICAgICAgICAgICAuY2F0Y2goKHJlcykgPT4gewogICAgICAgICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLnNwZWNfdHlwZSA9IHRoaXMuc3BlY190eXBlOwogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1zZyk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAodGhpcy5mb3JtVmFsaWRhdGUuc3BlY190eXBlID09IDEpIHsKICAgICAgICAgICAgdGhpcy5nZW5lcmF0ZSgxKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgLy8g5a6a5LmJ5Z+656GA5ZWG5ZOB5ZKM6Jma5ouf5ZWG5ZOB55qE5qCH562+6aG16YWN572uCiAgICAgIGNvbnN0IGJhc2VIZWFkVGFicyA9IFsKICAgICAgICB7IHRpdDogJ+WfuuehgOS/oeaBrycsIG5hbWU6ICcxJyB9LAogICAgICAgIHsgdGl0OiAn6KeE5qC85bqT5a2YJywgbmFtZTogJzInIH0sCiAgICAgICAgeyB0aXQ6ICfllYblk4Hor6bmg4UnLCBuYW1lOiAnMycgfSwKICAgICAgICB7IHRpdDogJ+eJqea1geiuvue9ricsIG5hbWU6ICc0JyB9LAogICAgICAgIHsgdGl0OiAn5Lya5ZGY5Lu3L+S9o+mHkScsIG5hbWU6ICc1JyB9LAogICAgICAgIHsgdGl0OiAn6JCl6ZSA6K6+572uJywgbmFtZTogJzYnIH0sCiAgICAgICAgeyB0aXQ6ICflhbbku5borr7nva4nLCBuYW1lOiAnNycgfSwKICAgICAgXTsKICAgICAgY29uc3QgdmlydHVhbEhlYWRUYWJzID0gWwogICAgICAgIHsgdGl0OiAn5Z+656GA5L+h5oGvJywgbmFtZTogJzEnIH0sCiAgICAgICAgeyB0aXQ6ICfop4TmoLzlupPlrZgnLCBuYW1lOiAnMicgfSwKICAgICAgICB7IHRpdDogJ+WVhuWTgeivpuaDhScsIG5hbWU6ICczJyB9LAogICAgICAgIHsgdGl0OiAn5Lya5ZGY5Lu3L+S9o+mHkScsIG5hbWU6ICc0JyB9LAogICAgICAgIHsgdGl0OiAn6JCl6ZSA6K6+572uJywgbmFtZTogJzUnIH0sCiAgICAgICAgeyB0aXQ6ICflhbbku5borr7nva4nLCBuYW1lOiAnNicgfSwKICAgICAgXTsKCiAgICAgIHN3aXRjaCAoaW5kZXgpIHsKICAgICAgICBjYXNlIDA6IC8vIOaZrumAmuWVhuWTgQogICAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGUudmlydHVhbF90eXBlID0gMDsKICAgICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmlzX3ZpcnR1YWwgPSAwOwogICAgICAgICAgdGhpcy5oZWFkVGFiID0gYmFzZUhlYWRUYWJzOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMTogLy8g5Y2h5a+GL+e9keebmOWVhuWTgQogICAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGUudmlydHVhbF90eXBlID0gMTsKICAgICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLnBvc3RhZ2UgPSAwOwogICAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGUuaXNfdmlydHVhbCA9IDE7CiAgICAgICAgICB0aGlzLmhlYWRUYWIgPSB2aXJ0dWFsSGVhZFRhYnM7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAyOiAvLyDkvJjmg6DliLjllYblk4EKICAgICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLnZpcnR1YWxfdHlwZSA9IDI7CiAgICAgICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5pc192aXJ0dWFsID0gMTsKICAgICAgICAgIHRoaXMuaGVhZFRhYiA9IHZpcnR1YWxIZWFkVGFiczsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDM6IC8vIOiZmuaLn+WVhuWTgQogICAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGUudmlydHVhbF90eXBlID0gMzsKICAgICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmlzX3ZpcnR1YWwgPSAxOwogICAgICAgICAgdGhpcy5oZWFkVGFiID0gdmlydHVhbEhlYWRUYWJzOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0sCiAgICAvLyDmlrDlop7liIbnsbsKICAgIGFkZENhdGUoKSB7CiAgICAgIHRoaXMuJG1vZGFsRm9ybShwcm9kdWN0Q3JlYXRlQXBpKCkpLnRoZW4oKCkgPT4gdGhpcy5nb29kc0NhdGVnb3J5KCkpOwogICAgfSwKICAgIC8vIOeJqea1geaWueW8j+mAieaLqQogICAgbG9naXN0aWNzQnRuKGUpIHsKICAgICAgdGhpcy5mb3JtVmFsaWRhdGUubG9naXN0aWNzID0gZTsKICAgIH0sCiAgICAvLyDmlrDlop7moIfnrb4KICAgIGFkZExhYmVsKCkgewogICAgICB0aGlzLiRtb2RhbEZvcm0odXNlckxhYmVsQWRkQXBpKDApKS50aGVuKCgpID0+IHRoaXMudXNlckxhYmVsKCkpOwogICAgfSwKICAgIC8vIOmAieaLqeagh+etvgogICAgYWRkR29vZHNUYWcoKSB7CiAgICAgIHRoaXMudGFnU2hvdyA9IHRydWU7CiAgICB9LAogICAgLy8g6Ieq5a6a5LmJ55WZ6KiAIOW8gOWQr+WFs+mXrQogICAgY3VzdG9tTWVzc0J0bihlKSB7CiAgICAgIGlmICghZSkgewogICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmN1c3RvbV9mb3JtID0gW107CiAgICAgIH0KICAgICAgdGhpcy5jdXN0b21CdG4gPSBlOwogICAgfSwKICAgIC8vIOiHquWumuS5ieeVmeiogCDmlrDlop7ooajljZUKICAgIGFkZGN1c3RvbSgpIHsKICAgICAgaWYgKHRoaXMuZm9ybVZhbGlkYXRlLmN1c3RvbV9mb3JtLmxlbmd0aCA+IDkpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+acgOWkmua3u+WKoDEw5p2hJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGUuY3VzdG9tX2Zvcm0ucHVzaCh7CiAgICAgICAgICB0aXRsZTogJycsCiAgICAgICAgICBsYWJlbDogJ3RleHQnLAogICAgICAgICAgdmFsdWU6ICcnLAogICAgICAgICAgc3RhdHVzOiBmYWxzZSwKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIC8vIOWIoOmZpAogICAgZGVsY3VzdG9tKGluZGV4KSB7CiAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmN1c3RvbV9mb3JtLnNwbGljZShpbmRleCwgMSk7CiAgICB9LAogICAgLy8g6aKE5ZSu5YW35L2T5pel5pyfCiAgICBvbmNoYW5nZVRpbWUoZSkgewogICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5wcmVzYWxlX3RpbWUgPSBlOwogICAgfSwKICAgIC8vIOWVhuWTgeivpuaDhQogICAgZ2V0RWRpdG9yQ29udGVudChkYXRhKSB7CiAgICAgIHRoaXMuY29udGVudCA9IGRhdGE7CiAgICB9LAogICAgY2FuY2VsKCkgewogICAgICB0aGlzLm1vZGFscyA9IGZhbHNlOwogICAgfSwKICAgIC8vIOS4iuS8oOWktOmDqHRva2VuCiAgICBnZXRUb2tlbigpIHsKICAgICAgdGhpcy5oZWFkZXJbJ0F1dGhvcmktemF0aW9uJ10gPSAnQmVhcmVyICcgKyBnZXRDb29raWVzKCd0b2tlbicpOwogICAgfSwKICAgIC8vIOWvvOWFpeWNoeWvhgogICAgdXBGaWxlKHJlcykgewogICAgICBpbXBvcnRDYXJkKHsgZmlsZTogcmVzLmRhdGEuc3JjIH0pLnRoZW4oKHJlcykgPT4gewogICAgICAgIHRoaXMudmlydHVhbExpc3QgPSB0aGlzLnZpcnR1YWxMaXN0LmNvbmNhdChyZXMuZGF0YSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8v6I635Y+W6KeG6aKR5LiK5Lyg57G75Z6LCiAgICB1cGxvYWRUeXBlKCkgewogICAgICB1cGxvYWRUeXBlKCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgdGhpcy51cGxvYWRfdHlwZSA9IHJlcy5kYXRhLnVwbG9hZF90eXBlOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDliJ3lp4vljJbmlbDmja7lsZXnpLoKICAgIGluZm9EYXRhKGRhdGEsIGlzQ29weSkgewogICAgICBsZXQgY2F0ZV9pZCA9IGRhdGEuY2F0ZV9pZC5tYXAoTnVtYmVyKTsKICAgICAgbGV0IGxhYmVsX2lkID0gZGF0YS5sYWJlbF9pZC5tYXAoTnVtYmVyKTsKICAgICAgdGhpcy5hdHRycyA9IGRhdGEuaXRlbXMgfHwgW107CiAgICAgIGxldCBpZHMgPSBbXTsKICAgICAgZGF0YS5jb3Vwb25zLm1hcCgoaXRlbSkgPT4gewogICAgICAgIGlkcy5wdXNoKGl0ZW0uaWQpOwogICAgICB9KTsKICAgICAgdGhpcy5mb3JtVmFsaWRhdGUgPSBkYXRhOwogICAgICB0aGlzLnNlbGV0VmlkZW8gPSBkYXRhLnNlbGV0VmlkZW87CiAgICAgIHRoaXMuY29udGVudHMgPSBkYXRhLmRlc2NyaXB0aW9uOwogICAgICB0aGlzLmNvdXBvbk5hbWUgPSBkYXRhLmNvdXBvbnM7CiAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmNvdXBvbl9pZHMgPSBpZHM7CiAgICAgIHRoaXMudXBkYXRlSWRzID0gaWRzOwogICAgICB0aGlzLmRhdGFMYWJlbCA9IGRhdGEubGFiZWxfaWQ7CiAgICAgIHRoaXMudXBkYXRlTmFtZSA9IGRhdGEuY291cG9uczsKICAgICAgdGhpcy52aXJ0dWFsYnRuKGRhdGEudmlydHVhbF90eXBlLCAxKTsKICAgICAgdGhpcy5mb3JtVmFsaWRhdGUubG9naXN0aWNzID0gZGF0YS5sb2dpc3RpY3MgfHwgWycxJ107CiAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmN1c3RvbV9mb3JtID0gZGF0YS5jdXN0b21fZm9ybSB8fCBbXTsKICAgICAgaWYgKHRoaXMuZm9ybVZhbGlkYXRlLmN1c3RvbV9mb3JtLmxlbmd0aCAhPSAwKSB7CiAgICAgICAgdGhpcy5jdXN0b21CdG4gPSAxOwogICAgICB9CiAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmNhdGVfaWQgPSBjYXRlX2lkOwogICAgICBpZiAoZGF0YS5hdHRyKSB7CiAgICAgICAgdGhpcy5vbmVGb3JtVmFsaWRhdGUgPSBbZGF0YS5hdHRyXTsKICAgICAgICB0aGlzLm9uZUZvcm1WYWxpZGF0ZVswXS52aXBfcHJvcG9ydGlvbiA9ICgKICAgICAgICAgICh0aGlzLm9uZUZvcm1WYWxpZGF0ZVswXS52aXBfcHJpY2UgLyB0aGlzLm9uZUZvcm1WYWxpZGF0ZVswXS5wcmljZSkgKgogICAgICAgICAgMTAwCiAgICAgICAgKS50b0ZpeGVkKDIpOwogICAgICB9CiAgICAgIHRoaXMuZ2V0cHJvZHVjdExhYmVsVXNlTGlzdEFwaSgpOwoKICAgICAgdGhpcy5mb3JtVmFsaWRhdGUuaGVhZGVyID0gW107CiAgICAgIHRoaXMuc3BlY190eXBlID0gZGF0YS5zcGVjX3R5cGU7CiAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLnNwZWNfdHlwZSA9IHRoaXMuc3BlY190eXBlOwogICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5pc192aXJ0dWFsID0gZGF0YS5pc192aXJ0dWFsOwogICAgICB0aGlzLmF0dHJzLm1hcCgoaXRlbSkgPT4gewogICAgICAgIGlmIChpdGVtLmFkZF9waWMpIHRoaXMuY2FuU2VsID0gZmFsc2U7CiAgICAgIH0pOwogICAgICBpZiAoZGF0YS5zcGVjX3R5cGUgPT09IDApIHsKICAgICAgICB0aGlzLm1hbnlGb3JtVmFsaWRhdGUgPSBbXTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmNyZWF0ZUJudCA9IHRydWU7CiAgICAgICAgdGhpcy5vbmVGb3JtVmFsaWRhdGUgPSBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHBpYzogJycsCiAgICAgICAgICAgIHByaWNlOiAwLAogICAgICAgICAgICBjb3N0OiAwLAogICAgICAgICAgICBvdF9wcmljZTogMCwKICAgICAgICAgICAgc3RvY2s6IDAsCiAgICAgICAgICAgIGJhcl9jb2RlOiAnJywKICAgICAgICAgICAgYmFyX2NvZGVfbnVtYmVyOiAnJywKICAgICAgICAgICAgd2VpZ2h0OiAwLAogICAgICAgICAgICB2b2x1bWU6IDAsCiAgICAgICAgICAgIGJyb2tlcmFnZTogMCwKICAgICAgICAgICAgYnJva2VyYWdlX3R3bzogMCwKICAgICAgICAgICAgdmlwX3ByaWNlOiAwLAogICAgICAgICAgICB2aXJ0dWFsX2xpc3Q6IFtdLAogICAgICAgICAgICBjb3Vwb25faWQ6IDAsCiAgICAgICAgICB9LAogICAgICAgIF07CgogICAgICAgIHRoaXMuZ2VuZXJhdGVIZWFkZXIodGhpcy5hdHRycyk7CiAgICAgICAgdGhpcy5tYW55Rm9ybVZhbGlkYXRlID0gWy4uLnRoaXMub25lRm9ybUJhdGNoLCAuLi5kYXRhLmF0dHJzXTsKICAgICAgfQoKICAgICAgc2V0VGltZW91dCgoZSkgPT4gewogICAgICAgIHRoaXMuY2hlY2tBbGxHcm91cChkYXRhLmlzX3N1Yik7CiAgICAgIH0sIDEwMDApOwogICAgICB0aGlzLndhdGNoQWN0aXZpdHkoKTsKICAgIH0sCiAgICAvL+WFs+mXrea3mOWuneW8ueeql+W5tueUn+aIkOaVsOaNru+8mwogICAgb25DbG9zZShkYXRhKSB7CiAgICAgIHRoaXMubW9kYWxzID0gZmFsc2U7CiAgICAgIHRoaXMuaW5mb0RhdGEoZGF0YSwgMSk7CiAgICB9LAoKICAgIGNoZWNrTW92ZShldnQpIHsKICAgICAgdGhpcy5tb3ZlSW5kZXggPSBldnQuZHJhZ2dlZENvbnRleHQuaW5kZXg7CiAgICB9LAogICAgZW5kKCkgewogICAgICB0aGlzLm1vdmVJbmRleCA9ICcnOwogICAgICB0aGlzLmdlbmVyYXRlKDEpOwogICAgfSwKICAgIC8vIOWNleeLrOiuvue9ruS8muWRmOiuvue9rgogICAgY2hlY2tBbGxHcm91cENoYW5nZShkYXRhKSB7CiAgICAgIHRoaXMuY2hlY2tBbGxHcm91cChkYXRhKTsKICAgIH0sCiAgICBjaGVja0FsbEdyb3VwKGRhdGEpIHsKICAgICAgbGV0IGVuZExlbmd0aCA9IHRoaXMuYXR0cnMubGVuZ3RoICsgMzsKICAgICAgaWYgKHRoaXMuZm9ybVZhbGlkYXRlLnNwZWNfdHlwZSA9PT0gMCkgewogICAgICAgIGlmIChkYXRhLmxlbmd0aCA9PT0gMikgewogICAgICAgICAgdGhpcy5jb2x1bW5zSW5zdGFsbCA9IHRoaXMuY29sdW1uczIuc2xpY2UoMCwgZW5kTGVuZ3RoKS5jb25jYXQodGhpcy5yYWtlQmFjaykuY29uY2F0KHRoaXMubWVtYmVyKTsKICAgICAgICB9IGVsc2UgaWYgKGRhdGEuaW5kZXhPZigwKSA+IC0xKSB7CiAgICAgICAgICB0aGlzLmNvbHVtbnNJbnN0YWxsID0gdGhpcy5jb2x1bW5zMi5zbGljZSgwLCBlbmRMZW5ndGgpLmNvbmNhdCh0aGlzLm1lbWJlcik7CiAgICAgICAgfSBlbHNlIGlmIChkYXRhLmluZGV4T2YoMSkgPiAtMSkgewogICAgICAgICAgdGhpcy5jb2x1bW5zSW5zdGFsbCA9IHRoaXMuY29sdW1uczIuc2xpY2UoMCwgZW5kTGVuZ3RoKS5jb25jYXQodGhpcy5yYWtlQmFjayk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuY29sdW1uc0luc3RhbGwgPSB0aGlzLmNvbHVtbnMyLnNsaWNlKDAsIGVuZExlbmd0aCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChkYXRhLmxlbmd0aCA9PT0gMikgewogICAgICAgICAgdGhpcy5jb2x1bW5zSW5zdGFsMiA9IHRoaXMuY29sdW1uc0luc3RhbE0KICAgICAgICAgICAgLnNsaWNlKDAsIGVuZExlbmd0aCArIDEpCiAgICAgICAgICAgIC5jb25jYXQodGhpcy5yYWtlQmFjaykKICAgICAgICAgICAgLmNvbmNhdCh0aGlzLm1lbWJlcik7CiAgICAgICAgfSBlbHNlIGlmIChkYXRhLmluZGV4T2YoMCkgPiAtMSkgewogICAgICAgICAgdGhpcy5jb2x1bW5zSW5zdGFsMiA9IHRoaXMuY29sdW1uc0luc3RhbE0uc2xpY2UoMCwgZW5kTGVuZ3RoKS5jb25jYXQodGhpcy5tZW1iZXIpOwogICAgICAgIH0gZWxzZSBpZiAoZGF0YS5pbmRleE9mKDEpID4gLTEpIHsKICAgICAgICAgIHRoaXMuY29sdW1uc0luc3RhbDIgPSB0aGlzLmNvbHVtbnNJbnN0YWxNLnNsaWNlKDAsIGVuZExlbmd0aCkuY29uY2F0KHRoaXMucmFrZUJhY2spOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmNvbHVtbnNJbnN0YWwyID0gdGhpcy5jb2x1bW5zSW5zdGFsTS5zbGljZSgwLCBlbmRMZW5ndGgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOa3u+WKoOS8mOaDoOWIuAogICAgYWRkQ291cG9uKCkgewogICAgICB0aGlzLiRyZWZzLmNvdXBvblRlbXBsYXRlcy5pc1RlbXBsYXRlID0gdHJ1ZTsKICAgICAgdGhpcy4kcmVmcy5jb3Vwb25UZW1wbGF0ZXMudGFibGVMaXN0KCk7CiAgICB9LAogICAgLy8g6KeE5qC85Lit5LyY5oOg5Yi45p+l55yLCiAgICBzZWUoZGF0YSwgbmFtZSwgaW5kZXgpIHsKICAgICAgdGhpcy50YWJOYW1lID0gbmFtZTsKICAgICAgdGhpcy50YWJJbmRleCA9IGluZGV4OwoKICAgICAgaWYgKHRoaXMuZm9ybVZhbGlkYXRlLnZpcnR1YWxfdHlwZSA9PT0gMSkgewogICAgICAgIGlmIChkYXRhLmRpc2tfaW5mbyAhPSAnJykgewogICAgICAgICAgdGhpcy5kaXNrX3R5cGUgPSAxOwogICAgICAgICAgdGhpcy5kaXNrX2luZm8gPSBkYXRhLmRpc2tfaW5mbzsKICAgICAgICAgIHRoaXMuc3RvY2sgPSBkYXRhLnN0b2NrOwogICAgICAgIH0gZWxzZSBpZiAoZGF0YS52aXJ0dWFsX2xpc3QubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLmRpc2tfdHlwZSA9IDI7CiAgICAgICAgICB0aGlzLnZpcnR1YWxMaXN0ID0gZGF0YS52aXJ0dWFsX2xpc3Q7CiAgICAgICAgfQogICAgICAgIHRoaXMuYWRkVmlydHVhbE1vZGVsID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRyZWZzLmdvb2RzQ291cG9uLmlzVGVtcGxhdGUgPSB0cnVlOwogICAgICAgIHRoaXMuJHJlZnMuZ29vZHNDb3Vwb24udGFibGVMaXN0KDMpOwogICAgICB9CiAgICB9LAogICAgLy8g5L+u5pS55YiG5L2j5q+U5L6LCiAgICBjaGFuZ2VEaXNjb3VudChpbmRleCwgdHlwZSA9ICdtYW55Rm9ybVZhbGlkYXRlJykgewogICAgICAvLyDmoLnmja7liIbkvaPmr5TkvosgdmlwX3Byb3BvcnRpb24g5L+u5pS55Lya5ZGY5Lu3IOS/neeVmTLkvY3lsI/mlbAKICAgICAgdGhpc1t0eXBlXVtpbmRleF0udmlwX3ByaWNlID0gKHRoaXNbdHlwZV1baW5kZXhdLnByaWNlICogKHRoaXNbdHlwZV1baW5kZXhdLnZpcF9wcm9wb3J0aW9uIC8gMTAwKSkudG9GaXhlZCgyKTsKICAgIH0sCiAgICAvLyDkv67mlLnkvJrlkZjku7cKICAgIGNoYW5nZVZpcFByaWNlKGluZGV4LCB0eXBlID0gJ21hbnlGb3JtVmFsaWRhdGUnKSB7CiAgICAgIC8vIOagueaNruS8muWRmOS7t+iuoeeul+WHuuWIhuS9o+avlOS+iwogICAgICB0aGlzW3R5cGVdW2luZGV4XS52aXBfcHJvcG9ydGlvbiA9ICgodGhpc1t0eXBlXVtpbmRleF0udmlwX3ByaWNlIC8gdGhpc1t0eXBlXVtpbmRleF0ucHJpY2UpICogMTAwKS50b0ZpeGVkKDIpOwogICAgfSwKICAgIC8vIOa3u+WKoOS8mOaDoOWIuAogICAgYWRkR29vZHNDb3Vwb24oaW5kZXgsIG5hbWUpIHsKICAgICAgdGhpcy50YWJJbmRleCA9IGluZGV4OwogICAgICB0aGlzLnRhYk5hbWUgPSBuYW1lOwogICAgICB0aGlzLiRyZWZzLmdvb2RzQ291cG9uLmlzVGVtcGxhdGUgPSB0cnVlOwogICAgICB0aGlzLiRyZWZzLmdvb2RzQ291cG9uLnRhYmxlTGlzdCgzKTsKICAgIH0sCiAgICBhZGRWaXJ0dWFsKGluZGV4LCBuYW1lKSB7CiAgICAgIHRoaXMudGFiSW5kZXggPSBpbmRleDsKICAgICAgdGhpcy50YWJOYW1lID0gbmFtZTsKICAgICAgdGhpcy5hZGRWaXJ0dWFsTW9kZWwgPSB0cnVlOwogICAgfSwKICAgIC8vIOaPkOS6pOWNoeWvhuS/oeaBrwogICAgdXBWaXJ0dWFsKCkgewogICAgICBpZiAodGhpcy5kaXNrX3R5cGUgPT0gMikgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy52aXJ0dWFsTGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMudmlydHVhbExpc3RbaV07CiAgICAgICAgICBpZiAoIWVsZW1lbnQudmFsdWUpIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6K+36L6T5YWl5omA5pyJ5Y2h5a+GJyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy4kc2V0KHRoaXNbdGhpcy50YWJOYW1lXVt0aGlzLnRhYkluZGV4XSwgJ3ZpcnR1YWxfbGlzdCcsIHRoaXMudmlydHVhbExpc3QpOwogICAgICAgIHRoaXMuJHNldCh0aGlzW3RoaXMudGFiTmFtZV1bdGhpcy50YWJJbmRleF0sICdzdG9jaycsIHRoaXMudmlydHVhbExpc3QubGVuZ3RoKTsKICAgICAgICB0aGlzLnZpcnR1YWxMaXN0ID0gWwogICAgICAgICAgewogICAgICAgICAgICBrZXk6ICcnLAogICAgICAgICAgICB2YWx1ZTogJycsCiAgICAgICAgICB9LAogICAgICAgIF07CiAgICAgICAgdGhpcy4kc2V0KHRoaXNbdGhpcy50YWJOYW1lXVt0aGlzLnRhYkluZGV4XSwgJ2Rpc2tfaW5mbycsICcnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoIXRoaXMuZGlza19pbmZvLmxlbmd0aCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ivt+Whq+WGmeWNoeWvhuS/oeaBrycpOwogICAgICAgIH0KICAgICAgICBpZiAoIXRoaXMuc3RvY2spIHsKICAgICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCfor7floavlhpnlupPlrZjmlbDph48nKTsKICAgICAgICB9CiAgICAgICAgdGhpcy4kc2V0KHRoaXNbdGhpcy50YWJOYW1lXVt0aGlzLnRhYkluZGV4XSwgJ3N0b2NrJywgTnVtYmVyKHRoaXMuc3RvY2spKTsKICAgICAgICB0aGlzLiRzZXQodGhpc1t0aGlzLnRhYk5hbWVdW3RoaXMudGFiSW5kZXhdLCAnc3RvY2snLCBOdW1iZXIodGhpcy5zdG9jaykpOwogICAgICAgIHRoaXMuJHNldCh0aGlzW3RoaXMudGFiTmFtZV1bdGhpcy50YWJJbmRleF0sICdkaXNrX2luZm8nLCB0aGlzLmRpc2tfaW5mbyk7CiAgICAgICAgdGhpcy4kc2V0KHRoaXNbdGhpcy50YWJOYW1lXVt0aGlzLnRhYkluZGV4XSwgJ3ZpcnR1YWxfbGlzdCcsIFtdKTsKICAgICAgfQogICAgICB0aGlzLmFkZFZpcnR1YWxNb2RlbCA9IGZhbHNlOwogICAgICB0aGlzLmNsb3NlVmlydHVhbCgpOwogICAgfSwKICAgIC8vICDliJ3lp4vljJbljaHlr4bmlbDmja7kv6Hmga8KICAgIGNsb3NlVmlydHVhbCgpIHsKICAgICAgdGhpcy5hZGRWaXJ0dWFsTW9kZWwgPSBmYWxzZTsKICAgICAgdGhpcy52aXJ0dWFsTGlzdCA9IFsKICAgICAgICB7CiAgICAgICAgICBrZXk6ICcnLAogICAgICAgICAgdmFsdWU6ICcnLAogICAgICAgIH0sCiAgICAgIF07CiAgICAgIHRoaXMuZGlza19pbmZvID0gJyc7CiAgICAgIHRoaXMuc3RvY2sgPSAwOwogICAgfSwKICAgIC8v5a+56LGh5pWw57uE5Y676YeN77ybCiAgICB1bmlxdWVBcnJheShhcnIpIHsKICAgICAgY29uc3Qgc2VlbiA9IHt9OwogICAgICByZXR1cm4gYXJyLmZpbHRlcigoaXRlbSkgPT4gewogICAgICAgIGNvbnN0IGtleSA9IEpTT04uc3RyaW5naWZ5KGl0ZW0pOyAvLyDkvb/nlKggSlNPTi5zdHJpbmdpZnkg55Sf5oiQ5ZSv5LiA6ZSuCiAgICAgICAgaWYgKHNlZW5ba2V5XSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZWVuW2tleV0gPSB0cnVlOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAvLyDojrflj5bkvJjmg6DliLhpZOaVsOaNrgogICAgbmFtZUlkKGlkLCBuYW1lcykgewogICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5jb3Vwb25faWRzID0gaWQ7CiAgICAgIHRoaXMuY291cG9uTmFtZSA9IHRoaXMudW5pcXVlQXJyYXkobmFtZXMpOwogICAgfSwKICAgIC8vIOiOt+WPluS8mOaDoOWIuOS/oeaBrwogICAgZ29vZHNDb3Vwb25JZChkYXRhKSB7CiAgICAgIHRoaXMuJHNldCh0aGlzW3RoaXMudGFiTmFtZV1bdGhpcy50YWJJbmRleF0sICdjb3Vwb25faWQnLCBkYXRhLmlkKTsKICAgICAgdGhpcy4kc2V0KHRoaXNbdGhpcy50YWJOYW1lXVt0aGlzLnRhYkluZGV4XSwgJ2NvdXBvbl9uYW1lJywgZGF0YS50aXRsZSk7CiAgICAgIHRoaXMuJHJlZnMuZ29vZHNDb3Vwb24uaXNUZW1wbGF0ZSA9IGZhbHNlOwogICAgfSwKICAgIGhhbmRsZUNsb3NlKG5hbWUpIHsKICAgICAgbGV0IGluZGV4ID0gdGhpcy5jb3Vwb25OYW1lLmluZGV4T2YobmFtZSk7CiAgICAgIHRoaXMuY291cG9uTmFtZS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICBsZXQgY291cG9uSWRzID0gdGhpcy5mb3JtVmFsaWRhdGUuY291cG9uX2lkczsKICAgICAgY291cG9uSWRzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMudXBkYXRlSWRzID0gY291cG9uSWRzOwogICAgICB0aGlzLnVwZGF0ZU5hbWUgPSB0aGlzLmNvdXBvbk5hbWU7CiAgICB9LAogICAgLy8g5re75Yqg6L+Q6LS55qih5p2/CiAgICBhZGRUZW1wKCkgewogICAgICB0aGlzLiRyZWZzLnRlbXBsYXRlcy5pc1RlbXBsYXRlID0gdHJ1ZTsKICAgIH0sCiAgICBhZGRWaWRlbygpIHsKICAgICAgdGhpcy4kdmlkZW9Nb2RhbCgoZSkgPT4gewogICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLnZpZGVvX2xpbmsgPSBlOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDliKDpmaTop4bpopHvvJsKICAgIGRlbFZpZGVvKCkgewogICAgICB0aGlzLiRzZXQodGhpcy5mb3JtVmFsaWRhdGUsICd2aWRlb19saW5rJywgJycpOwogICAgICB0aGlzLiRzZXQodGhpcywgJ3Byb2dyZXNzJywgMCk7CiAgICAgIHRoaXMudmlkZW9JbmcgPSBmYWxzZTsKICAgICAgdGhpcy51cGxvYWQudmlkZW9JbmcgPSBmYWxzZTsKICAgIH0sCiAgICB6aF91cGxvYWRGaWxlKCkgewogICAgICBpZiAodGhpcy5zZWxldFZpZGVvID09IDEpIHsKICAgICAgICB0aGlzLmZvcm1WYWxpZGF0ZS52aWRlb19saW5rID0gdGhpcy52aWRlb0xpbms7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kcmVmcy5yZWZpZC5jbGljaygpOwogICAgICB9CiAgICB9LAogICAgLy8g5LiK5Lyg6KeG6aKRCiAgICB6aF91cGxvYWRGaWxlX2NoYW5nZShldmZpbGUpIHsKICAgICAgbGV0IHN1ZmZpeCA9IGV2ZmlsZS50YXJnZXQuZmlsZXNbMF0ubmFtZS5zdWJzdHIoZXZmaWxlLnRhcmdldC5maWxlc1swXS5uYW1lLmluZGV4T2YoJy4nKSk7CiAgICAgIGlmIChzdWZmaXguaW5kZXhPZignLm1wNCcpID09PSAtMSkgewogICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCflj6rog73kuIrkvKBNUDTmlofku7YnKTsKICAgICAgfQogICAgICBsZXQgdHlwZXMgPSB7CiAgICAgICAga2V5OiBldmZpbGUudGFyZ2V0LmZpbGVzWzBdLm5hbWUsCiAgICAgICAgY29udGVudFR5cGU6IGV2ZmlsZS50YXJnZXQuZmlsZXNbMF0udHlwZSwKICAgICAgfTsKICAgICAgcHJvZHVjdEdldFRlbXBLZXlzQXBpKHR5cGVzKQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuJHZpZGVvQ2xvdWQKICAgICAgICAgICAgLnZpZGVvVXBsb2FkKHsKICAgICAgICAgICAgICB0eXBlOiByZXMuZGF0YS50eXBlLAogICAgICAgICAgICAgIGV2ZmlsZTogZXZmaWxlLAogICAgICAgICAgICAgIHJlczogcmVzLAogICAgICAgICAgICAgIHVwbG9hZGluZyhzdGF0dXMsIHByb2dyZXNzKSB7CiAgICAgICAgICAgICAgICB0aGlzLnVwbG9hZC52aWRlb0luZyA9IHN0YXR1czsKICAgICAgICAgICAgICAgIGlmIChyZXMuc3RhdHVzID09IDIwMCkgewogICAgICAgICAgICAgICAgICB0aGlzLnByb2dyZXNzID0gMTAwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgICB0aGlzLmZvcm1WYWxpZGF0ZS52aWRlb19saW5rID0gcmVzLnVybDsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+inhumikeS4iuS8oOaIkOWKnycpOwogICAgICAgICAgICAgIHRoaXMudXBsb2FkLnZpZGVvSW5nID0gZmFsc2U7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaCgocmVzKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMpOwogICAgICAgICAgICB9KTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICAgIH0pOwogICAgfSwKICAgIC8vIOS4iuS4gOmhte+8mwogICAgdXBUYWIoKSB7CiAgICAgIHRoaXMuY3VycmVudFRhYiA9IChOdW1iZXIodGhpcy5jdXJyZW50VGFiKSAtIDEpLnRvU3RyaW5nKCk7CiAgICB9LAogICAgLy8g5LiL5LiA6aG177ybCiAgICBkb3duVGFiKCkgewogICAgICB0aGlzLmN1cnJlbnRUYWIgPSAoTnVtYmVyKHRoaXMuY3VycmVudFRhYikgKyAxKS50b1N0cmluZygpOwogICAgfSwKICAgIC8vIOWxnuaAp+W8ueeql+Wbnuiwg+WHveaVsO+8mwogICAgdXNlclNlYXJjaHMoKSB7CiAgICAgIHRoaXMucHJvZHVjdEdldFJ1bGUoKTsKICAgIH0sCiAgICAvLyDmt7vliqDop4TliJnvvJsKICAgIGFkZFJ1bGUoKSB7CiAgICAgIHRoaXMuJHJlZnMuYWRkYXR0ci5tb2RhbCA9IHRydWU7CiAgICB9LAogICAgLy8g5om56YeP6K6+572u5YiG5L2j77ybCiAgICBicm9rZXJhZ2VTZXRVcCgpIHsKICAgICAgaWYgKHRoaXMuZm9ybVZhbGlkYXRlLmlzX3N1Yi5pbmRleE9mKDEpID4gLTEpIHsKICAgICAgICBpZiAodGhpcy5tYW55QnJva2VyYWdlIDw9IDAgfHwgdGhpcy5tYW55QnJva2VyYWdlVHdvIDw9IDApIHsKICAgICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCfor7floavlhpnov5TkvaPph5Hpop3lkI7ov5vooYzmibnph4/mt7vliqAnKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5mb3JtVmFsaWRhdGUuaXNfc3ViLmluZGV4T2YoMCkgPiAtMSkgewogICAgICAgIGlmICh0aGlzLm1hbnlWaXBQcmljZSA8PSAwKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign6K+35aGr5YaZ5Lya5ZGY5Lu35ZCO6L+b6KGM5om56YeP5re75YqgJyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aGlzLmZvcm1WYWxpZGF0ZS5pc19zdWIubGVuZ3RoID09PSAyKSB7CiAgICAgICAgaWYgKHRoaXMubWFueUJyb2tlcmFnZSA8PSAwIHx8IHRoaXMubWFueUJyb2tlcmFnZVR3byA8PSAwKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign6K+35aGr5YaZ5a6M6YeR6aKd5ZCO6L+b6KGM5om56YeP5re75YqgJyk7CiAgICAgICAgfQogICAgICAgIGlmICh0aGlzLm1hbnlWaXBQcmljZSA+IDAgJiYgdGhpcy5tYW55VmlwRGlzY291bnQgPiAwKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign5Lya5ZGY5Lu35ZKM5Lya5ZGY5oqY5omj5Y+q6IO95LqM6YCJ5LiA5re75YqgJyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZvciAobGV0IHZhbCBvZiB0aGlzLm1hbnlGb3JtVmFsaWRhdGUpIHsKICAgICAgICB0aGlzLm1hbnlCcm9rZXJhZ2UgIT0gdW5kZWZpbmVkICYmIHRoaXMuJHNldCh2YWwsICdicm9rZXJhZ2UnLCB0aGlzLm1hbnlCcm9rZXJhZ2UpOwogICAgICAgIHRoaXMubWFueUJyb2tlcmFnZVR3byAhPSB1bmRlZmluZWQgJiYgdGhpcy4kc2V0KHZhbCwgJ2Jyb2tlcmFnZV90d28nLCB0aGlzLm1hbnlCcm9rZXJhZ2VUd28pOwogICAgICAgIGlmICh0aGlzLm1hbnlWaXBQcmljZSAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgIHRoaXMuJHNldCh2YWwsICd2aXBfcHJpY2UnLCB0aGlzLm1hbnlWaXBQcmljZSk7CiAgICAgICAgICB0aGlzLiRzZXQodmFsLCAndmlwX3Byb3BvcnRpb24nLCAoKHZhbC52aXBfcHJpY2UgLyB2YWwucHJpY2UpICogMTAwKS50b0ZpeGVkKDIpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kc2V0KHZhbCwgJ3ZpcF9wcm9wb3J0aW9uJywgdGhpcy5tYW55VmlwRGlzY291bnQpOwogICAgICAgICAgdGhpcy4kc2V0KHZhbCwgJ3ZpcF9wcmljZScsICh2YWwucHJpY2UgKiAodGhpcy5tYW55VmlwRGlzY291bnQgLyAxMDApKS50b0ZpeGVkKDIpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAvLyDmibnph4/orr7nva7kvJrlkZjku7cKICAgIHZpcFByaWNlU2V0VXAoKSB7CiAgICAgIGlmICh0aGlzLm1hbnlWaXBQcmljZSA8PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ivt+Whq+WGmeS8muWRmOS7t+WcqOi/m+ihjOaJuemHj+a3u+WKoCcpOwogICAgICB9IGVsc2UgewogICAgICAgIGZvciAobGV0IHZhbCBvZiB0aGlzLm1hbnlGb3JtVmFsaWRhdGUpIHsKICAgICAgICAgIHRoaXMuJHNldCh2YWwsICd2aXBfcHJpY2UnLCB0aGlzLm1hbnlWaXBQcmljZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgLy8g5paw5aKe5Y2h5a+GCiAgICBoYW5kbGVBZGQoKSB7CiAgICAgIHRoaXMudmlydHVhbExpc3QucHVzaCh7CiAgICAgICAga2V5OiAnJywKICAgICAgICB2YWx1ZTogJycsCiAgICAgIH0pOwogICAgfSwKICAgIC8vIOWIneWni+WMluWNoeWvhuS/oeaBrwogICAgaW5pdFZpcnR1YWxEYXRhKHN0YXR1cykgewogICAgICB0aGlzLnZpcnR1YWxMaXN0ID0gWwogICAgICAgIHsKICAgICAgICAgIGtleTogJycsCiAgICAgICAgICB2YWx1ZTogJycsCiAgICAgICAgfSwKICAgICAgXTsKICAgIH0sCiAgICByZW1vdmVWaXJ0dWFsKGluZGV4KSB7CiAgICAgIHRoaXMudmlydHVhbExpc3Quc3BsaWNlKGluZGV4LCAxKTsKICAgIH0sCiAgICAvLyDmuIXnqbrmibnph4/op4TmoLzkv6Hmga8KICAgIGJhdGNoRGVsKCkgewogICAgICB0aGlzLm9uZUZvcm1CYXRjaCA9IFsKICAgICAgICB7CiAgICAgICAgICBwaWM6ICcnLAogICAgICAgICAgcHJpY2U6IHZvaWQgMCwKICAgICAgICAgIGNvc3Q6IHZvaWQgMCwKICAgICAgICAgIG90X3ByaWNlOiB2b2lkIDAsCiAgICAgICAgICBzdG9jazogdm9pZCAwLAogICAgICAgICAgYmFyX2NvZGU6ICcnLAogICAgICAgICAgYmFyX2NvZGVfbnVtYmVyOiAnJywKICAgICAgICAgIHdlaWdodDogdm9pZCAwLAogICAgICAgICAgdm9sdW1lOiB2b2lkIDAsCiAgICAgICAgICB2aXJ0dWFsX2xpc3Q6IFtdLAogICAgICAgIH0sCiAgICAgIF07CiAgICB9LAogICAgY29uZmlybShuYW1lKSB7CiAgICAgIHRoaXMuY3JlYXRlQm50ID0gdHJ1ZTsKICAgICAgdGhpcy5mb3JtVmFsaWRhdGUuc2VsZWN0UnVsZSA9IG5hbWU7CiAgICAgIHRoaXMuYXR0cnMgPSBbXTsKICAgICAgaWYgKHRoaXMuZm9ybVZhbGlkYXRlLnNlbGVjdFJ1bGUudHJpbSgpLmxlbmd0aCA8PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ivt+mAieaLqeWxnuaApycpOwogICAgICB9CiAgICAgIHRoaXMucnVsZUxpc3QuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICBpZiAoaXRlbS5ydWxlX25hbWUgPT09IHRoaXMuZm9ybVZhbGlkYXRlLnNlbGVjdFJ1bGUpIHsKICAgICAgICAgIHRoaXMuYXR0cnMgPSBbLi4uaXRlbS5ydWxlX3ZhbHVlXTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLmNhblNlbCA9IHRydWU7CiAgICAgIHRoaXMuZ2VuZXJhdGVBdHRyKHRoaXMuYXR0cnMpOwogICAgfSwKICAgIC8vIOmAieaLqeinhOagvOaooeadvwogICAgaGFuZGxlQ29tbWFuZChlKSB7fSwKICAgIC8vIOiOt+WPluWVhuWTgeWxnuaAp+aooeadv++8mwogICAgcHJvZHVjdEdldFJ1bGUoKSB7CiAgICAgIHByb2R1Y3RHZXRSdWxlQXBpKCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgdGhpcy5ydWxlTGlzdCA9IHJlcy5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDojrflj5bov5DotLnmqKHmnb/vvJsKICAgIHByb2R1Y3RHZXRUZW1wbGF0ZSgpIHsKICAgICAgcHJvZHVjdEdldFRlbXBsYXRlQXBpKCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgdGhpcy50ZW1wbGF0ZUxpc3QgPSByZXMuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgcGFyYW1zR2V0VGVtcGxhdGUoKSB7CiAgICAgIHBhcmFtTGlzdEFwaSgpLnRoZW4oKHJlcykgPT4gewogICAgICAgIHRoaXMucGFyYW1zVHlwZUxpc3QgPSByZXMuZGF0YS5saXN0OwogICAgICB9KTsKICAgIH0sCiAgICBjaGFuZ2VQYXJhbXNUeXBlKGUpIHsKICAgICAgZSA/IHRoaXMuZ2V0UGFyYW1zKGUpIDogKHRoaXMuZm9ybVZhbGlkYXRlLnBhcmFtc19saXN0ID0gW10pOwogICAgfSwKICAgIGdldFBhcmFtcyhpZCkgewogICAgICBwYXJhbUluZm9BcGkoaWQpLnRoZW4oKHJlcykgPT4gewogICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLnBhcmFtc19saXN0ID0gcmVzLmRhdGEudmFsdWU7CiAgICAgIH0pOwogICAgfSwKICAgIGlzU3Vic2V0KGFycjEsIGFycjIpIHsKICAgICAgLy8g5bCG5pWw57uE6L2s5o2i5Li6IFNldO+8jOS7peS+v+i/m+ihjOmrmOaViOeahOWMheWQq+ajgOafpQogICAgICBjb25zdCBzZXQxID0gbmV3IFNldChhcnIxKTsKICAgICAgY29uc3Qgc2V0MiA9IG5ldyBTZXQoYXJyMik7CgogICAgICAvLyDmo4Dmn6Ugc2V0MiDkuK3nmoTmr4/kuKrlhYPntKDmmK/lkKbpg73lnKggc2V0MSDkuK0KICAgICAgZm9yIChsZXQgZWxlbSBvZiBzZXQyKSB7CiAgICAgICAgaWYgKCFzZXQxLmhhcyhlbGVtKSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0sCiAgICAvLyDmibnph4/mt7vliqAKICAgIGJhdGNoQWRkKCkgewogICAgICBsZXQgYXJyID0gW107CiAgICAgIGZvciAobGV0IHZhbCBvZiB0aGlzLmF0dHJzKSB7CiAgICAgICAgaWYgKHRoaXMub25lRm9ybUJhdGNoWzBdW3ZhbC52YWx1ZV0pIHsKICAgICAgICAgIGFyci5wdXNoKHRoaXMub25lRm9ybUJhdGNoWzBdW3ZhbC52YWx1ZV0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgLy8g5om56YeP6K6+572u5ZWG5ZOB6KeE5qC85bGe5oCnCiAgICAgIGNvbnN0IGJhdGNoRmllbGRzID0gWwogICAgICAgICdwaWMnLAogICAgICAgICdwcmljZScsCiAgICAgICAgJ2Nvc3QnLAogICAgICAgICdvdF9wcmljZScsCiAgICAgICAgJ3N0b2NrJywKICAgICAgICAnd2VpZ2h0JywKICAgICAgICAndm9sdW1lJywKICAgICAgICAnYmFyX2NvZGUnLAogICAgICAgICdiYXJfY29kZV9udW1iZXInLAogICAgICBdOwogICAgICAvLyBjb25zdCBkZWZhdWx0RmllbGRzID0gWydiYXJfY29kZScsICdiYXJfY29kZV9udW1iZXInXTsKCiAgICAgIGZvciAobGV0IHZhbCBvZiB0aGlzLm1hbnlGb3JtVmFsaWRhdGUpIHsKICAgICAgICBjb25zdCBiYXRjaCA9IHRoaXMub25lRm9ybUJhdGNoWzBdOwogICAgICAgIC8vIOWmguaenOWtmOWcqOetm+mAieadoeS7tuS4lOa7oei2s+adoeS7tizmiJbml6DnrZvpgInmnaHku7bml7YKICAgICAgICBpZiAoIWFyci5sZW5ndGggfHwgdGhpcy5pc1N1YnNldCh2YWwuYXR0cl9hcnIsIGFycikpIHsKICAgICAgICAgIC8vIOiuvue9ruacieWAvOeahOaJuemHj+Wtl+autQogICAgICAgICAgYmF0Y2hGaWVsZHMuZm9yRWFjaCgoZmllbGQpID0+IHsKICAgICAgICAgICAgaWYgKGJhdGNoW2ZpZWxkXSAmJiBiYXRjaFtmaWVsZF0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgIGlmIChmaWVsZCA9PT0gJ3BpYycgJiYgYmF0Y2hbZmllbGRdKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRzZXQodmFsLCBmaWVsZCwgYmF0Y2hbZmllbGRdKTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZpZWxkICE9ICdwaWMnKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRzZXQodmFsLCBmaWVsZCwgYmF0Y2hbZmllbGRdKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwoKICAgICAgICAgIC8vIOiuvue9rum7mOiupOWtl+autQogICAgICAgICAgLy8gZGVmYXVsdEZpZWxkcy5mb3JFYWNoKChmaWVsZCkgPT4gewogICAgICAgICAgLy8gICB0aGlzLiRzZXQodmFsLCBmaWVsZCwgYmF0Y2hbZmllbGRdKTsKICAgICAgICAgIC8vIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGNoYW5nZVNwZWNJbWcoYXJyLCBpbWcpIHsKICAgICAgLy8g5Yik5pat5piv5ZCm5a2Y5Zyo6KeE5qC85Zu+CiAgICAgIGxldCBpc0hhcyA9IGZhbHNlOwogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHRoaXMubWFueUZvcm1WYWxpZGF0ZS5sZW5ndGg7IGkrKykgewogICAgICAgIGxldCBpdGVtID0gdGhpcy5tYW55Rm9ybVZhbGlkYXRlW2ldOwogICAgICAgIGlmIChpdGVtLnBpYyAmJiB0aGlzLmlzU3Vic2V0KGl0ZW0uYXR0cl9hcnIsIGFycikpIHsKICAgICAgICAgIGlzSGFzID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoaXNIYXMpIHsKICAgICAgICB0aGlzLiRjb25maXJtKCflj6/ku6XlkIzmraXkv67mlLnkuIvmlrnor6Xop4TmoLzlm77niYfvvIznoa7lrpropoHmm7/mjaLlkJfvvJ8nLCAn5o+Q56S6JywgewogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfmm7/mjaInLAogICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+aaguS4jScsCiAgICAgICAgICB0eXBlOiAnd2FybmluZycsCiAgICAgICAgfSkKICAgICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgICAgZm9yIChsZXQgdmFsIG9mIHRoaXMubWFueUZvcm1WYWxpZGF0ZSkgewogICAgICAgICAgICAgIGlmICh0aGlzLmlzU3Vic2V0KHZhbC5hdHRyX2FyciwgYXJyKSkgewogICAgICAgICAgICAgICAgdGhpcy4kc2V0KHZhbCwgJ3BpYycsIGltZyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKCgpID0+IHt9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGxldCB2YWwgb2YgdGhpcy5tYW55Rm9ybVZhbGlkYXRlKSB7CiAgICAgICAgICBpZiAodGhpcy5pc1N1YnNldCh2YWwuYXR0cl9hcnIsIGFycikpIHsKICAgICAgICAgICAgdGhpcy4kc2V0KHZhbCwgJ3BpYycsIGltZyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgLy8g56uL5Y2z55Sf5oiQCiAgICBnZW5lcmF0ZSh0eXBlLCBpc0NvcHksIGFycikgewogICAgICB0aGlzLm1hbnlGb3JtVmFsaWRhdGUgPSBbXTsKICAgICAgdGhpcy5mb3JtVmFsaWRhdGUuaGVhZGVyID0gW107CiAgICB9LAogICAgY2xlYXJBdHRyKCkgewogICAgICB0aGlzLmZvcm1EeW5hbWljLmF0dHJzTmFtZSA9ICcnOwogICAgICB0aGlzLmZvcm1EeW5hbWljLmF0dHJzVmFsID0gJyc7CiAgICB9LAoKICAgIC8vIOWIoOmZpOinhOagvAogICAgaGFuZGxlUmVtb3ZlUm9sZShpbmRleCkgewogICAgICB0aGlzLmF0dHJzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMubWFueUZvcm1WYWxpZGF0ZS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICBpZiAoIXRoaXMuYXR0cnMubGVuZ3RoKSB7CiAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGUuaGVhZGVyID0gW107CiAgICAgICAgdGhpcy5tYW55Rm9ybVZhbGlkYXRlID0gW107CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5nZW5lcmF0ZUF0dHIodGhpcy5hdHRycyk7CiAgICAgIH0KICAgIH0sCiAgICAvLyDliKDpmaTooajmoLzkuK0g5a+55bqU5bGe5oCnCiAgICBkZWxBdHRyVGFibGUodmFsKSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5tYW55Rm9ybVZhbGlkYXRlLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgbGV0IGl0ZW0gPSB0aGlzLm1hbnlGb3JtVmFsaWRhdGVbaV07CiAgICAgICAgaWYgKGl0ZW0uYXR0cl9hcnIgJiYgaXRlbS5hdHRyX2Fyci5pbmNsdWRlcyh2YWwpKSB7CiAgICAgICAgICB0aGlzLm1hbnlGb3JtVmFsaWRhdGUuc3BsaWNlKGksIDEpOwogICAgICAgICAgaS0tOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOWIoOmZpOWxnuaApwogICAgaGFuZGxlUmVtb3ZlMihpdGVtLCBpbmRleCwgdmFsKSB7CiAgICAgIC8vIOWIoOmZpCBtYW55Rm9ybVZhbGlkYXRl5LitIHRpdGxlID0gaXRlbS52YWx1ZSDnmoTlsZ7mgKflgLwKICAgICAgaXRlbS5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAvLyB0aGlzLmdlbmVyYXRlQXR0cih0aGlzLmF0dHJzKTsKICAgICAgdGhpcy5kZWxBdHRyVGFibGUodmFsKTsKICAgIH0sCiAgICAvLyDmlrDlop7op4TmoLwKICAgIGhhbmRsZUFkZFJvbGUoKSB7CiAgICAgIGxldCBkYXRhID0gewogICAgICAgIHZhbHVlOiB0aGlzLmZvcm1EeW5hbWljLmF0dHJzTmFtZSwKICAgICAgICBhZGRfcGljOiAwLAogICAgICAgIGRldGFpbDogW10sCiAgICAgIH07CiAgICAgIHRoaXMuYXR0cnMucHVzaChkYXRhKTsKICAgIH0sCiAgICBoYW5kbGVBZGRQYXJhbXMoKSB7CiAgICAgIGxldCBkYXRhID0gewogICAgICAgIG5hbWU6ICcnLAogICAgICAgIHZhbHVlOiAnJywKICAgICAgfTsKICAgICAgdGhpcy5mb3JtVmFsaWRhdGUucGFyYW1zX2xpc3QucHVzaChkYXRhKTsKICAgIH0sCiAgICBoYW5kbGVTYXZlQXNUZW1wbGF0ZSgpIHsKICAgICAgdGhpcy4kcHJvbXB0KCcnLCAn6K+36L6T5YWl5qih5p2/5ZCN56ewJywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgfSkKICAgICAgICAudGhlbigoeyB2YWx1ZSB9KSA9PiB7CiAgICAgICAgICBsZXQgc3BlYyA9IHRoaXMuYXR0cnMubWFwKChpdGVtKSA9PiB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0udmFsdWUsCiAgICAgICAgICAgICAgZGV0YWlsOiBpdGVtLmRldGFpbC5tYXAoKGUpID0+IGUudmFsdWUpLAogICAgICAgICAgICB9OwogICAgICAgICAgfSk7CiAgICAgICAgICBsZXQgZm9ybUR5bmFtaWMgPSB7CiAgICAgICAgICAgIHJ1bGVfbmFtZTogdmFsdWUsCiAgICAgICAgICAgIHNwZWM6IHNwZWMsCiAgICAgICAgICB9OwogICAgICAgICAgcnVsZUFkZEFwaShmb3JtRHluYW1pYywgMCkKICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXMubXNnKTsKICAgICAgICAgICAgICB0aGlzLnByb2R1Y3RHZXRSdWxlKCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaCgocmVzKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubXNnKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKCkgPT4ge30pOwogICAgfSwKICAgIC8vIOaWsOWinuS4gOadoeWxnuaApwogICAgYWRkT25lQXR0cih2YWwsIHZhbDIpIHsKICAgICAgdGhpcy5nZW5lcmF0ZUF0dHIodGhpcy5hdHRycywgdmFsMik7CiAgICB9LAogICAgaGFuZGxlRm9jdXModmFsKSB7CiAgICAgIHRoaXMuY2hhbmdlQXR0clZhbHVlID0gdmFsOwogICAgfSwKICAgIGhhbmRsZUJsdXIoKSB7CiAgICAgIHRoaXMuY2hhbmdlQXR0clZhbHVlID0gJyc7CiAgICB9LAogICAgaGFuZGxlU2VsSW1nKGl0ZW0pIHsKICAgICAgdGhpcy4kaW1nTW9kYWwoKGUpID0+IHsKICAgICAgICBpdGVtLnBpYyA9IGUuYXR0X2RpcjsKICAgICAgICB0aGlzLmNoYW5nZVNwZWNJbWcoW2l0ZW0udmFsdWVdLCBlLmF0dF9kaXIpOwogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVSZW1vdmVJbWcoaXRlbSkgewogICAgICBpdGVtLnBpYyA9ICcnOwogICAgfSwKICAgIC8vIOinhOagvOWQjeensOaUueWPmAogICAgYXR0ckNoYW5nZVZhbHVlKGksIHZhbCkgewogICAgICBpZiAodmFsLnRyaW0oKS5sZW5ndGggJiYgdGhpcy5hdHRyc1tpXS5kZXRhaWwubGVuZ3RoKSB7CiAgICAgICAgdGhpcy5nZW5lcmF0ZUhlYWRlcih0aGlzLmF0dHJzKTsKICAgICAgICBpZiAodGhpcy5tYW55Rm9ybVZhbGlkYXRlLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5tYW55Rm9ybVZhbGlkYXRlLm1hcCgoaXRlbSwgaSkgPT4gewogICAgICAgICAgICBpZiAoaSA+IDApIHsKICAgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoaXRlbS5kZXRhaWwpLmluY2x1ZGVzKHRoaXMuY2hhbmdlQXR0clZhbHVlKSkgewogICAgICAgICAgICAgICAgaXRlbS5kZXRhaWxbdmFsXSA9IGl0ZW0uZGV0YWlsW3RoaXMuY2hhbmdlQXR0clZhbHVlXTsKICAgICAgICAgICAgICAgIGl0ZW1bdmFsXSA9IGl0ZW1bdGhpcy5jaGFuZ2VBdHRyVmFsdWVdOwogICAgICAgICAgICAgICAgZGVsZXRlIGl0ZW0uZGV0YWlsW3RoaXMuY2hhbmdlQXR0clZhbHVlXTsKICAgICAgICAgICAgICAgIGRlbGV0ZSBpdGVtW3RoaXMuY2hhbmdlQXR0clZhbHVlXTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5jaGFuZ2VBdHRyVmFsdWUgPSB2YWw7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZ2VuZXJhdGVBdHRyKHRoaXMuYXR0cnMpOwogICAgICB9CiAgICB9LAogICAgLy8g6KeE5qC85YC85pS55Y+YCiAgICBhdHRyRGV0YWlsQ2hhbmdlVmFsdWUodmFsLCBpKSB7CiAgICAgIGlmICh0aGlzLm1hbnlGb3JtVmFsaWRhdGUubGVuZ3RoKSB7CiAgICAgICAgbGV0IGtleSA9IHRoaXMuYXR0cnNbaV0udmFsdWU7CiAgICAgICAgdGhpcy5tYW55Rm9ybVZhbGlkYXRlLm1hcCgoaXRlbSwgaSkgPT4gewogICAgICAgICAgaWYgKGkgPiAwKSB7CiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhpdGVtLmRldGFpbCkuaW5jbHVkZXMoa2V5KSAmJiBpdGVtLmRldGFpbFtrZXldID09PSB0aGlzLmNoYW5nZUF0dHJWYWx1ZSkgewogICAgICAgICAgICAgIGl0ZW0uZGV0YWlsW2tleV0gPSB2YWw7CiAgICAgICAgICAgICAgbGV0IGluZGV4ID0gaXRlbS5hdHRyX2Fyci5maW5kSW5kZXgoKGl0ZW0pID0+IGl0ZW0gPT09IHRoaXMuY2hhbmdlQXR0clZhbHVlKTsKICAgICAgICAgICAgICBpdGVtLmF0dHJfYXJyW2luZGV4XSA9IHZhbDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHRoaXMuY2hhbmdlQXR0clZhbHVlID0gdmFsOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZ2VuZXJhdGVBdHRyKHRoaXMuYXR0cnMsIDEpOwogICAgICB9CiAgICB9LAogICAgLy8g6KeE5qC85Zu+54mH5re75Yqg5byA5YWzCiAgICBhZGRQaWMoZSwgaSkgewogICAgICBpZiAoZSkgewogICAgICAgIHRoaXMuYXR0cnMubWFwKChpdGVtLCBpaSkgPT4gewogICAgICAgICAgaWYgKGlpICE9PSBpKSB7CiAgICAgICAgICAgIHRoaXMuJHNldChpdGVtLCAnYWRkX3BpYycsIDApOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHRoaXMuY2FuU2VsID0gZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5jYW5TZWwgPSB0cnVlOwogICAgICB9CiAgICB9LAogICAgLy8g6KeE5qC85ouW5ou95o6S5bqP5ZCOCiAgICBvbk1vdmVTcGVjKCkgewogICAgICB0aGlzLmdlbmVyYXRlQXR0cih0aGlzLmF0dHJzKTsKICAgIH0sCiAgICBjaGFuZ2VDdXJyZW50SW5kZXgoaSkgewogICAgICB0aGlzLmN1cnJlbnRJbmRleCA9IGk7CiAgICB9LAogICAgLy8g55Sf5oiQ5ZWG5ZOB6KeE5qC86KGo5aS0CiAgICBnZW5lcmF0ZUhlYWRlcihkYXRhKSB7CiAgICAgIGxldCBzcGVjaWZpY2F0aW9uc0NvbHVtbnMgPSBkYXRhLm1hcCgoaXRlbSkgPT4gKHsKICAgICAgICB0aXRsZTogaXRlbS52YWx1ZSwKICAgICAgICBrZXk6IGl0ZW0udmFsdWUsCiAgICAgICAgbWluV2lkdGg6IDE0MCwKICAgICAgICBmaXhlZDogJ2xlZnQnLAogICAgICB9KSk7CiAgICAgIGxldCBhcnI7CiAgICAgIGlmIChbMSwgMl0uaW5jbHVkZXMoTnVtYmVyKHRoaXMuZm9ybVZhbGlkYXRlLnZpcnR1YWxfdHlwZSkpKSB7CiAgICAgICAgYXJyID0gWy4uLnNwZWNpZmljYXRpb25zQ29sdW1ucywgLi4uVmlydHVhbFRhYmxlSGVhZF07CiAgICAgICAgLy8g5om+5Yiwc2xvdCDnrYnkuo4gZmljdGl0aW91cyDlsIZ0aXRsZeaUueS4uuinhOagvOWQjeensAogICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmhlYWRlci5tYXAoKGl0ZW0pID0+IHsKICAgICAgICAgIGlmIChpdGVtLnNsb3QgPT09ICdmaWN0aXRpb3VzJykgewogICAgICAgICAgICBpdGVtLnRpdGxlID0gdGhpcy5mb3JtVmFsaWRhdGUudmlydHVhbF90eXBlID09IDEgPyAn5re75Yqg5Y2h5a+GL+e9keebmCcgOiAn6YCJ5oup5LyY5oOg5Yi4JzsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmZvcm1WYWxpZGF0ZS52aXJ0dWFsX3R5cGUgPT0gMykgewogICAgICAgIGFyciA9IFsuLi5zcGVjaWZpY2F0aW9uc0NvbHVtbnMsIC4uLlZpcnR1YWxUYWJsZUhlYWQyXTsKICAgICAgfSBlbHNlIHsKICAgICAgICBhcnIgPSBbLi4uc3BlY2lmaWNhdGlvbnNDb2x1bW5zLCAuLi5Hb29kc1RhYmxlSGVhZF07CiAgICAgIH0KICAgICAgdGhpcy4kc2V0KHRoaXMuZm9ybVZhbGlkYXRlLCAnaGVhZGVyJywgYXJyKTsKICAgICAgdGhpcy50YWJsZUtleSArPSAxOwogICAgICB0aGlzLmNvbHVtbnNJbnN0YWxNID0gYXJyOwogICAgfSwKICAgIC8qCiAgICAgKiDnlJ/miJDlsZ7mgKcKICAgICAqIEBwYXJhbSB7QXJyYXl9IGRhdGEg6KeE5qC85pWw5o2uCiAgICAgKiAqLwogICAgZ2VuZXJhdGVBdHRyKGRhdGEsIHZhbCkgewogICAgICB0aGlzLmdlbmVyYXRlSGVhZGVyKGRhdGEpOwogICAgICBjb25zdCBjb21iaW5hdGlvbnMgPSB0aGlzLmdlbmVyYXRlQ29tYmluYXRpb25zKGRhdGEpOwogICAgICBjb25zb2xlLmxvZygn6KeE5qC857uE5ZCI5oC75pWw77yaJyArIGNvbWJpbmF0aW9ucy5sZW5ndGgpOwogICAgICBjb25zdCB2aXJ0dWFsVHlwZSA9IHRoaXMuZm9ybVZhbGlkYXRlLnZpcnR1YWxfdHlwZTsKICAgICAgLy8g5aaC5p6cY29tYmluYXRpb25z5pWw6YeP6LaF6L+HIDUwMO+8jOWImeWIhuaJueasoeeUn+aIkOWxnuaApwogICAgICBsZXQgcm93cyA9IFtdOwogICAgICBpZiAoY29tYmluYXRpb25zLmxlbmd0aCA+IDUwMCkgewogICAgICAgIGNvbnN0IGJhdGNoU2l6ZSA9IE1hdGguY2VpbChjb21iaW5hdGlvbnMubGVuZ3RoIC8gNTAwKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbWJpbmF0aW9ucy5sZW5ndGg7IGkgKz0gYmF0Y2hTaXplKSB7CiAgICAgICAgICBzZXRUaW1lb3V0KChlKSA9PiB7CiAgICAgICAgICAgIGxldCBkID0gdGhpcy5nZW5lcmF0ZUF0dHJCYXRjaChkYXRhLCBjb21iaW5hdGlvbnMuc2xpY2UoaSwgaSArIGJhdGNoU2l6ZSksIHZhbCk7CiAgICAgICAgICAgIHJvd3MgPSBbLi4ucm93cywgLi4uZF07CiAgICAgICAgICAgIHRoaXMubWFueUZvcm1WYWxpZGF0ZSA9IFsuLi50aGlzLm9uZUZvcm1CYXRjaCwgLi4ucm93c107CiAgICAgICAgICB9LCAwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcm93cyA9IHRoaXMuZ2VuZXJhdGVBdHRyQmF0Y2goZGF0YSwgY29tYmluYXRpb25zLCB2YWwpOwogICAgICAgIHRoaXMubWFueUZvcm1WYWxpZGF0ZSA9IFsuLi50aGlzLm9uZUZvcm1CYXRjaCwgLi4ucm93c107CiAgICAgIH0KICAgIH0sCiAgICAvLyDnlJ/miJDlsZ7mgKfmibnmrKEKICAgIGdlbmVyYXRlQXR0ckJhdGNoKGRhdGEsIGNvbWJpbmF0aW9ucywgdmFsKSB7CiAgICAgIGNvbnN0IGV4aXN0aW5nSXRlbXMgPSB0aGlzLm1hbnlGb3JtVmFsaWRhdGUuc2xpY2UoMSk7IC8vIOaOkumZpOesrOS4gOmhuem7mOiupOaVsOaNrgoKICAgICAgY29uc3Qgcm93cyA9IGNvbWJpbmF0aW9ucy5tYXAoKGNvbWJpbmF0aW9uKSA9PiB7CiAgICAgICAgY29uc3Qgcm93ID0gewogICAgICAgICAgYXR0cl9hcnI6IGNvbWJpbmF0aW9uLAogICAgICAgICAgZGV0YWlsOiB7fSwKICAgICAgICAgIHRpdGxlOiAnJywKICAgICAgICAgIGtleTogJycsCiAgICAgICAgICBwcmljZTogMCwKICAgICAgICAgIHBpYzogJycsCiAgICAgICAgICBvdF9wcmljZTogMCwKICAgICAgICAgIGNvc3Q6IDAsCiAgICAgICAgICBzdG9jazogMCwKICAgICAgICAgIGlzX3Nob3c6IDEsCiAgICAgICAgICBpc19kZWZhdWx0X3NlbGVjdDogMCwKICAgICAgICAgIHVuaXF1ZTogJycsCiAgICAgICAgICB3ZWlnaHQ6ICcnLAogICAgICAgICAgdm9sdW1lOiAnJywKICAgICAgICAgIGJyb2tlcmFnZTogMCwKICAgICAgICAgIGJyb2tlcmFnZV90d286IDAsCiAgICAgICAgICB2aXBfcHJpY2U6IDAsCiAgICAgICAgICB2aXBfcHJvcG9ydGlvbjogMCwKICAgICAgICB9OwoKICAgICAgICAvLyDorr7nva7omZrmi5/nsbvlnovnm7jlhbPlsZ7mgKcKICAgICAgICBpZiAodGhpcy5mb3JtVmFsaWRhdGUudmlydHVhbF90eXBlID09PSAxKSB7CiAgICAgICAgICByb3cudmlydHVhbF9saXN0ID0gW107CiAgICAgICAgICByb3cuZGlza19pbmZvID0gJyc7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmZvcm1WYWxpZGF0ZS52aXJ0dWFsX3R5cGUgPT09IDIpIHsKICAgICAgICAgIHJvdy5jb3Vwb25faWQgPSAwOwogICAgICAgICAgcm93LmNvdXBvbl9uYW1lID0gJyc7CiAgICAgICAgfQoKICAgICAgICAvLyDlpITnkIbop4TmoLzlsZ7mgKcKICAgICAgICBkYXRhLmZvckVhY2goKGl0ZW0sIGkpID0+IHsKICAgICAgICAgIGNvbnN0IHZhbHVlID0gY29tYmluYXRpb25baV07CiAgICAgICAgICByb3dbaXRlbS52YWx1ZV0gPSB2YWx1ZTsKICAgICAgICAgIHJvdy50aXRsZSA9IGl0ZW0udmFsdWU7CiAgICAgICAgICByb3cua2V5ID0gaXRlbS52YWx1ZTsKICAgICAgICAgIHJvdy5kZXRhaWxbaXRlbS52YWx1ZV0gPSB2YWx1ZTsKCiAgICAgICAgICAvLyDmn6Xmib7ljLnphY3nmoTnjrDmnInop4TmoLzpobkKICAgICAgICAgIGNvbnN0IG1hdGNoZWRJdGVtID0gZXhpc3RpbmdJdGVtcy5maW5kKChpdGVtKSA9PiBpdGVtLmF0dHJfYXJyICYmIGFycmF5c0VxdWFsKGl0ZW0uYXR0cl9hcnIsIGNvbWJpbmF0aW9uKSk7CgogICAgICAgICAgaWYgKG1hdGNoZWRJdGVtKSB7CiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ocm93LCB7CiAgICAgICAgICAgICAgcHJpY2U6IG1hdGNoZWRJdGVtLnByaWNlLAogICAgICAgICAgICAgIGNvc3Q6IG1hdGNoZWRJdGVtLmNvc3QsCiAgICAgICAgICAgICAgb3RfcHJpY2U6IG1hdGNoZWRJdGVtLm90X3ByaWNlLAogICAgICAgICAgICAgIHN0b2NrOiBtYXRjaGVkSXRlbS5zdG9jaywKICAgICAgICAgICAgICBwaWM6IG1hdGNoZWRJdGVtLnBpYywKICAgICAgICAgICAgICB1bmlxdWU6IG1hdGNoZWRJdGVtLnVuaXF1ZSB8fCAnJywKICAgICAgICAgICAgICB3ZWlnaHQ6IG1hdGNoZWRJdGVtLndlaWdodCB8fCAnJywKICAgICAgICAgICAgICB2b2x1bWU6IG1hdGNoZWRJdGVtLnZvbHVtZSB8fCAnJywKICAgICAgICAgICAgICBpc19zaG93OiBtYXRjaGVkSXRlbS5pc19zaG93IHx8IDEsCiAgICAgICAgICAgICAgaXNfZGVmYXVsdF9zZWxlY3Q6IG1hdGNoZWRJdGVtLmlzX2RlZmF1bHRfc2VsZWN0IHx8IDAsCiAgICAgICAgICAgICAgdm9sdW1lOiBtYXRjaGVkSXRlbS52b2x1bWUgfHwgMCwKICAgICAgICAgICAgICBiYXJfY29kZV9udW1iZXI6IG1hdGNoZWRJdGVtLmJhcl9jb2RlX251bWJlciB8fCAwLAogICAgICAgICAgICAgIGlzX3ZpcnR1YWw6IG1hdGNoZWRJdGVtLmlzX3ZpcnR1YWwsCiAgICAgICAgICAgICAgYnJva2VyYWdlOiBtYXRjaGVkSXRlbS5icm9rZXJhZ2UsCiAgICAgICAgICAgICAgYnJva2VyYWdlX3R3bzogbWF0Y2hlZEl0ZW0uYnJva2VyYWdlX3R3bywKICAgICAgICAgICAgICB2aXBfcHJpY2U6IG1hdGNoZWRJdGVtLnZpcF9wcmljZSwKICAgICAgICAgICAgICB2aXBfcHJvcG9ydGlvbjogbWF0Y2hlZEl0ZW0udmlwX3Byb3BvcnRpb24sCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKHRoaXMuZm9ybVZhbGlkYXRlLnZpcnR1YWxfdHlwZSA9PT0gMSkgewogICAgICAgICAgICAgIHJvdy52aXJ0dWFsX2xpc3QgPSBtYXRjaGVkSXRlbS52aXJ0dWFsX2xpc3Q7CiAgICAgICAgICAgICAgcm93LmRpc2tfaW5mbyA9IG1hdGNoZWRJdGVtLmRpc2tfaW5mbzsKICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmZvcm1WYWxpZGF0ZS52aXJ0dWFsX3R5cGUgPT09IDIgJiYgbWF0Y2hlZEl0ZW0uY291cG9uX2lkKSB7CiAgICAgICAgICAgICAgcm93LmNvdXBvbl9pZCA9IG1hdGNoZWRJdGVtLmNvdXBvbl9pZDsKICAgICAgICAgICAgICByb3cuY291cG9uX25hbWUgPSBtYXRjaGVkSXRlbS5jb3Vwb25fbmFtZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChpdGVtLmFkZF9waWMgJiYgY29tYmluYXRpb24uaW5jbHVkZXModmFsKSkgewogICAgICAgICAgICBjb25zdCBwaWNJdGVtID0gaXRlbS5kZXRhaWwuZmluZCgoZSkgPT4gY29tYmluYXRpb24uaW5jbHVkZXMoZS52YWx1ZSkpOwogICAgICAgICAgICBpZiAocGljSXRlbSkgcm93LnBpYyA9IHBpY0l0ZW0ucGljOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHJldHVybiByb3c7CiAgICAgIH0pOwogICAgICByZXR1cm4gcm93czsKICAgIH0sCiAgICAvLyDliIfmjaLpu5jorqTpgInkuK3op4TmoLwKICAgIGNoYW5nZURlZmF1bHRTZWxlY3QoZSwgaW5kZXgpIHsKICAgICAgLy8g5LiA5Liq5byA5ZCvIOWFtuS7luWFs+mXrQogICAgICB0aGlzLm1hbnlGb3JtVmFsaWRhdGUubWFwKChpdGVtLCBpKSA9PiB7CiAgICAgICAgaWYgKGkgIT09IGluZGV4KSB7CiAgICAgICAgICBpdGVtLmlzX2RlZmF1bHRfc2VsZWN0ID0gMDsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBpZiAoZSkgdGhpcy5tYW55Rm9ybVZhbGlkYXRlW2luZGV4XS5pc19zaG93ID0gMTsKICAgIH0sCiAgICAvLyDmlLnlj5jmmK/lkKbmmL7npLoKICAgIGNoYW5nZURlZmF1bHRTaG93KGluZGV4KSB7CiAgICAgIC8vIOWmguaenOm7mOiupOmAieS4reW8gOWQryDliJnkuI3lj6/pmpDol48KICAgICAgaWYgKHRoaXMubWFueUZvcm1WYWxpZGF0ZVtpbmRleF0uaXNfZGVmYXVsdF9zZWxlY3QgPT09IDEpIHsKICAgICAgICB0aGlzLm1hbnlGb3JtVmFsaWRhdGVbaW5kZXhdLmlzX3Nob3cgPSAxOwogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+m7mOiupOinhOagvOS4jeWPr+makOiXjycpOwogICAgICB9CiAgICB9LAogICAgLy8g55Sf5oiQ6KeE5qC857uE5ZCICiAgICBnZW5lcmF0ZUNvbWJpbmF0aW9ucyhhcnIsIHByZWZpeCA9IFtdKSB7CiAgICAgIGlmIChhcnIubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIFtwcmVmaXhdOwogICAgICB9CiAgICAgIGNvbnN0IFtmaXJzdCwgLi4ucmVzdF0gPSBhcnI7CiAgICAgIHJldHVybiBmaXJzdC5kZXRhaWwuZmxhdE1hcCgoZGV0YWlsKSA9PiB0aGlzLmdlbmVyYXRlQ29tYmluYXRpb25zKHJlc3QsIFsuLi5wcmVmaXgsIGRldGFpbC52YWx1ZV0pKTsKICAgIH0sCiAgICAvLyDmt7vliqDlsZ7mgKcKICAgIGNyZWF0ZUF0dHIobnVtLCBpZHgpIHsKICAgICAgaWYgKG51bSkgewogICAgICAgIC8vIOWIpOaWreaYr+WQpuWtmOWcqOWQjOagt+eGn+aCiQogICAgICAgIHZhciBpc0V4aXN0ID0gdGhpcy5hdHRyc1tpZHhdLmRldGFpbC5zb21lKChpdGVtKSA9PiBpdGVtLnZhbHVlID09PSBudW0pOwogICAgICAgIGlmIChpc0V4aXN0KSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfop4TmoLzlgLzlt7LlrZjlnKgnKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5hdHRyc1tpZHhdLmRldGFpbC5wdXNoKHsgdmFsdWU6IG51bSwgcGljOiAnJyB9KTsKICAgICAgICBpZiAodGhpcy5tYW55Rm9ybVZhbGlkYXRlLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5hZGRPbmVBdHRyKHRoaXMuYXR0cnNbaWR4XS52YWx1ZSwgbnVtKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5nZW5lcmF0ZUF0dHIodGhpcy5hdHRycyk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLiRyZWZzLnNwZWNTdG9jay4kcmVmc1sncG9wb3ZlclJlZl8nICsgaWR4XVswXS5kb0Nsb3NlKCk7IC8v5YWz6Zet55qECiAgICAgICAgdGhpcy5jbGVhckF0dHIoKTsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIGlmICh0aGlzLiRyZWZzLnNwZWNTdG9jay4kcmVmc1sncG9wb3ZlclJlZl8nICsgaWR4XSkgewogICAgICAgICAgICAvL+mHjeeCueaYr+S7peS4i+S4pOWPpQogICAgICAgICAgICB0aGlzLiRyZWZzLnNwZWNTdG9jay4kcmVmc1sncG9wb3ZlclJlZl8nICsgaWR4XVswXS5kb1Nob3coKTsgLy/miZPlvIDnmoQKICAgICAgICAgICAgLy/ph43ngrnmmK/ku6XkuIrkuKTlj6UKICAgICAgICAgIH0KICAgICAgICB9LCAyMCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kcmVmcy5zcGVjU3RvY2suJHJlZnNbJ3BvcG92ZXJSZWZfJyArIGlkeF1bMF0uZG9DbG9zZSgpOyAvL+WFs+mXreeahAogICAgICB9CiAgICB9LAogICAgaGFuZGxlU2hvd1BvcChpbmRleCkgewogICAgICB0aGlzLiRyZWZzLnNwZWNTdG9jay4kcmVmc1snaW5wdXRSZWZfJyArIGluZGV4XVswXS5mb2N1cygpOwogICAgfSwKICAgIC8vIOWVhuWTgeWIhuexu++8mwogICAgZ29vZHNDYXRlZ29yeSgpIHsKICAgICAgY2FzY2FkZXJMaXN0QXBpKDEpCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgdGhpcy50cmVlU2VsZWN0ID0gcmVzLmRhdGE7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKHJlcykgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubXNnKTsKICAgICAgICB9KTsKICAgIH0sCiAgICAvLyDmlLnlj5jop4TmoLwKICAgIGNoYW5nZVNwZWMoKSB7CiAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmlzX3N1YiA9IFtdOwogICAgICBsZXQgaWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQ7CiAgICAgIGlmIChpZCkgewogICAgICAgIGNoZWNrQWN0aXZpdHlBcGkoaWQpCiAgICAgICAgICAudGhlbigocmVzKSA9PiB7fSkKICAgICAgICAgIC5jYXRjaCgocmVzKSA9PiB7CiAgICAgICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLnNwZWNfdHlwZSA9IHRoaXMuc3BlY190eXBlOwogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICAvLyDor6bmg4UKICAgIGdldEluZm8oKSB7CiAgICAgIHRoaXMuc3BpblNob3cgPSB0cnVlOwogICAgICBwcm9kdWN0SW5mb0FwaSh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpCiAgICAgICAgLnRoZW4oYXN5bmMgKHJlcykgPT4gewogICAgICAgICAgbGV0IGRhdGEgPSByZXMuZGF0YS5wcm9kdWN0SW5mbzsKICAgICAgICAgIHRoaXMuaW5mb0RhdGEoZGF0YSk7CiAgICAgICAgICB0aGlzLnNwaW5TaG93ID0gZmFsc2U7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKHJlcykgPT4gewogICAgICAgICAgdGhpcy5zcGluU2hvdyA9IGZhbHNlOwogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubXNnKTsKICAgICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVSZW1vdmUoaSkgewogICAgICB0aGlzLmltYWdlcy5zcGxpY2UoaSwgMSk7CiAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLnNsaWRlcl9pbWFnZS5zcGxpY2UoaSwgMSk7CiAgICAgIHRoaXMub25lRm9ybVZhbGlkYXRlWzBdLnBpYyA9IHRoaXMuZm9ybVZhbGlkYXRlLnNsaWRlcl9pbWFnZVswXTsKICAgIH0sCiAgICAvLyDlhbPpl63lm77niYfkuIrkvKDmqKHmgIHmoYYKICAgIGNoYW5nZUNhbmNlbChtc2cpIHsKICAgICAgdGhpcy5tb2RhbFBpYyA9IGZhbHNlOwogICAgfSwKICAgIC8vIOeCueWHu+WVhuWTgeWbvgogICAgbW9kYWxQaWNUYXAodGl0LCBwaWNUaXQgPSAnJywgaW5kZXggPSAwKSB7CiAgICAgIHRoaXMubW9kYWxQaWMgPSB0cnVlOwogICAgICB0aGlzLmlzQ2hvaWNlID0gdGl0ID09PSAnZGFuJyA/ICfljZXpgIknIDogJ+WkmumAiSc7CiAgICAgIHRoaXMucGljVGl0ID0gcGljVGl0OwogICAgICB0aGlzLnRhYmxlSW5kZXggPSBpbmRleDsKICAgIH0sCiAgICAvLyDojrflj5bljZXlvKDlm77niYfkv6Hmga8KICAgIGdldFBpYyhwYykgewogICAgICBzd2l0Y2ggKHRoaXMucGljVGl0KSB7CiAgICAgICAgY2FzZSAnZGFuRnJvbSc6CiAgICAgICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5pbWFnZSA9IHBjLmF0dF9kaXI7CiAgICAgICAgICBpZiAoIXRoaXMuJHJvdXRlLnBhcmFtcy5pZCkgewogICAgICAgICAgICBpZiAodGhpcy5mb3JtVmFsaWRhdGUuc3BlY190eXBlID09PSAwKSB7CiAgICAgICAgICAgICAgdGhpcy5vbmVGb3JtVmFsaWRhdGVbMF0ucGljID0gcGMuYXR0X2RpcjsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLm1hbnlGb3JtVmFsaWRhdGUubWFwKChpdGVtKSA9PiB7CiAgICAgICAgICAgICAgICBpdGVtLnBpYyA9IHBjLmF0dF9kaXI7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdGhpcy5vbmVGb3JtQmF0Y2hbMF0ucGljID0gcGMuYXR0X2RpcjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnZGFuVGFibGUnOgogICAgICAgICAgdGhpcy5vbmVGb3JtVmFsaWRhdGVbdGhpcy50YWJsZUluZGV4XS5waWMgPSBwYy5hdHRfZGlyOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnZHVvcGknOgogICAgICAgICAgdGhpcy5vbmVGb3JtQmF0Y2hbdGhpcy50YWJsZUluZGV4XS5waWMgPSBwYy5hdHRfZGlyOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAncmVjb21tZW5kX2ltYWdlJzoKICAgICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLnJlY29tbWVuZF9pbWFnZSA9IHBjLmF0dF9kaXI7CiAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgaWYgKHRoaXMubWFueUZvcm1WYWxpZGF0ZS5sZW5ndGgpIHRoaXMubWFueUZvcm1WYWxpZGF0ZVt0aGlzLnRhYmxlSW5kZXhdLnBpYyA9IHBjLmF0dF9kaXI7CiAgICAgIH0KICAgICAgdGhpcy5tb2RhbFBpYyA9IGZhbHNlOwogICAgfSwKICAgIGRlbGV0ZVJvdyhpbmRleCkgewogICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5wYXJhbXNfbGlzdC5zcGxpY2UoaW5kZXgsIDEpOwogICAgfSwKICAgIC8vIOiOt+WPluWkmuW8oOWbvuS/oeaBrwogICAgZ2V0UGljRChwYykgewogICAgICB0aGlzLmltYWdlcyA9IHBjOwogICAgICB0aGlzLmltYWdlcy5tYXAoKGl0ZW0pID0+IHsKICAgICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5zbGlkZXJfaW1hZ2UucHVzaChpdGVtLmF0dF9kaXIpOwogICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLnNsaWRlcl9pbWFnZSA9IHRoaXMuZm9ybVZhbGlkYXRlLnNsaWRlcl9pbWFnZS5zcGxpY2UoMCwgMTApOwogICAgICB9KTsKICAgICAgdGhpcy5vbmVGb3JtVmFsaWRhdGVbMF0ucGljID0gdGhpcy5mb3JtVmFsaWRhdGUuc2xpZGVyX2ltYWdlWzBdOwogICAgICB0aGlzLm1vZGFsUGljID0gZmFsc2U7CiAgICB9LAogICAgLy8g5o+Q5LqkCiAgICBoYW5kbGVTdWJtaXQobmFtZSkgewogICAgICB0aGlzLiRyZWZzW25hbWVdLnZhbGlkYXRlKCh2YWxpZCkgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGUudHlwZSA9IHRoaXMudHlwZTsKICAgICAgICAgIGxldCBhcnIgPSB0aGlzLmZvcm1WYWxpZGF0ZS5zcGVjX3R5cGUgPT09IDAgPyB0aGlzLm9uZUZvcm1WYWxpZGF0ZSA6IHRoaXMubWFueUZvcm1WYWxpZGF0ZTsKICAgICAgICAgIGxldCBpdGVtID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhcnIpKTsKICAgICAgICAgIGlmICh0aGlzLmZvcm1WYWxpZGF0ZS5zcGVjX3R5cGUgPT09IDEpIHsKICAgICAgICAgICAgaWYgKGl0ZW0ubGVuZ3RoIDwgMikgcmV0dXJuIHRoaXMuJG1lc3NhZ2Uud2FybmluZygn5ZWG5ZOB6KeE5qC8LeinhOagvOaVsOmHj+acgOWwkTHkuKonKTsKICAgICAgICAgICAgLy8g5Yig6Zmk56ys5LiA6aG5CiAgICAgICAgICAgIGl0ZW0uc2hpZnQoKTsKICAgICAgICAgIH0KICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoaXRlbVtpXS5zdG9jayA+IDEwMDAwMDApIHsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign6KeE5qC85bqT5a2YLeW6k+WtmOi2heWHuuezu+e7n+iMg+WbtCgxMDAwMDAwKScpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAodGhpcy5mb3JtVmFsaWRhdGUuaXNfc3ViWzBdID09PSAxKSB7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIGlmIChpdGVtW2ldLmJyb2tlcmFnZSA9PT0gbnVsbCB8fCBpdGVtW2ldLmJyb2tlcmFnZV90d28gPT09IG51bGwpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCfokKXplIDorr7nva4tIOS4gOS6jOe6p+i/lOS9o+S4jeiDveS4uuepuicpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgaWYgKGl0ZW1baV0udmlwX3ByaWNlID09PSBudWxsKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign6JCl6ZSA6K6+572uLeS8muWRmOS7t+S4jeiDveS4uuepuicpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKHRoaXMuZm9ybVZhbGlkYXRlLmlzX3N1Yi5sZW5ndGggPT09IDIpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgaWYgKGl0ZW1baV0uYnJva2VyYWdlID09PSBudWxsIHx8IGl0ZW1baV0uYnJva2VyYWdlX3R3byA9PT0gbnVsbCB8fCBpdGVtW2ldLnZpcF9wcmljZSA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+iQpemUgOiuvue9ri0g5LiA5LqM57qn6L+U5L2j5ZKM5Lya5ZGY5Lu35LiN6IO95Li656m6Jyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAodGhpcy5mb3JtVmFsaWRhdGUuZnJlaWdodCA9PSAzICYmICF0aGlzLmZvcm1WYWxpZGF0ZS50ZW1wX2lkKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+WVhuWTgeS/oeaBry3ov5DotLnmqKHmnb/kuI3og73kuLrnqbonKTsKICAgICAgICAgIH0KICAgICAgICAgIGxldCBhY3RpdmVJZHMgPSBbXTsKICAgICAgICAgIHRoaXMuZGF0YUxhYmVsLmZvckVhY2goKGl0ZW0pID0+IHsKICAgICAgICAgICAgYWN0aXZlSWRzLnB1c2goaXRlbS5pZCk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmxhYmVsX2lkID0gYWN0aXZlSWRzOwogICAgICAgICAgaWYgKHRoaXMub3BlblN1YmltaXQpIHJldHVybjsKICAgICAgICAgIHRoaXMub3BlblN1YmltaXQgPSB0cnVlOwogICAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGUuZGVzY3JpcHRpb24gPSBmb3JtYXRSaWNoVGV4dCh0aGlzLmNvbnRlbnQpOwogICAgICAgICAgaWYgKHRoaXMuZm9ybVZhbGlkYXRlLnNwZWNfdHlwZSA9PT0gMCkgewogICAgICAgICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5hdHRycyA9IGl0ZW07CiAgICAgICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmhlYWRlciA9IFtdOwogICAgICAgICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5pdGVtcyA9IFtdOwogICAgICAgICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5pc19jb3B5ID0gMDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLml0ZW1zID0gdGhpcy5hdHRyczsKICAgICAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGUuYXR0cnMgPSBpdGVtOwogICAgICAgICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5pc19jb3B5ID0gMTsKICAgICAgICAgIH0KICAgICAgICAgIHByb2R1Y3RBZGRBcGkodGhpcy5mb3JtVmFsaWRhdGUpCiAgICAgICAgICAgIC50aGVuKGFzeW5jIChyZXMpID0+IHsKICAgICAgICAgICAgICB0aGlzLm9wZW5TdWJpbWl0ID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHJlcy5tc2cpOwogICAgICAgICAgICAgIGlmICh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQgPT09ICcwJykgewogICAgICAgICAgICAgICAgY2FjaGVEZWxldGUoKS5jYXRjaCgoZXJyKSA9PiB7CiAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoZXJyLm1zZyk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLm9wZW5TdWJpbWl0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6IHRoaXMuJHJvdXRlUHJvU3RyICsgJy9wcm9kdWN0L3Byb2R1Y3RfbGlzdCcgfSk7CiAgICAgICAgICAgICAgfSwgNTAwKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmNhdGNoKChyZXMpID0+IHsKICAgICAgICAgICAgICBzZXRUaW1lb3V0KChlKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLm9wZW5TdWJpbWl0ID0gZmFsc2U7CiAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubXNnKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICghdGhpcy5mb3JtVmFsaWRhdGUuc3RvcmVfbmFtZSkgewogICAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfllYblk4Hkv6Hmga8t5ZWG5ZOB5ZCN56ew5LiN6IO95Li656m6Jyk7CiAgICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLmZvcm1WYWxpZGF0ZS5jYXRlX2lkLmxlbmd0aCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfllYblk4Hkv6Hmga8t5ZWG5ZOB5YiG57G75LiN6IO95Li656m6Jyk7CiAgICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLmZvcm1WYWxpZGF0ZS51bml0X25hbWUpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2Uud2FybmluZygn5ZWG5ZOB5L+h5oGvLeWVhuWTgeWNleS9jeS4jeiDveS4uuepuicpOwogICAgICAgICAgfSBlbHNlIGlmICghdGhpcy5mb3JtVmFsaWRhdGUuc2xpZGVyX2ltYWdlLmxlbmd0aCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfllYblk4Hkv6Hmga8t5ZWG5ZOB6L2u5pKt5Zu+5LiN6IO95Li656m6Jyk7CiAgICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLmZvcm1WYWxpZGF0ZS5sb2dpc3RpY3MubGVuZ3RoICYmICF0aGlzLmZvcm1WYWxpZGF0ZS52aXJ0dWFsX3R5cGUpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2Uud2FybmluZygn54mp5rWB6K6+572uLeiHs+WwkemAieaLqeS4gOenjeeJqea1geaWueW8jycpOwogICAgICAgICAgfSBlbHNlIGlmICghdGhpcy5mb3JtVmFsaWRhdGUudGVtcF9pZCAmJiB0aGlzLmZvcm1WYWxpZGF0ZS5mcmVpZ2h0ID09IDMpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2Uud2FybmluZygn5ZWG5ZOB5L+h5oGvLei/kOi0ueaooeadv+S4jeiDveS4uuepuicpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgY2hhbmdlVGVtcGxhdGUobXNnKSB7CiAgICAgIHRoaXMudGVtcGxhdGUgPSBtc2c7CiAgICB9LAogICAgLy8g6KGo5Y2V6aqM6K+BCiAgICB2YWxpZGF0ZShwcm9wLCBzdGF0dXMsIGVycm9yKSB7CiAgICAgIGlmIChzdGF0dXMgPT09IGZhbHNlKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKGVycm9yKTsKICAgICAgfQogICAgfSwKICAgIC8vIOenu+WKqAogICAgaGFuZGxlRHJhZ1N0YXJ0KGUsIGl0ZW0pIHsKICAgICAgdGhpcy5kcmFnZ2luZyA9IGl0ZW07CiAgICB9LAogICAgaGFuZGxlRHJhZ0VuZChlLCBpdGVtKSB7CiAgICAgIHRoaXMuZHJhZ2dpbmcgPSBudWxsOwogICAgfSwKICAgIGhhbmRsZURyYWdPdmVyKGUpIHsKICAgICAgZS5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9ICdtb3ZlJzsKICAgIH0sCiAgICBoYW5kbGVEcmFnRW50ZXIoZSwgaXRlbSkgewogICAgICBlLmRhdGFUcmFuc2Zlci5lZmZlY3RBbGxvd2VkID0gJ21vdmUnOwogICAgICBpZiAoaXRlbSA9PT0gdGhpcy5kcmFnZ2luZykgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBjb25zdCBuZXdJdGVtcyA9IFsuLi50aGlzLmZvcm1WYWxpZGF0ZS5zbGlkZXJfaW1hZ2VdOwogICAgICBjb25zdCBzcmMgPSBuZXdJdGVtcy5pbmRleE9mKHRoaXMuZHJhZ2dpbmcpOwogICAgICBjb25zdCBkc3QgPSBuZXdJdGVtcy5pbmRleE9mKGl0ZW0pOwogICAgICBuZXdJdGVtcy5zcGxpY2UoZHN0LCAwLCAuLi5uZXdJdGVtcy5zcGxpY2Uoc3JjLCAxKSk7CiAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLnNsaWRlcl9pbWFnZSA9IG5ld0l0ZW1zOwogICAgfSwKICAgIC8v5a+56LGh5pWw57uE5Y676YeN77ybCiAgICB1bmlxdWUoYXJyKSB7CiAgICAgIGNvbnN0IHJlcyA9IG5ldyBNYXAoKTsKICAgICAgcmV0dXJuIGFyci5maWx0ZXIoKGFycikgPT4gIXJlcy5oYXMoYXJyLnByb2R1Y3RfaWQpICYmIHJlcy5zZXQoYXJyLnByb2R1Y3RfaWQsIDEpKTsKICAgIH0sCiAgICAvLyDllYblk4FpZAogICAgZ2V0UHJvZHVjdElkKGRhdGEpIHsKICAgICAgdGhpcy5nb29kc19tb2RhbHMgPSBmYWxzZTsKICAgICAgdGhpcy5mb3JtVmFsaWRhdGUucmVjb21tZW5kX2xpc3QgPSB0aGlzLnVuaXF1ZSh0aGlzLmZvcm1WYWxpZGF0ZS5yZWNvbW1lbmRfbGlzdC5jb25jYXQoZGF0YSkpOwogICAgfSwKICAgIC8vIOmAieaLqeaOqOiNkOWVhuWTgQogICAgY2hhbmdlR29vZHMoKSB7CiAgICAgIHRoaXMuZ29vZHNfbW9kYWxzID0gdHJ1ZTsKICAgICAgdGhpcy4kcmVmcy5nb29kc2xpc3QuZ2V0TGlzdCgpOwogICAgICB0aGlzLiRyZWZzLmdvb2RzbGlzdC5nb29kc0NhdGVnb3J5KCk7CiAgICB9LAogICAgLy8g6YCJ5oup55So5oi35qCH562+CiAgICBhY3RpdmVEYXRhKGRhdGFMYWJlbCkgewogICAgICB0aGlzLmxhYmVsU2hvdyA9IGZhbHNlOwogICAgICB0aGlzLmRhdGFMYWJlbCA9IGRhdGFMYWJlbDsKICAgIH0sCiAgICAvLyDpgInmi6nllYblk4HmoIfnrb4KICAgIGFjdGl2ZUxhYmVsKGRhdGEpIHsKICAgICAgdGhpcy50YWdTaG93ID0gZmFsc2U7CiAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmxhYmVsX2xpc3QgPSBBcnJheS5mcm9tKG5ldyBTZXQoZGF0YSkpOwogICAgfSwKICAgIC8vIOagh+etvuW8ueeql+WFs+mXrQogICAgbGFiZWxDbG9zZSgpIHsKICAgICAgdGhpcy5sYWJlbFNob3cgPSBmYWxzZTsKICAgICAgdGhpcy50YWdTaG93ID0gZmFsc2U7CiAgICB9LAogICAgLy8g5Yig6Zmk55So5oi35qCH562+CiAgICBjbG9zZUxhYmVsKGxhYmVsKSB7CiAgICAgIGxldCBpbmRleCA9IHRoaXMuZGF0YUxhYmVsLmluZGV4T2YodGhpcy5kYXRhTGFiZWwuZmlsdGVyKChkKSA9PiBkLmlkID09IGxhYmVsLmlkKVswXSk7CiAgICAgIHRoaXMuZGF0YUxhYmVsLnNwbGljZShpbmRleCwgMSk7CiAgICB9LAogICAgLy8g5omT5byA6YCJ5oup55So5oi35qCH562+CiAgICBvcGVuTGFiZWwocm93KSB7CiAgICAgIHRoaXMubGFiZWxTaG93ID0gdHJ1ZTsKICAgIH0sCiAgICBoYW5kbGVSZW1vdmVSZWNvbW1lbmQoaSkgewogICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5yZWNvbW1lbmRfbGlzdC5zcGxpY2UoaSwgMSk7CiAgICB9LAogICAgLy8g5omT5byA55qE6JCl6ZSA5rS75Yqo5qCH562+CiAgICB3YXRjaEFjdGl2aXR5KCkgewogICAgICBsZXQgbWFya2V0aW5nID0gW107CiAgICAgIC8vIOS9v+eUqOWvueixoeaYoOWwhOS8mOWMluadg+mZkOWIpOaWremAu+i+kQogICAgICBjb25zdCBwZXJtaXNzaW9uTWFwID0gewogICAgICAgIOm7mOiupDogdHJ1ZSwKICAgICAgICDnp5LmnYA6ICdzZWNraWxsJywKICAgICAgICDnoI3ku7c6ICdiYXJnYWluJywKICAgICAgICDmi7zlm6I6ICdjb21iaW5hdGlvbicsCiAgICAgIH07CiAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmFjdGl2aXR5LmZvckVhY2goKGVsKSA9PiB7CiAgICAgICAgaWYgKHBlcm1pc3Npb25NYXBbZWxdID09PSB0cnVlIHx8IChwZXJtaXNzaW9uTWFwW2VsXSAmJiBjaGVja0FycmF5KHBlcm1pc3Npb25NYXBbZWxdKSkpIHsKICAgICAgICAgIG1hcmtldGluZy5wdXNoKGVsKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5hY3Rpdml0eSA9IG1hcmtldGluZzsKICAgIH0sCiAgfSwKfTsK"},null]}