{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\product\\productAttr\\addAttr.vue?vue&type=style&index=0&id=bde54da2&lang=scss&scoped=true","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\product\\productAttr\\addAttr.vue","mtime":1740967163760},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\css-loader\\index.js","mtime":1753254259822},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1753254262918},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\postcss-loader\\src\\index.js","mtime":1753254258547},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1753254255270},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5ydWxlc0JveCB7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIGZsZXgtd3JhcDogd3JhcDsKfQouYXR0ckZyb20gewogIDo6di1kZWVwIC5pdnUtZm9ybS1pdGVtIHsKICAgIG1hcmdpbi1ib3R0b206IDBweCAhaW1wb3J0YW50OwogIH0KfQoubm9Gb3JtIHsKICBtYXJnaW4tbGVmdDogMTJweDsKfQouYWRkIHsKICBtYXJnaW4tbGVmdDogMTMycHg7Cn0KLmRyYWcgewogIGN1cnNvcjogbW92ZTsKfQouc3BlYyB7CiAgZGlzcGxheTogYmxvY2s7CiAgbWFyZ2luOiA1cHggMDsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgLmVsLWljb24tZXJyb3IgewogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgZGlzcGxheTogbm9uZTsKICAgIHJpZ2h0OiAtM3B4OwogICAgdG9wOiAtM3B4OwogICAgei1pbmRleDogOTsKICB9Cn0KLnNwZWM6aG92ZXIgewogIC5lbC1pY29uLWVycm9yIHsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgei1pbmRleDogOTk5OwogICAgY3Vyc29yOiBwb2ludGVyOwogIH0KfQoubW92ZS1pY29uIHsKICB3aWR0aDogMzBweDsKICBjdXJzb3I6IG1vdmU7CiAgbWFyZ2luLXJpZ2h0OiAxMHB4Owp9Ci5tb3ZlLWljb24gLmljb25kcmFnMiB7CiAgZm9udC1zaXplOiAyNnB4OwogIGNvbG9yOiAjYmJiOwp9Ci5zcGVjaWZpY2F0aW9ucyB7CiAgLnNwZWNpZmljYXRpb25zLWl0ZW06aG92ZXIgewogICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tcHJldi1iZy1tZW51LWhvdmVyLWJhLWNvbG9yKTsKICB9CiAgLnNwZWNpZmljYXRpb25zLWl0ZW06aG92ZXIgLmRlbCB7CiAgICBkaXNwbGF5OiBibG9jazsKICB9CiAgLnNwZWNpZmljYXRpb25zLWl0ZW06bGFzdC1jaGlsZCB7CiAgICBtYXJnaW4tYm90dG9tOiAxNHB4OwogIH0KICAuc3BlY2lmaWNhdGlvbnMtaXRlbSB7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIHBhZGRpbmc6IDIwcHggMTVweDsKICAgIHRyYW5zaXRpb246IGFsbCAwLjFzOwogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZhZmFmYTsKICAgIG1hcmdpbi1ib3R0b206IDEwcHg7CiAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICAuZGVsIHsKICAgICAgZGlzcGxheTogbm9uZTsKICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICByaWdodDogMTVweDsKICAgICAgdG9wOiAxNXB4OwogICAgICBmb250LXNpemU6IDIycHg7CiAgICAgIGNvbG9yOiB2YXIoLS1wcmV2LWNvbG9yLXByaW1hcnkpOwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICB9CiAgICAuc3BlY2lmaWNhdGlvbnMtaXRlbS1ib3ggewogICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgIC5saW5lQm94IHsKICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgbGVmdDogMTNweDsKICAgICAgICB0b3A6IDI0cHg7CiAgICAgICAgd2lkdGg6IDMwcHg7CiAgICAgICAgaGVpZ2h0OiA0NXB4OwogICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDsKICAgICAgICBib3JkZXItbGVmdDogMXB4IHNvbGlkICNkY2RmZTY7CiAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNkY2RmZTY7CiAgICAgIH0KICAgICAgLnNwZWNpZmljYXRpb25zLWl0ZW0tbmFtZS1pbnB1dCB7CiAgICAgICAgd2lkdGg6IDIwMHB4OwogICAgICB9CiAgICB9CiAgfQogIC5ydWxlc0JveCB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZmxleC13cmFwOiB3cmFwOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIC5pdGVtIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZmxleC13cmFwOiB3cmFwOwogICAgfQogICAgLmFkZGZvbnQgewogICAgICBtYXJnaW4tdG9wOiA1cHg7CiAgICB9CiAgICA6OnYtZGVlcCAuZWwtcG9wb3ZlciB7CiAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgYm94LXNoYWRvdzogbm9uZTsKICAgICAgcGFkZGluZzogMDsKICAgICAgbWFyZ2luLXRvcDogNXB4OwogICAgICBsaW5lLWhlaWdodDogMS41OwogICAgfQogIH0KICAuYWRkZm9udCB7CiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICBmb250LXNpemU6IDEycHg7CiAgICBmb250LXdlaWdodDogNDAwOwogICAgY29sb3I6IHZhcigtLXByZXYtY29sb3ItcHJpbWFyeSk7CiAgICBtYXJnaW4tbGVmdDogMTRweDsKICAgIGN1cnNvcjogcG9pbnRlcjsKICB9Cn0K"},{"version":3,"sources":["addAttr.vue"],"names":[],"mappings":";AA6QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"addAttr.vue","sourceRoot":"src/pages/product/productAttr","sourcesContent":["<template>\n  <el-dialog :visible.sync=\"modal\" @closed=\"onCancel\" title=\"商品规格\" width=\"1000px\" v-loading=\"spinShow\">\n    <el-form\n      ref=\"formDynamic\"\n      :model=\"formDynamic\"\n      :rules=\"rules\"\n      class=\"attrFrom\"\n      label-width=\"120px\"\n      label-position=\"right\"\n      @submit.native.prevent\n    >\n      <el-row :gutter=\"24\">\n        <el-col :span=\"24\">\n          <el-col :span=\"8\">\n            <el-form-item label=\"规格模板名称：\" prop=\"rule_name\">\n              <el-input placeholder=\"请输入标题名称\" :maxlength=\"20\" v-model.trim=\"formDynamic.rule_name\" />\n            </el-form-item>\n          </el-col>\n        </el-col>\n        <el-col :span=\"23\" class=\"noForm\" :key=\"index\">\n          <el-form-item label=\"\">\n            <div class=\"specifications\">\n              <draggable group=\"specifications\" :list=\"formDynamic.spec\" handle=\".move-icon\" animation=\"300\">\n                <div class=\"specifications-item active\" v-for=\"(item, index) in formDynamic.spec\" :key=\"index\">\n                  <div class=\"move-icon\">\n                    <span class=\"iconfont icondrag2\"></span>\n                  </div>\n                  <i class=\"del el-icon-error\" @click=\"handleRemoveRole(index)\"></i>\n                  <div class=\"specifications-item-box\">\n                    <div class=\"lineBox\"></div>\n                    <div class=\"specifications-item-name mb18\">\n                      <el-input\n                        v-model=\"item.value\"\n                        placeholder=\"规格名称\"\n                        class=\"specifications-item-name-input\"\n                        maxlength=\"30\"\n                        show-word-limit\n                      ></el-input>\n                    </div>\n                    <div class=\"rulesBox ml30\">\n                      <draggable class=\"item\" :list=\"item.detail\" handle=\".drag\">\n                        <div v-for=\"(j, indexn) in item.detail\" :key=\"indexn\" class=\"mr10 spec drag\">\n                          <i class=\"el-icon-error\" @click=\"handleRemove2(item.detail, indexn)\"></i>\n\n                          <el-input\n                            style=\"width: 120px\"\n                            v-model=\"item.detail[indexn]\"\n                            placeholder=\"规格值\"\n                            maxlength=\"30\"\n                          >\n                            <template slot=\"prefix\">\n                              <span class=\"iconfont icondrag2\"></span>\n                            </template>\n                          </el-input>\n                        </div>\n                        <el-popover\n                          :ref=\"'popoverRef_' + index\"\n                          placement=\"\"\n                          width=\"210\"\n                          trigger=\"click\"\n                          @after-enter=\"handleShowPop(index)\"\n                        >\n                          <el-input\n                            :ref=\"'inputRef_' + index\"\n                            placeholder=\"请输入规格值\"\n                            v-model=\"item.detail.attrsVal\"\n                            @keyup.enter.native=\"createAttr(item.detail.attrsVal, index)\"\n                            maxlength=\"30\"\n                            show-word-limit\n                          >\n                          </el-input>\n                          <div class=\"addfont\" slot=\"reference\" type=\"text\" v-db-click>添加规格值</div>\n                        </el-popover>\n                      </draggable>\n                    </div>\n                  </div>\n                </div>\n              </draggable>\n              <el-button v-if=\"formDynamic.spec.length < 4\" v-db-click @click=\"handleAddRole()\">添加新规格</el-button>\n            </div>\n          </el-form-item>\n        </el-col>\n      </el-row>\n    </el-form>\n    <span slot=\"footer\" class=\"dialog-footer\">\n      <el-button v-db-click @click=\"onClose\">取消</el-button>\n      <el-button type=\"primary\" :loading=\"modal_loading\" v-db-click @click=\"handleSubmit('formDynamic')\"\n        >确定</el-button\n      >\n    </span>\n  </el-dialog>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport { ruleAddApi, ruleInfoApi } from '@/api/product';\nimport vuedraggable from 'vuedraggable';\nexport default {\n  name: 'addAttr',\n  components: {\n    draggable: vuedraggable,\n  },\n  data() {\n    return {\n      spinShow: false,\n      modal_loading: false,\n      grid: {\n        xl: 3,\n        lg: 3,\n        md: 12,\n        sm: 24,\n        xs: 24,\n      },\n      modal: false,\n      index: 1,\n      rules: {\n        rule_name: [{ required: true, message: '请输入规格名称', trigger: 'blur' }],\n      },\n      formDynamic: {\n        rule_name: '',\n        spec: [],\n      },\n      attrsName: '',\n      attrsVal: '',\n      formDynamicNameData: [],\n      isBtn: false,\n      formDynamicName: [],\n      results: [],\n      result: [],\n      ids: 0,\n    };\n  },\n  computed: {},\n  methods: {\n    handleShowPop(index) {\n      this.$refs['inputRef_' + index][0].focus();\n    },\n    // 删除规格\n    handleRemoveRole(index) {\n      this.formDynamic.spec.splice(index, 1);\n      if (!this.formDynamic.spec.length) {\n        this.formDynamic.spec = [];\n      }\n    },\n    handleAddRole() {\n      let data = {\n        value: this.formDynamic.attrsName,\n        detail: [],\n      };\n      this.formDynamic.spec.push(data);\n    },\n    onCancel() {\n      this.ids = 0;\n      this.clear();\n    },\n    onClose() {\n      this.ids = 0;\n      this.clear();\n      this.modal = false;\n    },\n    // 添加按钮\n    addBtn() {\n      this.isBtn = true;\n    },\n    // 详情\n    getIofo(row) {\n      this.spinShow = true;\n      this.ids = row.id;\n      ruleInfoApi(row.id)\n        .then((res) => {\n          this.formDynamic = res.data.info;\n          this.spinShow = false;\n        })\n        .catch((res) => {\n          this.spinShow = false;\n          this.$message.error(res.msg);\n        });\n    },\n    // 提交\n    handleSubmit(name) {\n      this.$refs[name].validate((valid) => {\n        if (valid) {\n          if (this.formDynamic.spec.length === 0) {\n            return this.$message.warning('请至少添加一条商品规格！');\n          }\n          this.modal_loading = true;\n          setTimeout(() => {\n            ruleAddApi(this.formDynamic, this.ids)\n              .then((res) => {\n                this.$message.success(res.msg);\n                setTimeout(() => {\n                  this.modal = false;\n                  this.modal_loading = false;\n                }, 500);\n                setTimeout(() => {\n                  this.$emit('getList');\n                  this.clear();\n                }, 600);\n              })\n              .catch((res) => {\n                this.modal_loading = false;\n                this.$message.error(res.msg);\n              });\n          }, 1200);\n        } else {\n          return false;\n        }\n      });\n    },\n    clear() {\n      this.$refs['formDynamic'].resetFields();\n      this.formDynamic.spec = [];\n      this.isBtn = false;\n      this.attrsName = '';\n      this.attrsVal = '';\n      this.ids = 0;\n    },\n    // 取消\n    offAttrName() {\n      this.isBtn = false;\n    },\n    // 删除\n    handleRemove(index) {\n      this.formDynamic.spec.splice(index, 1);\n    },\n    // 删除属性\n    handleRemove2(item, index) {\n      item.splice(index, 1);\n    },\n    // 添加规则名称\n    createAttrName() {\n      if (this.attrsName && this.attrsVal) {\n        let data = {\n          value: this.attrsName,\n          detail: [this.attrsVal],\n        };\n        this.formDynamic.spec.push(data);\n        var hash = {};\n        this.formDynamic.spec = this.formDynamic.spec.reduce(function (item, next) {\n          /* eslint-disable */\n          hash[next.value] ? '' : (hash[next.value] = true && item.push(next));\n          return item;\n        }, []);\n        this.attrsName = '';\n        this.attrsVal = '';\n        this.isBtn = false;\n      } else {\n        this.$message.warning('请添加规格名称或规格值');\n      }\n    },\n    // 添加属性\n    createAttr(num, idx) {\n      if (num) {\n        this.formDynamic.spec[idx].detail.push(num);\n        var hash = {};\n        this.formDynamic.spec[idx].detail = this.formDynamic.spec[idx].detail.reduce(function (item, next) {\n          /* eslint-disable */\n          hash[next] ? '' : (hash[next] = true && item.push(next));\n          return item;\n        }, []);\n      } else {\n        this.$message.warning('请添加属性');\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.rulesBox {\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n}\n.attrFrom {\n  ::v-deep .ivu-form-item {\n    margin-bottom: 0px !important;\n  }\n}\n.noForm {\n  margin-left: 12px;\n}\n.add {\n  margin-left: 132px;\n}\n.drag {\n  cursor: move;\n}\n.spec {\n  display: block;\n  margin: 5px 0;\n  position: relative;\n  .el-icon-error {\n    position: absolute;\n    display: none;\n    right: -3px;\n    top: -3px;\n    z-index: 9;\n  }\n}\n.spec:hover {\n  .el-icon-error {\n    display: block;\n    z-index: 999;\n    cursor: pointer;\n  }\n}\n.move-icon {\n  width: 30px;\n  cursor: move;\n  margin-right: 10px;\n}\n.move-icon .icondrag2 {\n  font-size: 26px;\n  color: #bbb;\n}\n.specifications {\n  .specifications-item:hover {\n    background-color: var(--prev-bg-menu-hover-ba-color);\n  }\n  .specifications-item:hover .del {\n    display: block;\n  }\n  .specifications-item:last-child {\n    margin-bottom: 14px;\n  }\n  .specifications-item {\n    position: relative;\n    display: flex;\n    align-items: center;\n    padding: 20px 15px;\n    transition: all 0.1s;\n    background-color: #fafafa;\n    margin-bottom: 10px;\n    border-radius: 4px;\n    .del {\n      display: none;\n      position: absolute;\n      right: 15px;\n      top: 15px;\n      font-size: 22px;\n      color: var(--prev-color-primary);\n      cursor: pointer;\n    }\n    .specifications-item-box {\n      position: relative;\n      .lineBox {\n        position: absolute;\n        left: 13px;\n        top: 24px;\n        width: 30px;\n        height: 45px;\n        border-radius: 6px;\n        border-left: 1px solid #dcdfe6;\n        border-bottom: 1px solid #dcdfe6;\n      }\n      .specifications-item-name-input {\n        width: 200px;\n      }\n    }\n  }\n  .rulesBox {\n    display: flex;\n    flex-wrap: wrap;\n    align-items: center;\n    .item {\n      display: flex;\n      flex-wrap: wrap;\n    }\n    .addfont {\n      margin-top: 5px;\n    }\n    ::v-deep .el-popover {\n      border: none;\n      box-shadow: none;\n      padding: 0;\n      margin-top: 5px;\n      line-height: 1.5;\n    }\n  }\n  .addfont {\n    display: inline-block;\n    font-size: 12px;\n    font-weight: 400;\n    color: var(--prev-color-primary);\n    margin-left: 14px;\n    cursor: pointer;\n  }\n}\n</style>\n"]}]}