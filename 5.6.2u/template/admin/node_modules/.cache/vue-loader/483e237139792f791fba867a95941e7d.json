{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\marketing\\lottery\\lotteryList.vue?vue&type=style&index=0&id=46f996f8&scoped=true&lang=scss","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\marketing\\lottery\\lotteryList.vue","mtime":1742263868087},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\css-loader\\index.js","mtime":1753254259822},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1753254262918},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\postcss-loader\\src\\index.js","mtime":1753254258547},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1753254255270},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci50YWJCb3hfaW1nIHsKICB3aWR0aDogMzZweDsKICBoZWlnaHQ6IDM2cHg7CiAgYm9yZGVyLXJhZGl1czogNHB4OwogIGN1cnNvcjogcG9pbnRlcjsKCiAgaW1nIHsKICAgIHdpZHRoOiAxMDAlOwogICAgaGVpZ2h0OiAxMDAlOwogIH0KfQoKLnByaXplIHsKICBkaXNwbGF5OiBmbGV4OwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7Cn0KCmJvZHkgLmVsLXRhYmxlIDo6LXdlYmtpdC1zY3JvbGxiYXIgewogIC8vIHotaW5kZXg6IDExMTExOwogIC8vIHdpZHRoOiA2cHg7CiAgLy8gaGVpZ2h0OiA2cHg7CiAgLy8gYmFja2dyb3VuZC1jb2xvcjogI0Y1RjVGNTsKfQoKLnByaXplIGltZyB7CiAgd2lkdGg6IDM2cHg7CiAgaGVpZ2h0OiAzNnB4OwogIGJvcmRlci1yYWRpdXM6IDRweDsKICBjdXJzb3I6IHBvaW50ZXI7CiAgbWFyZ2luLXJpZ2h0OiA1cHg7Cn0KCi50cmlwcyB7CiAgY29sb3I6ICNjY2M7Cn0KLnBpY0JveCB7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIGN1cnNvcjogcG9pbnRlcjsKCiAgLnVwTG9hZCB7CiAgICB3aWR0aDogNThweDsKICAgIGhlaWdodDogNThweDsKICAgIGxpbmUtaGVpZ2h0OiA1OHB4OwogICAgYm9yZGVyOiAxcHggZG90dGVkIHJnYmEoMCwgMCwgMCwgMC4xKTsKICAgIGJvcmRlci1yYWRpdXM6IDRweDsKICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wMik7CiAgfQoKICAucGljdHJ1ZSB7CiAgICB3aWR0aDogNjBweDsKICAgIGhlaWdodDogNjBweDsKICAgIGJvcmRlcjogMXB4IGRvdHRlZCByZ2JhKDAsIDAsIDAsIDAuMSk7CiAgICBtYXJnaW4tcmlnaHQ6IDEwcHg7CgogICAgaW1nIHsKICAgICAgd2lkdGg6IDEwMCU7CiAgICAgIGhlaWdodDogMTAwJTsKICAgIH0KICB9CgogIC5pY29uZm9udCB7CiAgICBjb2xvcjogIzg5ODk4OTsKICB9Cn0K"},{"version":3,"sources":["lotteryList.vue"],"names":[],"mappings":";AAibA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"lotteryList.vue","sourceRoot":"src/pages/marketing/lottery","sourcesContent":["<template>\n  <div>\n    <el-card :bordered=\"false\" shadow=\"never\" class=\"ivu-mt\" :body-style=\"{ padding: '20px 20px 0px' }\">\n      <el-form\n        ref=\"tableFrom\"\n        :model=\"tableFrom\"\n        :label-width=\"labelWidth\"\n        :label-position=\"labelPosition\"\n        label-position=\"right\"\n        inline\n        @submit.native.prevent\n      >\n        <el-form-item label=\"活动时间：\">\n          <el-date-picker\n            v-model=\"timeVal\"\n            type=\"daterange\"\n            :editable=\"false\"\n            @change=\"onchangeTime\"\n            format=\"yyyy/MM/dd\"\n            value-format=\"yyyy/MM/dd\"\n            start-placeholder=\"开始日期\"\n            end-placeholder=\"结束日期\"\n            :picker-options=\"pickerOptions\"\n            style=\"width: 250px\"\n            class=\"mr20\"\n          ></el-date-picker>\n        </el-form-item>\n        <el-form-item label=\"活动状态：\">\n          <el-select\n            class=\"form_content_width\"\n            v-model=\"tableFrom.start\"\n            clearable\n            @change=\"userSearchs\"\n            placeholder=\"全部\"\n          >\n            <el-option label=\"全部\" value=\"\" />\n            <el-option label=\"未开始\" :value=\"0\" />\n            <el-option label=\"进行中\" :value=\"1\" />\n            <el-option label=\"已结束\" :value=\"2\" />\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"活动类型：\">\n          <el-select\n            class=\"form_content_width\"\n            v-model=\"tableFrom.factor\"\n            clearable\n            @change=\"userSearchs\"\n            placeholder=\"全部\"\n          >\n            <el-option label=\"全部\" value=\"\" />\n            <el-option label=\"积分抽取\" :value=\"1\" />\n            <el-option label=\"订单支付\" :value=\"3\" />\n            <el-option label=\"订单评价\" :value=\"4\" />\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"开启状态：\">\n          <el-select\n            class=\"form_content_width\"\n            v-model=\"tableFrom.status\"\n            clearable\n            @change=\"userSearchs\"\n            placeholder=\"全部\"\n          >\n            <el-option label=\"全部\" value=\"\" />\n            <el-option label=\"开启\" :value=\"1\" />\n            <el-option label=\"关闭\" :value=\"0\" />\n          </el-select>\n        </el-form-item>\n\n        <el-form-item label=\"搜索抽奖：\">\n          <el-input\n            class=\"form_content_width\"\n            placeholder=\"请输入活动名称\"\n            v-model=\"tableFrom.keyword\"\n            @change=\"userSearchs\"\n          />\n        </el-form-item>\n        <el-button type=\"primary\" v-db-click @click=\"userSearchs()\">搜索</el-button>\n      </el-form>\n    </el-card>\n    <el-card class=\"mt-20\" :bordered=\"false\" shadow=\"never\">\n      <el-button class=\"mb12\" type=\"primary\" v-db-click @click=\"openPage(0)\">创建抽奖活动</el-button>\n      <el-table :data=\"tableList\" v-loading=\"loading\" highlight-current-row no-userFrom-text=\"暂无数据\">\n        <el-table-column label=\"ID\" min-width=\"80\">\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.id }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"活动名称\" min-width=\"120\">\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.name }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"活动类型\" min-width=\"100\">\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.lottery_type }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"抽奖人数\" min-width=\"100\">\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.records_total_user }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"中奖人数\" min-width=\"100\">\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.records_wins_user }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"抽奖次数\" min-width=\"100\">\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.records_total_num }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"中奖次数\" min-width=\"100\">\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.records_wins_num }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"活动状态\" min-width=\"100\">\n          <template slot-scope=\"scope\">\n            <span>{{ scope.row.status_name }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"开启状态\" min-width=\"100\">\n          <template slot-scope=\"scope\">\n            <el-switch\n              class=\"defineSwitch\"\n              :active-value=\"1\"\n              :inactive-value=\"0\"\n              v-model=\"scope.row.status\"\n              :value=\"scope.row.status\"\n              @change=\"onchangeIsShow(scope.row)\"\n              size=\"large\"\n              active-text=\"开启\"\n              inactive-text=\"关闭\"\n            >\n            </el-switch>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"活动时间\" min-width=\"180\">\n          <template slot-scope=\"scope\">\n            <p>开始：{{ scope.row.start_time }}</p>\n            <p>结束：{{ scope.row.end_time }}</p>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"操作\" min-width=\"180\" fixed=\"right\">\n          <template slot-scope=\"scope\">\n            <a @click=\"edit(scope.row)\">编辑</a>\n            <el-divider direction=\"vertical\" />\n            <a @click=\"openPage(1, scope.row)\">抽奖记录</a>\n            <el-divider direction=\"vertical\" />\n            <template>\n              <el-dropdown @command=\"(command) => changeMenu(scope.row, command, scope.$index)\">\n                <span class=\"el-dropdown-link\">更多<i class=\"el-icon-arrow-down el-icon--right\"></i> </span>\n                <el-dropdown-menu slot=\"dropdown\">\n                  <!-- <el-dropdown-item command=\"1\">拉黑人员</el-dropdown-item>\n                    <el-dropdown-item command=\"2\">拉黑列表</el-dropdown-item> -->\n                  <el-dropdown-item command=\"3\">\n                    <span class=\"copy copy-data\" :data-clipboard-text=\"copyLink(scope.row)\">复制链接</span>\n                  </el-dropdown-item>\n                  <el-dropdown-item command=\"4\">删除抽奖</el-dropdown-item>\n                </el-dropdown-menu>\n              </el-dropdown>\n            </template>\n          </template>\n        </el-table-column>\n      </el-table>\n      <div class=\"acea-row row-right page\">\n        <pagination\n          v-if=\"total\"\n          :total=\"total\"\n          :page.sync=\"tableFrom.page\"\n          :limit.sync=\"tableFrom.limit\"\n          @pagination=\"getList\"\n        />\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport { lotteryList, lotteryStatus } from '@/api/lottery';\nimport { formatDate } from '@/utils/validate';\nimport { ruleShip, ruleMark } from './formRule/ruleShip';\nimport customerInfo from '@/components/customerInfo';\nimport ClipboardJS from 'clipboard';\nexport default {\n  name: 'lotteryList',\n  filters: {\n    formatDate(time) {\n      if (time !== 0) {\n        let time = new time(time * 1000);\n        return formatDate(time, 'yyyy-MM-dd hh:mm');\n      }\n    },\n  },\n  components: {\n    customerInfo,\n  },\n  data() {\n    return {\n      shipModel: false,\n      loading: false,\n      blackModel: false,\n      pickerOptions: this.$timeOptions,\n      locationList: [],\n      timeVal: [],\n      shipForm: {\n        id: '',\n        deliver_name: '',\n        deliver_number: null,\n      },\n      markForm: {\n        id: '',\n        mark: '',\n      },\n      ruleShip: ruleShip,\n      ruleMark: ruleMark,\n      fromList: {\n        title: '选择时间',\n        fromTxt: [\n          { text: '全部', val: '' },\n          { text: '今天', val: 'today' },\n          { text: '昨天', val: 'yesterday' },\n          { text: '最近7天', val: 'lately7' },\n          { text: '最近30天', val: 'lately30' },\n          { text: '本月', val: 'month' },\n          { text: '本年', val: 'year' },\n        ],\n      },\n      typeList: [\n        { text: '全部', val: '' },\n        { text: '未中奖', val: '1' },\n        { text: '积分', val: '2' },\n        { text: '余额', val: '3' },\n        { text: '红包', val: '4' },\n        { text: '优惠券', val: '5' },\n        { text: '商品', val: '6' },\n      ],\n      blackList: [],\n      loading2: false,\n      promoterShow: false,\n      tableList: [],\n      grid: {\n        xl: 7,\n        lg: 10,\n        md: 12,\n        sm: 24,\n        xs: 24,\n      },\n      tableFrom: {\n        keyword: '',\n        time: [],\n        page: 1,\n        limit: 15,\n        factor: '',\n        status: '',\n        start: '',\n      },\n      total: 0,\n      time: [],\n      modelType: 1,\n      lottery_id: '',\n      modelTitle: '',\n      orderData: {\n        id: 0,\n        mark: '',\n        pc_template_name: '',\n        pc_template_sku: '',\n      },\n      orderModel: false,\n      customerShow: false,\n      formInline: {\n        uid: 0,\n        image: '',\n      },\n      total2: 0,\n      receiveFrom: {\n        lottery_id: 0,\n        keyword: '',\n        page: 1,\n        limit: 15,\n      },\n    };\n  },\n  computed: {\n    ...mapState('layout', ['isMobile']),\n    labelWidth() {\n      return this.isMobile ? undefined : '80px';\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'left';\n    },\n  },\n  created() {\n    this.$nextTick(function () {\n      const clipboard = new ClipboardJS('.copy-data');\n      clipboard.on('success', () => {\n        console.log('11');\n        this.$message.success('复制成功');\n      });\n    });\n    this.getList();\n  },\n  methods: {\n    // 操作\n    changeMenu(row, name, index) {\n      console.log(row, name, index);\n      switch (name) {\n        case '1':\n          this.customer(row);\n          break;\n        case '3':\n          this.onCopy(row);\n          break;\n        case '4':\n          this.del(row, '删除活动', index);\n          break;\n      }\n    },\n    onCopy(row) {\n      this.$copyText(this.copyLink(row))\n        .then((message) => {\n          this.$message.success('复制成功');\n        })\n        .catch((err) => {\n          this.$message.error('复制失败');\n        });\n    },\n    copyLink(row) {\n      return `${window.location.origin}/pages/goods/lottery/grids/index?type=${row.factor}&lottery_id=${row.id}`;\n    },\n    customer(row) {\n      this.promoterShow = true;\n      this.formInline.lottery_id = row.id;\n    },\n    customerPle() {\n      this.customerShow = true;\n    },\n    // 选择人员\n    selectCustomer(e) {\n      console.log(e);\n      this.customerShow = false;\n      this.formInline.uid = e.uid;\n      this.formInline.image = e.image;\n      this.formInline.nickname = e.nickname;\n    },\n    edit(row) {\n      this.$router.push({\n        path: '/admin/marketing/lottery/create',\n        query: { lottery_id: row.id, type: row.type },\n      });\n    },\n    openPage(type, row) {\n      let url;\n      if (type === 1) {\n        url = `/admin/marketing/lottery/recording_list?id=${row.id}`;\n      } else {\n        url = `/admin/marketing/lottery/create`;\n      }\n      this.$router.push({\n        path: url,\n      });\n    },\n    // 具体日期\n    onchangeTime(e) {\n      this.time = e;\n      if (!e || !e[0]) {\n        this.tableFrom.time = [];\n      } else {\n        this.tableFrom.time = this.time[0] ? this.time.join('-') : '';\n      }\n      this.tableFrom.page = 1;\n      this.getList();\n    },\n    // 删除\n    del(row, tit, num) {\n      let delfromData = {\n        title: tit,\n        num: num,\n        url: `marketing/lottery/del/${row.id}`,\n        method: 'DELETE',\n        ids: '',\n      };\n      this.$modalSure(delfromData)\n        .then((res) => {\n          this.$message.success(res.msg);\n          this.tableList.splice(num, 1);\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 列表\n    getList() {\n      this.loading = true;\n      lotteryList(this.tableFrom)\n        .then(async (res) => {\n          let data = res.data;\n          this.tableList = data.list;\n          this.total = res.data.count;\n          this.loading = false;\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$message.error(res.msg);\n        });\n    },\n    // 修改是否显示\n    onchangeIsShow(row) {\n      let data = {\n        id: row.id,\n        status: row.status,\n      };\n      lotteryStatus(data)\n        .then(async (res) => {\n          this.$message.success(res.msg);\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 表格搜索\n    userSearchs() {\n      this.tableFrom.page = 1;\n      this.getList();\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.tabBox_img {\n  width: 36px;\n  height: 36px;\n  border-radius: 4px;\n  cursor: pointer;\n\n  img {\n    width: 100%;\n    height: 100%;\n  }\n}\n\n.prize {\n  display: flex;\n  align-items: center;\n}\n\nbody .el-table ::-webkit-scrollbar {\n  // z-index: 11111;\n  // width: 6px;\n  // height: 6px;\n  // background-color: #F5F5F5;\n}\n\n.prize img {\n  width: 36px;\n  height: 36px;\n  border-radius: 4px;\n  cursor: pointer;\n  margin-right: 5px;\n}\n\n.trips {\n  color: #ccc;\n}\n.picBox {\n  display: inline-block;\n  cursor: pointer;\n\n  .upLoad {\n    width: 58px;\n    height: 58px;\n    line-height: 58px;\n    border: 1px dotted rgba(0, 0, 0, 0.1);\n    border-radius: 4px;\n    background: rgba(0, 0, 0, 0.02);\n  }\n\n  .pictrue {\n    width: 60px;\n    height: 60px;\n    border: 1px dotted rgba(0, 0, 0, 0.1);\n    margin-right: 10px;\n\n    img {\n      width: 100%;\n      height: 100%;\n    }\n  }\n\n  .iconfont {\n    color: #898989;\n  }\n}\n</style>\n"]}]}