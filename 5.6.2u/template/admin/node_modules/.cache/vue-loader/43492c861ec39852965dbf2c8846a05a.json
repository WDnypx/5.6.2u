{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\finance\\billingRecords\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\finance\\billingRecords\\index.vue","mtime":1729039381090},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1753254258567},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBleHBvcnRFeGNlbCBmcm9tICdAL3V0aWxzL25ld1RvRXhjZWwuanMnOwppbXBvcnQgY29tbWlzc2lvbkRldGFpbHMgZnJvbSAnLi4vY29tcG9uZW50cy9jb21taXNzaW9uRGV0YWlscyc7CmltcG9ydCB7IGdldFJlY29yZCB9IGZyb20gJ0AvYXBpL3N0YXRpc3RpYy5qcyc7CmltcG9ydCB7IGdldEZsb3dMaXN0IH0gZnJvbSAnQC9hcGkvZmluYW5jZSc7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2JpbGwnLAogIGNvbXBvbmVudHM6IHsKICAgIGNvbW1pc3Npb25EZXRhaWxzLAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG1vZGFsczogZmFsc2UsCiAgICAgIHBpY2tlck9wdGlvbnM6IHRoaXMuJHRpbWVPcHRpb25zLAogICAgICBpZHM6ICcnLAogICAgICB0b3RhbDogMCwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIHRhYjogJ2RheScsCiAgICAgIG9yZGVyTGlzdDogWwogICAgICAgIHsKICAgICAgICAgIGlkOiAnMScsCiAgICAgICAgICBvcmRlcl9pZDogJzIwMCcsCiAgICAgICAgICBwYXlfcHJpY2U6ICcyMDAnLAogICAgICAgICAgc3RhdHVzOiAxLAogICAgICAgICAgcGhvbmU6ICcxMzAwMDAwMDAwMCcsCiAgICAgICAgICBhZGRyZXNzOiAnMTAwJywKICAgICAgICB9LAogICAgICBdLAogICAgICBmb3JtVmFsaWRhdGU6IHsKICAgICAgICBzdG9yZV9pZDogJycsCiAgICAgICAgdGltZTogJycsCiAgICAgICAgcGFnZTogMSwKICAgICAgICBsaW1pdDogMTUsCiAgICAgIH0sCiAgICAgIHRpbWVWYWw6IFtdLAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBsYWJlbFdpZHRoKCkgewogICAgICByZXR1cm4gdGhpcy5pc01vYmlsZSA/IHVuZGVmaW5lZCA6ICc4MHB4JzsKICAgIH0sCiAgICBsYWJlbFBvc2l0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5pc01vYmlsZSA/ICd0b3AnIDogJ3JpZ2h0JzsKICAgIH0sCiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5vbkNsaWNrVGFiKHRoaXMudGFiKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIG9uQ2xpY2tUYWIoKSB7CiAgICAgIHRoaXMuZ2V0TGlzdCgpOwogICAgfSwKICAgIHNlYXJjaCgpIHsKICAgICAgdGhpcy5nZXRMaXN0KCk7CiAgICB9LAogICAgZ2V0TGlzdCgpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgbGV0IGRhdGEgPSB7CiAgICAgICAgdHlwZTogdGhpcy50YWIsCiAgICAgICAgdGltZTogdGhpcy5mb3JtVmFsaWRhdGUudGltZSwKICAgICAgICBwYWdlOiB0aGlzLmZvcm1WYWxpZGF0ZS5wYWdlLAogICAgICAgIGxpbWl0OiB0aGlzLmZvcm1WYWxpZGF0ZS5saW1pdCwKICAgICAgICBzdG9yZV9pZDogdGhpcy5mb3JtVmFsaWRhdGUuc3RvcmVfaWQsCiAgICAgIH07CiAgICAgIGdldFJlY29yZChkYXRhKS50aGVuKChyZXMpID0+IHsKICAgICAgICB0aGlzLm9yZGVyTGlzdCA9IHJlcy5kYXRhLmxpc3Q7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgdGhpcy50b3RhbCA9IHJlcy5kYXRhLmNvdW50OwogICAgICB9KTsKICAgIH0sCiAgICAvLyDpgInmi6nml7bpl7QKICAgIHNlbGVjdENoYW5nZSh0YWIpIHsKICAgICAgdGhpcy5mb3JtVmFsaWRhdGUucGFnZSA9IDE7CiAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLnRpbWUgPSB0YWI7CiAgICAgIHRoaXMudGltZVZhbCA9IFtdOwogICAgICB0aGlzLmdldExpc3QoKTsKICAgIH0sCiAgICAvLyDlhbfkvZPml6XmnJ8KICAgIG9uY2hhbmdlVGltZShlKSB7CiAgICAgIHRoaXMudGltZVZhbCA9IGUgfHwgW107CiAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLnRpbWUgPSB0aGlzLnRpbWVWYWxbMF0gPyAodGhpcy50aW1lVmFsID8gdGhpcy50aW1lVmFsLmpvaW4oJy0nKSA6ICcnKSA6ICcnOwogICAgICB0aGlzLmZvcm1WYWxpZGF0ZS5wYWdlID0gMTsKICAgICAgdGhpcy5nZXRMaXN0KCk7CiAgICB9LAogICAgLy8g6LSm5Y2V6K+m5oOFCiAgICBJbmZvKHJvdykgewogICAgICB0aGlzLmlkcyA9IHJvdy5pZHMgfHwgJyc7CiAgICAgIHRoaXMubW9kYWxzID0gdHJ1ZTsKICAgIH0sCiAgICBjYW5jZWwoKSB7CiAgICAgIHRoaXMubW9kYWxzID0gZmFsc2U7CiAgICB9LAogICAgLy/kuIvovb0KICAgIGFzeW5jIGRvd25sb2FkKHJvdykgewogICAgICBsZXQgW3RoLCBmaWxlS2V5LCBkYXRhLCBmaWxlTmFtZV0gPSBbW10sIFtdLCBbXSwgJyddOwogICAgICBsZXQgZXhjZWxEYXRhID0gewogICAgICAgIGlkczogcm93LmlkcywKICAgICAgICBwYWdlOiAxLAogICAgICAgIGV4cG9ydDogMSwKICAgICAgICB0aW1lOiB0aGlzLmZvcm1WYWxpZGF0ZS50aW1lLAogICAgICB9OwogICAgICBsZXQgbGViRGF0YSA9IGF3YWl0IHRoaXMuZ2V0RXhjZWxEYXRhKGV4Y2VsRGF0YSk7CiAgICAgIGlmICghZmlsZU5hbWUpIGZpbGVOYW1lID0gbGViRGF0YS5maWxlTmFtZTsKICAgICAgaWYgKCFmaWxlS2V5Lmxlbmd0aCkgewogICAgICAgIGZpbGVLZXkgPSBsZWJEYXRhLmZpbGVLZXk7CiAgICAgIH0KICAgICAgaWYgKCF0aC5sZW5ndGgpIHRoID0gbGViRGF0YS5oZWFkZXI7CiAgICAgIGRhdGEgPSBkYXRhLmNvbmNhdChsZWJEYXRhLmxpc3QpOwogICAgICBleHBvcnRFeGNlbCh0aCwgZmlsZUtleSwgZmlsZU5hbWUsIGRhdGEpOwogICAgICByZXR1cm47CiAgICB9LAogICAgZ2V0RXhjZWxEYXRhKGV4Y2VsRGF0YSkgewogICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgIGdldEZsb3dMaXN0KGV4Y2VsRGF0YSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICByZXR1cm4gcmVzb2x2ZShyZXMuZGF0YSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAuGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/finance/billingRecords","sourcesContent":["<template>\n  <div>\n    <el-card :bordered=\"false\" shadow=\"never\" :body-style=\"{ padding: 0 }\">\n      <div class=\"padding-add\">\n        <el-form\n          ref=\"formValidate\"\n          :model=\"formValidate\"\n          :label-width=\"labelWidth\"\n          :label-position=\"labelPosition\"\n          @submit.native.prevent\n        >\n          <el-form-item label=\"创建时间：\">\n            <el-date-picker\n              clearable\n              v-model=\"timeVal\"\n              type=\"daterange\"\n              :editable=\"false\"\n              @change=\"onchangeTime\"\n              format=\"yyyy/MM/dd\"\n              value-format=\"yyyy/MM/dd\"\n              start-placeholder=\"开始日期\"\n              end-placeholder=\"结束日期\"\n              :picker-options=\"pickerOptions\"\n              style=\"width: 250px\"\n              class=\"mr20\"\n            ></el-date-picker>\n          </el-form-item>\n        </el-form>\n      </div>\n    </el-card>\n    <el-card :bordered=\"false\" shadow=\"never\" class=\"mt16\" :body-style=\"{ padding: '0 20px 20px' }\">\n      <div class=\"ivu-mt\">\n        <el-tabs v-model=\"tab\" @tab-click=\"onClickTab\">\n          <el-tab-pane label=\"日账单\" name=\"day\" />\n          <el-tab-pane label=\"周账单\" name=\"week\" />\n          <el-tab-pane label=\"月账单\" name=\"month\" />\n        </el-tabs>\n      </div>\n      <div class=\"table\">\n        <el-table\n          :data=\"orderList\"\n          ref=\"table\"\n          v-loading=\"loading\"\n          highlight-current-row\n          no-userFrom-text=\"暂无数据\"\n          no-filtered-userFrom-text=\"暂无筛选结果\"\n        >\n          <el-table-column label=\"ID\" width=\"80\">\n            <template slot-scope=\"scope\">\n              <span>{{ scope.row.id }}</span>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"标题\" min-width=\"130\">\n            <template slot-scope=\"scope\">\n              <span>{{ scope.row.title }}</span>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"日期\" min-width=\"130\">\n            <template slot-scope=\"scope\">\n              <span>{{ scope.row.add_time }}</span>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"收入金额\" min-width=\"130\">\n            <template slot-scope=\"scope\">\n              <span style=\"color: #f5222d\">￥{{ scope.row.income_price }}</span>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"支出金额\" min-width=\"130\">\n            <template slot-scope=\"scope\">\n              <span style=\"color: #00c050\">￥{{ scope.row.exp_price }}</span>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"入账金额\" min-width=\"130\">\n            <template slot-scope=\"scope\">\n              <span>￥{{ scope.row.entry_price }}</span>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"操作\" fixed=\"right\" width=\"170\">\n            <template slot-scope=\"scope\">\n              <a v-db-click @click=\"Info(scope.row)\">账单详情</a>\n              <el-divider direction=\"vertical\"></el-divider>\n              <a v-db-click @click=\"download(scope.row)\">下载</a>\n            </template>\n          </el-table-column>\n        </el-table>\n        <div class=\"acea-row row-right page\">\n          <pagination\n            v-if=\"total\"\n            :total=\"total\"\n            :page.sync=\"formValidate.page\"\n            :limit.sync=\"formValidate.limit\"\n            @pagination=\"getList\"\n          />\n        </div>\n      </div>\n    </el-card>\n    <el-dialog :visible.sync=\"modals\" title=\"账单详情\" width=\"1000px\">\n      <commission-details v-if=\"modals\" ref=\"commission\" :ids=\"ids\" :time=\"formValidate.time\"></commission-details>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport exportExcel from '@/utils/newToExcel.js';\nimport commissionDetails from '../components/commissionDetails';\nimport { getRecord } from '@/api/statistic.js';\nimport { getFlowList } from '@/api/finance';\n\nexport default {\n  name: 'bill',\n  components: {\n    commissionDetails,\n  },\n  data() {\n    return {\n      modals: false,\n      pickerOptions: this.$timeOptions,\n      ids: '',\n      total: 0,\n      loading: false,\n      tab: 'day',\n      orderList: [\n        {\n          id: '1',\n          order_id: '200',\n          pay_price: '200',\n          status: 1,\n          phone: '13000000000',\n          address: '100',\n        },\n      ],\n      formValidate: {\n        store_id: '',\n        time: '',\n        page: 1,\n        limit: 15,\n      },\n      timeVal: [],\n    };\n  },\n  computed: {\n    labelWidth() {\n      return this.isMobile ? undefined : '80px';\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'right';\n    },\n  },\n  mounted() {\n    this.onClickTab(this.tab);\n  },\n  methods: {\n    onClickTab() {\n      this.getList();\n    },\n    search() {\n      this.getList();\n    },\n    getList() {\n      this.loading = true;\n      let data = {\n        type: this.tab,\n        time: this.formValidate.time,\n        page: this.formValidate.page,\n        limit: this.formValidate.limit,\n        store_id: this.formValidate.store_id,\n      };\n      getRecord(data).then((res) => {\n        this.orderList = res.data.list;\n        this.loading = false;\n        this.total = res.data.count;\n      });\n    },\n    // 选择时间\n    selectChange(tab) {\n      this.formValidate.page = 1;\n      this.formValidate.time = tab;\n      this.timeVal = [];\n      this.getList();\n    },\n    // 具体日期\n    onchangeTime(e) {\n      this.timeVal = e || [];\n      this.formValidate.time = this.timeVal[0] ? (this.timeVal ? this.timeVal.join('-') : '') : '';\n      this.formValidate.page = 1;\n      this.getList();\n    },\n    // 账单详情\n    Info(row) {\n      this.ids = row.ids || '';\n      this.modals = true;\n    },\n    cancel() {\n      this.modals = false;\n    },\n    //下载\n    async download(row) {\n      let [th, fileKey, data, fileName] = [[], [], [], ''];\n      let excelData = {\n        ids: row.ids,\n        page: 1,\n        export: 1,\n        time: this.formValidate.time,\n      };\n      let lebData = await this.getExcelData(excelData);\n      if (!fileName) fileName = lebData.fileName;\n      if (!fileKey.length) {\n        fileKey = lebData.fileKey;\n      }\n      if (!th.length) th = lebData.header;\n      data = data.concat(lebData.list);\n      exportExcel(th, fileKey, fileName, data);\n      return;\n    },\n    getExcelData(excelData) {\n      return new Promise((resolve, reject) => {\n        getFlowList(excelData).then((res) => {\n          return resolve(res.data);\n        });\n      });\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n::v-deep .el-tabs__item {\n  height: 54px !important;\n  line-height: 54px !important;\n}\n::v-deep .ivu-card-body {\n  padding: 0;\n}\n\n.tabbox {\n  padding: 16px 20px 0px;\n}\n.box {\n  padding: 20px;\n  padding-bottom: 1px;\n}\n.tablebox {\n  margin-top: 15px;\n  padding-bottom: 10px;\n}\n.btnbox {\n  padding: 20px 0px 0px 30px;\n  .btns {\n    width: 99px;\n    height: 32px;\n    background: var(--prev-color-primary);\n    border-radius: 4px;\n    text-align: center;\n    line-height: 32px;\n    color: #ffffff;\n    cursor: pointer;\n  }\n}\n</style>\n"]}]}