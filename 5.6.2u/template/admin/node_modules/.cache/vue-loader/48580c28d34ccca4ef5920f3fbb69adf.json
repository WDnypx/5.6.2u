{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\components\\hotpotModal\\index.vue?vue&type=style&index=0&id=7ca5a708&lang=scss&scoped=true","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\components\\hotpotModal\\index.vue","mtime":1734316647484},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\css-loader\\index.js","mtime":1753254259822},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1753254262918},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\postcss-loader\\src\\index.js","mtime":1753254258547},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1753254255270},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Cjo6di1kZWVwIC5lbC1kaWFsb2cgewogIGJvcmRlci1yYWRpdXM6IDBweCAhaW1wb3J0YW50OwogIC5lbC1hbGVydF9faWNvbi5pcy1iaWcgewogICAgZm9udC1zaXplOiAxNHB4OwogICAgd2lkdGg6IDE2cHg7CiAgfQogIC5lbC1hbGVydCAuZWwtYWxlcnRfX2Rlc2NyaXB0aW9uIHsKICAgIG1hcmdpbjogMDsKICB9Cn0KLmJ0biB7CiAgZGlzcGxheTogZmxleDsKICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIHBhZGRpbmc6IDE2cHggMDsKfQouZGlhbG9nLWZvb3RlciB7CiAgdGV4dC1hbGlnbjogcmlnaHQ7CiAgbWFyZ2luLXRvcDogMjBweDsKICBtYXJnaW4tcmlnaHQ6IDIwcHg7Cn0KLm9wZXJhdGlvbkZsb29yIHsKICBkaXNwbGF5OiBmbGV4OwogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICBtYXgtaGVpZ2h0OiA4MHZoOwogIC5oZWFkZXIgewogICAgLnRpdGxlQm94IHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICBoZWlnaHQ6IDEwMHB4OwogICAgICAubmFtZSB7CiAgICAgICAgZm9udC1zaXplOiAxM3B4OwogICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgICB9CiAgICB9CiAgICAudGV4dEJveCB7CiAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgY29sb3I6ICM3Nzc7CiAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7CiAgICB9CiAgfQogIC5pbWdCb3g6Oi13ZWJraXQtc2Nyb2xsYmFyIHsKICAgIGRpc3BsYXk6IG5vbmU7IC8qIENocm9tZSBTYWZhcmkgKi8KICB9CiAgLmltZ0JveCB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICB3aWR0aDogNjUlOwogICAgb3ZlcmZsb3cteTogc2Nyb2xsOwogICAgbWF4LWhlaWdodDogODAwcHg7CiAgICAuY29udGFpbmVyIHsKICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICBib3JkZXI6IDFweCBzb2xpZCAjZjVmNWY1OwogICAgfQoKICAgIGltZyB7CiAgICAgIGN1cnNvcjogY3Jvc3NoYWlyOwogICAgICBkaXNwbGF5OiBibG9jazsKICAgICAgd2lkdGg6IDc1MHB4OwogICAgfQogICAgLmFyZWEgewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHdpZHRoOiAyMDBweDsKICAgICAgaGVpZ2h0OiAyMDBweDsKICAgICAgbGVmdDogMjAwcHg7CiAgICAgIHRvcDogMzAwcHg7CiAgICAgIGJhY2tncm91bmQ6IHJnYmEoIzI5ODBiOSwgMC4zKTsKICAgICAgYm9yZGVyOiAxcHggZGFzaGVkICMzNDQ5NWU7CiAgICB9CiAgfQp9Ci5mb3JtIHsKICBmb250LXNpemU6IDEycHg7CiAgd2lkdGg6IDMwJTsKICBtYXgtaGVpZ2h0OiA4MDBweDsKICBvdmVyZmxvdy15OiBzY3JvbGw7CiAgLmZvcm0tcm93IHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBtYXJnaW46IDEycHggMDsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAuZm9ybS1pdGVtIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgICBtYXJnaW46IDAgNXB4OwogICAgICBmb250LXNpemU6IDEycHg7CiAgICAgIC5udW0gewogICAgICAgIHdpZHRoOiA2OXB4OwogICAgICAgIGNvbG9yOiAjOTk5OwogICAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgfQogICAgICAubGFiZWwgewogICAgICAgIGNvbG9yOiAjYzdjN2M3OwogICAgICB9CiAgICB9CiAgfQogIC5lbC1pY29uLWRlbGV0ZSB7CiAgICBmb250LXNpemU6IDE2cHg7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAsVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/hotpotModal","sourcesContent":["<template>\n  <div>\n    <el-dialog title=\"编辑热区\" :visible.sync=\"dialogVisible\" @opened=\"openModal\" fullscreen>\n      <div class=\"operationFloor\">\n        <div class=\"imgBox\" @mouseup.left.stop=\"changeStop()\">\n          <div ref=\"container\" id=\"img-box-container\" class=\"container\">\n            <img\n              ref=\"backgroundImg\"\n              :src=\"imgs\"\n              ondragstart=\"return false;\"\n              oncontextmenu=\"return false;\"\n              onselect=\"document.selection.empty();\"\n              alt=\"img\"\n              @mousedown.left.stop=\"mouseDown($event)\"\n            />\n            <!--draw hotpot-->\n            <div\n              v-show=\"caseShow\"\n              :style=\"{\n                width: areaWidth + 'px',\n                height: areaHeight + 'px',\n                left: starX + 'px',\n                top: starY + 'px',\n              }\"\n              class=\"area\"\n            />\n            <!--be hotpot-->\n            <AreaBox\n              v-for=\"(item, index) in areaData\"\n              :area-data-index=\"index\"\n              :key=\"'area' + index\"\n              :link=\"item.link\"\n              :title=\"item.title\"\n              :type=\"parseInt(item.type)\"\n              :area-init.sync=\"item\"\n              :parent-width=\"parentWidth\"\n              :parent-height=\"parentHeight\"\n              @delAreaBox=\"delAreaBox\"\n              @addURL=\"addURL\"\n            />\n          </div>\n        </div>\n        <!-- 热区链接配置 -->\n        <div class=\"form\">\n          <h2 class=\"mb20\">图片热区</h2>\n          <el-alert type=\"warning\" :closable=\"false\" show-icon>框选热区范围，双击设置热区信息</el-alert>\n\n          <div v-for=\"(item, index) in areaData\" :key=\"index\" class=\"form-row\">\n            <div class=\"form-item\">\n              <span class=\"num\">热区{{ item.number }}</span>\n            </div>\n            <div class=\"form-item label\">\n              <div>\n                <el-input\n                  icon=\"ios-arrow-forward\"\n                  v-model=\"item.link\"\n                  :style=\"linkInputStyle\"\n                  placeholder=\"选择跳转链接\"\n                >\n                  <i class=\"el-icon-link\" slot=\"suffix\" @click=\"getLink(index)\" />\n                </el-input>\n              </div>\n            </div>\n            <i class=\"el-icon-delete\" @click=\"delAreaBox(index)\" />\n          </div>\n        </div>\n      </div>\n      <div slot=\"footer\">\n        <el-button class=\"mr20\" type=\"primary\" @click=\"saveAreaData\"> 完成 </el-button>\n      </div>\n    </el-dialog>\n    <linkaddress ref=\"linkaddres\" @linkUrl=\"linkUrl\"></linkaddress>\n  </div>\n</template>\n\n<script>\nimport AreaBox from './AreaBox';\nimport linkaddress from '@/components/linkaddress';\n\nexport default {\n  name: 'OperationFloor',\n  components: {\n    AreaBox,\n    linkaddress,\n  },\n  props: {\n    /**\n     * @description 图片数据对象\n     * @type {ImgData}\n     */\n    imgs: {\n      type: String, // 图片类型\n      default: () => '', // 默认值为空字符串\n    },\n    /**\n     * @description 是否为热门汤品\n     * @type {boolean}\n     */\n    isHotPot: {\n      type: Boolean, // 布尔类型\n      default: () => false, // 默认值为false\n    },\n    /**\n     * @description 图片区域数据对象\n     * @type {AreaData[]}\n     */\n    imgAreaData: {\n      type: Array, // 数组类型\n      default: () => [], // 默认值为空数组\n    },\n    /**\n     * @description 链接输入框样式对象\n     * @type {LinkInputStyle}\n     */\n    linkInputStyle: {\n      type: Object, // 对象类型\n      default: () => ({\n        // 默认值为一个包含width属性的对象\n        width: '300px',\n      }),\n    },\n  },\n  data() {\n    return {\n      /**\n       * @description 对话框是否可见\n       * @type {boolean}\n       */\n      dialogVisible: false,\n      /**\n       * @description 开始的x坐标\n       * @type {number}\n       */\n      starX: 0,\n      /**\n       * @description 开始的y坐标\n       * @type {number}\n       */\n      starY: 0,\n      /**\n       * @description 区域宽度\n       * @type {number}\n       */\n      areaWidth: 0,\n      /**\n       * @description 区域高度\n       * @type {number}\n       */\n      areaHeight: 0,\n      /**\n       * @description 当前显示的图片索引\n       * @type {boolean}\n       */\n      caseShow: false,\n      /**\n       * @description 当前图片的宽度\n       * @type {null}\n       */\n      nowImgWidth: null,\n      /**\n       * @description 区域数据\n       * @type {Array}\n       */\n      areaData: [],\n      /**\n       * @description 当前显示的图片编号\n       * @type {number}\n       */\n      imgNum: 1,\n      /**\n       * @description 父元素宽度\n       * @type {number}\n       */\n      parentWidth: 0,\n      /**\n       * @description 父元素高度\n       * @type {number}\n       */\n      parentHeight: 0,\n      /**\n       * @description 默认宽度\n       * @type {number}\n       */\n      defaultWidth: 750,\n      /**\n       * @description 当前显示的图片索引\n       * @type {number}\n       */\n      itemIndex: 0,\n    };\n  },\n  computed: {},\n  watch: {\n    imgAreaData(val) {\n      this.areaData = [...val];\n    },\n  },\n  mounted() {\n    this.areaData = [...this.imgAreaData];\n  },\n  methods: {\n    openModal() {\n      this.$nextTick(() => {\n        const parentDiv = document.querySelector('#img-box-container');\n        //获取元素的宽高\n        this.parentWidth = this.defaultWidth;\n        // this.parentWidth = parentDiv.clientWidth;\n        this.parentHeight = parentDiv.clientHeight;\n        // console.log(\"this.parentWidth\", this.parentWidth, this.parentHeight)\n      });\n    },\n    closeModal() {\n      this.$confirm('未保存内容，是否在离开前放弃保存？', '提示信息', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning',\n      })\n        .then(() => {\n          this.dialogVisible = false;\n        })\n        .catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消',\n          });\n        });\n    },\n    // 绘画热区开始\n    mouseDown(e) {\n      e.preventDefault();\n      this.caseShow = true;\n      // 记录滑动的初始值\n      this.starX = e.layerX -5;\n      this.starY = e.layerY -5;\n      // 鼠标滑动的过程\n      if (!document.onmousemove) {\n        let maxWidth = this.defaultWidth - e.layerX;\n        document.onmousemove = (ev) => {\n          if (ev.layerX - this.starX < maxWidth) {\n            this.areaWidth = ev.layerX - this.starX - 5;\n          } else {\n            this.areaWidth = maxWidth;\n          }\n          this.areaHeight = ev.layerY - this.starY -5;\n        };\n      }\n    },\n    // 绘画热区结束\n    changeStop() {\n      document.onmousemove = null;\n      this.imgNum = this.areaData.length + 1;\n      if (this.caseShow && this.areaWidth > 10 && this.areaHeight > 10) {\n        const data = {\n          number: this.imgNum,\n          starX: this.starX,\n          starY: this.starY,\n          areaWidth: this.areaWidth,\n          areaHeight: this.areaHeight,\n          nowImgWidth: this.defaultWidth,\n          link: '',\n        };\n        this.areaData.push(data);\n      }\n      // 初始化绘图\n      this.caseShow = false;\n      this.starX = 0;\n      this.starY = 0;\n      this.areaWidth = 0;\n      this.areaHeight = 0;\n    },\n    // 删除指定热区\n    delAreaBox(index) {\n      /* 删除某个热区 */\n      this.areaData.splice(index, 1);\n      this.$emit('delAreaData', this.areaData);\n      /* 删除后 每个热区按顺序重新编号 */\n      if (this.areaData) {\n        const arr = this.areaData.filter((i) => i.number > index);\n        if (!arr) return;\n        arr.forEach((i) => i.number--);\n        if (this.areaData[this.areaData.length - 1]) {\n          this.imgNum = this.areaData[this.areaData.length - 1].number + 1;\n        } else {\n          this.imgNum = 1;\n        }\n      }\n    },\n    // 添加网址\n    addURL(index, url) {\n      let obj = {\n        ...this.areaData[index],\n        link: url,\n      };\n      this.$set(this.areaData, index, obj);\n    },\n    // 保存热区信息\n    saveAreaData() {\n      if ((this.areaData && !this.areaData.length) || !this.checkData(this.areaData)) {\n        this.$message.error('热区是否配置链接、是否至少添加一个热区?');\n        return;\n      }\n      this.$emit('saveAreaData', this.areaData);\n      this.dialogVisible = false;\n      this.$message.success('编辑成功!');\n    },\n    /**\n     * 检查列表中每个元素是否都有 link 属性\n     * @param {Array} list - 待检查的列表\n     * @returns {Boolean} - 是否所有元素都有 link 属性\n     */\n    checkData(list) {\n      let isCheck = true;\n      list.some((val) => {\n        if (!val.link) {\n          isCheck = false;\n        }\n      });\n      return isCheck;\n    },\n    /**\n     * @description 获取链接地址并打开添加链接的模态框\n     * @param {number} index - 当前项的索引值\n     */\n    getLink(index) {\n      // 设置当前项的索引值\n      this.itemIndex = index;\n      // 打开添加链接的模态框\n      this.$refs.linkaddres.modals = true;\n    },\n    /**\n     * @description 处理链接地址的输入事件\n     * @param {string} e - 链接地址\n     */\n    linkUrl(e) {\n      // 将链接地址存储到对应的数据项中\n      this.areaData[this.itemIndex].link = e;\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n::v-deep .el-dialog {\n  border-radius: 0px !important;\n  .el-alert__icon.is-big {\n    font-size: 14px;\n    width: 16px;\n  }\n  .el-alert .el-alert__description {\n    margin: 0;\n  }\n}\n.btn {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 16px 0;\n}\n.dialog-footer {\n  text-align: right;\n  margin-top: 20px;\n  margin-right: 20px;\n}\n.operationFloor {\n  display: flex;\n  position: relative;\n  max-height: 80vh;\n  .header {\n    .titleBox {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      height: 100px;\n      .name {\n        font-size: 13px;\n        font-weight: bold;\n      }\n    }\n    .textBox {\n      font-size: 12px;\n      color: #777;\n      margin-bottom: 10px;\n    }\n  }\n  .imgBox::-webkit-scrollbar {\n    display: none; /* Chrome Safari */\n  }\n  .imgBox {\n    display: flex;\n    justify-content: center;\n    width: 65%;\n    overflow-y: scroll;\n    max-height: 800px;\n    .container {\n      position: relative;\n      border: 1px solid #f5f5f5;\n    }\n\n    img {\n      cursor: crosshair;\n      display: block;\n      width: 750px;\n    }\n    .area {\n      position: absolute;\n      width: 200px;\n      height: 200px;\n      left: 200px;\n      top: 300px;\n      background: rgba(#2980b9, 0.3);\n      border: 1px dashed #34495e;\n    }\n  }\n}\n.form {\n  font-size: 12px;\n  width: 30%;\n  max-height: 800px;\n  overflow-y: scroll;\n  .form-row {\n    display: flex;\n    margin: 12px 0;\n    align-items: center;\n    .form-item {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      white-space: nowrap;\n      margin: 0 5px;\n      font-size: 12px;\n      .num {\n        width: 69px;\n        color: #999;\n        font-size: 12px;\n      }\n      .label {\n        color: #c7c7c7;\n      }\n    }\n  }\n  .el-icon-delete {\n    font-size: 16px;\n    cursor: pointer;\n  }\n}\n</style>\n"]}]}