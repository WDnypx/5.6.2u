{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\marketing\\storeCouponIssue\\create.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\marketing\\storeCouponIssue\\create.vue","mtime":1746771908482},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1753254258567},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCc7CmltcG9ydCBnb29kc0xpc3QgZnJvbSAnQC9jb21wb25lbnRzL2dvb2RzTGlzdC9pbmRleCc7CmltcG9ydCB7IGNvdXBvblNhdmVBcGksIGNvdXBvbkRldGFpbEFwaSB9IGZyb20gJ0AvYXBpL21hcmtldGluZyc7CmltcG9ydCB7IGNhc2NhZGVyTGlzdEFwaSB9IGZyb20gJ0AvYXBpL3Byb2R1Y3QnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ3N0b3JlQ291cG9uQ3JlYXRlJywKICBjb21wb25lbnRzOiB7CiAgICBnb29kc0xpc3QsCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGlzYWJsZWQ6IGZhbHNlLAogICAgICBmb3JtRGF0YTogewogICAgICAgIGNvdXBvbl90aXRsZTogJycsCiAgICAgICAgY291cG9uX3ByaWNlOiAwLAogICAgICAgIHR5cGU6IDAsCiAgICAgICAgdXNlX21pbl9wcmljZTogMCwKICAgICAgICBjb3Vwb25fdGltZTogMCwKICAgICAgICBzdGFydF91c2VfdGltZTogMCwKICAgICAgICBlbmRfdXNlX3RpbWU6IDAsCiAgICAgICAgc3RhcnRfdGltZTogMCwKICAgICAgICBlbmRfdGltZTogMCwKICAgICAgICB1c2VyX3R5cGU6IDEsCiAgICAgICAgcmVjZWl2ZV90eXBlOiAxLAogICAgICAgIGlzX3Blcm1hbmVudDogMSwKICAgICAgICB0b3RhbF9jb3VudDogMSwKICAgICAgICBzb3J0OiAwLAogICAgICAgIHN0YXR1czogMSwKICAgICAgICBwcm9kdWN0X2lkOiAnJywKICAgICAgICBjYXRlZ29yeV9pZDogMCwKICAgICAgICByZWNlaXZlX2xpbWl0OiAxLAogICAgICB9LAogICAgICBjYXRlZ29yeUxpc3Q6IFtdLAogICAgICBwcm9kdWN0TGlzdDogW10sCiAgICAgIGlzTWluUHJpY2U6IDAsCiAgICAgIGlzQ291cG9uVGltZTogMSwKICAgICAgaXNSZWNlaXZlVGltZTogMCwKICAgICAgbW9kYWxzOiBmYWxzZSwKICAgICAgZGF0ZXRpbWUxOiBbJzIwMjMtMTAtMTggMDA6MDA6MDAnLCAnMjAyMy0xMS0yMiAwMDowMDowMCddLAogICAgICBkYXRldGltZTI6IFtdLAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZSgnbWVkaWEnLCBbJ2lzTW9iaWxlJ10pLAogICAgaXNFZGl0KCkgewogICAgICByZXR1cm4gISF0aGlzLiRyb3V0ZS5wYXJhbXMuZWRpdDsKICAgIH0sCiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRDYXRlZ29yeUxpc3QoKTsKICAgIGlmICh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpIHsKICAgICAgdGhpcy5mb3JtRGF0YS5pZCA9ICh0aGlzLmlzRWRpdCAmJiBOdW1iZXIodGhpcy4kcm91dGUucGFyYW1zLmlkKSkgfHwgMDsKICAgICAgdGhpcy5nZXRDb3Vwb25EZXRhaWwoKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGNoYW5nZVVzZXJUeXBlKCkgewogICAgICBpZiAodGhpcy5mb3JtRGF0YS51c2VyX3R5cGUgPT0gMikgewogICAgICAgIHRoaXMuZm9ybURhdGEucmVjZWl2ZV90eXBlID0gMTsKICAgICAgfQogICAgfSwKICAgIC8vIOWTgeexuwogICAgZ2V0Q2F0ZWdvcnlMaXN0KCkgewogICAgICBjYXNjYWRlckxpc3RBcGkoMSkudGhlbihhc3luYyAocmVzKSA9PiB7CiAgICAgICAgdGhpcy5jYXRlZ29yeUxpc3QgPSByZXMuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g5LyY5oOg5Yi4CiAgICBnZXRDb3Vwb25EZXRhaWwoKSB7CiAgICAgIGNvdXBvbkRldGFpbEFwaSh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgbGV0IGRhdGEgPSByZXMuZGF0YTsKICAgICAgICAgIHRoaXMuZm9ybURhdGEuY291cG9uX3RpdGxlID0gZGF0YS5jb3Vwb25fdGl0bGU7CiAgICAgICAgICB0aGlzLmZvcm1EYXRhLnR5cGUgPSBkYXRhLnR5cGU7CiAgICAgICAgICB0aGlzLmZvcm1EYXRhLmNhdGVnb3J5X2lkID0gZGF0YS5jYXRlZ29yeV9pZDsKICAgICAgICAgIHRoaXMuZm9ybURhdGEuY291cG9uX3ByaWNlID0gcGFyc2VGbG9hdChkYXRhLmNvdXBvbl9wcmljZSk7CiAgICAgICAgICB0aGlzLmZvcm1EYXRhLnVzZV9taW5fcHJpY2UgPSBwYXJzZUZsb2F0KGRhdGEudXNlX21pbl9wcmljZSk7CiAgICAgICAgICBpZiAodGhpcy5mb3JtRGF0YS51c2VfbWluX3ByaWNlKSB7CiAgICAgICAgICAgIHRoaXMuaXNNaW5QcmljZSA9IDE7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmZvcm1EYXRhLmNvdXBvbl90aW1lID0gZGF0YS5jb3Vwb25fdGltZTsKICAgICAgICAgIHRoaXMuZm9ybURhdGEucmVjZWl2ZV90eXBlID0gZGF0YS5yZWNlaXZlX3R5cGU7CiAgICAgICAgICB0aGlzLmZvcm1EYXRhLnVzZXJfdHlwZSA9IGRhdGEudXNlcl90eXBlOwogICAgICAgICAgdGhpcy5mb3JtRGF0YS5pc19wZXJtYW5lbnQgPSBkYXRhLmlzX3Blcm1hbmVudDsKICAgICAgICAgIHRoaXMuZm9ybURhdGEuc3RhdHVzID0gZGF0YS5zdGF0dXM7CiAgICAgICAgICB0aGlzLmZvcm1EYXRhLnByb2R1Y3RfaWQgPSBkYXRhLnByb2R1Y3RfaWQ7CiAgICAgICAgICB0aGlzLmZvcm1EYXRhLnN0YXJ0X3RpbWUgPSBkYXRhLnN0YXJ0X3RpbWU7CiAgICAgICAgICB0aGlzLmZvcm1EYXRhLmVuZF90aW1lID0gZGF0YS5lbmRfdGltZTsKICAgICAgICAgIHRoaXMuZm9ybURhdGEudG90YWxfY291bnQgPSBkYXRhLnRvdGFsX2NvdW50OwogICAgICAgICAgdGhpcy5mb3JtRGF0YS5zb3J0ID0gZGF0YS5zb3J0OwogICAgICAgICAgdGhpcy5mb3JtRGF0YS5yZWNlaXZlX2xpbWl0ID0gZGF0YS5yZWNlaXZlX2xpbWl0OwogICAgICAgICAgaWYgKCdwcm9kdWN0SW5mbycgaW4gZGF0YSkgewogICAgICAgICAgICB0aGlzLnByb2R1Y3RMaXN0ID0gZGF0YS5wcm9kdWN0SW5mbzsKICAgICAgICAgIH0KICAgICAgICAgIGlmICghZGF0YS5jb3Vwb25fdGltZSkgewogICAgICAgICAgICB0aGlzLmlzQ291cG9uVGltZSA9IDA7CiAgICAgICAgICAgIHRoaXMuZGF0ZXRpbWUxID0gW3RoaXMubWFrZURhdGUoZGF0YS5zdGFydF91c2VfdGltZSAqIDEwMDApLCB0aGlzLm1ha2VEYXRlKGRhdGEuZW5kX3VzZV90aW1lICogMTAwMCldOwogICAgICAgICAgICB0aGlzLmZvcm1EYXRhLnN0YXJ0X3VzZV90aW1lID0gdGhpcy5tYWtlRGF0ZShkYXRhLnN0YXJ0X3VzZV90aW1lICogMTAwMCk7CiAgICAgICAgICAgIHRoaXMuZm9ybURhdGEuZW5kX3VzZV90aW1lID0gdGhpcy5tYWtlRGF0ZShkYXRhLmVuZF91c2VfdGltZSAqIDEwMDApOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGRhdGEuc3RhcnRfdGltZSkgewogICAgICAgICAgICB0aGlzLmlzUmVjZWl2ZVRpbWUgPSAxOwogICAgICAgICAgICB0aGlzLmRhdGV0aW1lMiA9IFtkYXRhLnN0YXJ0X3RpbWUgKiAxMDAwLCBkYXRhLmVuZF90aW1lICogMTAwMF07CiAgICAgICAgICAgIHRoaXMuZm9ybURhdGEuc3RhcnRfdGltZSA9IHRoaXMubWFrZURhdGUoZGF0YS5zdGFydF90aW1lICogMTAwMCk7CiAgICAgICAgICAgIHRoaXMuZm9ybURhdGEuZW5kX3RpbWUgPSB0aGlzLm1ha2VEYXRlKGRhdGEuZW5kX3RpbWUgKiAxMDAwKTsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKGVyci5tc2cpOwogICAgICAgIH0pOwogICAgfSwKICAgIG1ha2VEYXRlKGRhdGEpIHsKICAgICAgbGV0IGRhdGUgPSBuZXcgRGF0ZShkYXRhKTsKICAgICAgbGV0IFlZID0gZGF0ZS5nZXRGdWxsWWVhcigpICsgJy0nOwogICAgICBsZXQgTU0gPSAoZGF0ZS5nZXRNb250aCgpICsgMSA8IDEwID8gJzAnICsgKGRhdGUuZ2V0TW9udGgoKSArIDEpIDogZGF0ZS5nZXRNb250aCgpICsgMSkgKyAnLSc7CiAgICAgIGxldCBERCA9IGRhdGUuZ2V0RGF0ZSgpIDwgMTAgPyAnMCcgKyBkYXRlLmdldERhdGUoKSA6IGRhdGUuZ2V0RGF0ZSgpOwogICAgICBsZXQgaGggPSAoZGF0ZS5nZXRIb3VycygpIDwgMTAgPyAnMCcgKyBkYXRlLmdldEhvdXJzKCkgOiBkYXRlLmdldEhvdXJzKCkpICsgJzonOwogICAgICBsZXQgbW0gPSAoZGF0ZS5nZXRNaW51dGVzKCkgPCAxMCA/ICcwJyArIGRhdGUuZ2V0TWludXRlcygpIDogZGF0ZS5nZXRNaW51dGVzKCkpICsgJzonOwogICAgICBsZXQgc3MgPSBkYXRlLmdldFNlY29uZHMoKSA8IDEwID8gJzAnICsgZGF0ZS5nZXRTZWNvbmRzKCkgOiBkYXRlLmdldFNlY29uZHMoKTsKICAgICAgcmV0dXJuIFlZICsgTU0gKyBERCArICcgJyArIGhoICsgbW0gKyBzczsKICAgIH0sCiAgICAvLyDliJvlu7oKICAgIHNhdmUoKSB7CiAgICAgIGlmICghdGhpcy5mb3JtRGF0YS5jb3Vwb25fdGl0bGUpIHsKICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign6K+36L6T5YWl5LyY5oOg5Yi45ZCN56ewJyk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuZm9ybURhdGEudHlwZSA9PT0gMikgewogICAgICAgIGlmICghdGhpcy5mb3JtRGF0YS5wcm9kdWN0X2lkKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign6K+36YCJ5oup5ZWG5ZOBJyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aGlzLmZvcm1EYXRhLnR5cGUgPT09IDEpIHsKICAgICAgICBpZiAoIXRoaXMuZm9ybURhdGEuY2F0ZWdvcnlfaWQpIHsKICAgICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCfor7fpgInmi6nlk4HnsbsnKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHRoaXMuZm9ybURhdGEuY291cG9uX3ByaWNlIDw9IDApIHsKICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign5LyY5oOg5Yi46Z2i5YC85LiN6IO95bCP5LqOMCcpOwogICAgICB9CiAgICAgIGlmICghdGhpcy5pc01pblByaWNlKSB7CiAgICAgICAgdGhpcy5mb3JtRGF0YS51c2VfbWluX3ByaWNlID0gMDsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGhpcy5mb3JtRGF0YS51c2VfbWluX3ByaWNlIDwgMSkgewogICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+S8mOaDoOWIuOacgOS9jua2iOi0ueS4jeiDveWwj+S6jjAnKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHRoaXMuaXNDb3Vwb25UaW1lKSB7CiAgICAgICAgdGhpcy5mb3JtRGF0YS5zdGFydF91c2VfdGltZSA9IDA7CiAgICAgICAgdGhpcy5mb3JtRGF0YS5lbmRfdXNlX3RpbWUgPSAwOwogICAgICAgIGlmICh0aGlzLmZvcm1EYXRhLmNvdXBvbl90aW1lIDwgMSkgewogICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+S9v+eUqOacieaViOacn+mZkOS4jeiDveWwj+S6jjHlpKknKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5mb3JtRGF0YS5jb3Vwb25fdGltZSA9IDA7CiAgICAgICAgaWYgKCF0aGlzLmZvcm1EYXRhLnN0YXJ0X3VzZV90aW1lKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign6K+36YCJ5oup5L2/55So5pyJ5pWI5pyf6ZmQJyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aGlzLmlzUmVjZWl2ZVRpbWUpIHsKICAgICAgICBpZiAoIXRoaXMuZm9ybURhdGEuc3RhcnRfdGltZSkgewogICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ivt+mAieaLqemihuWPluaXtumXtCcpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmZvcm1EYXRhLnN0YXJ0X3RpbWUgPSAwOwogICAgICAgIHRoaXMuZm9ybURhdGEuZW5kX3RpbWUgPSAwOwogICAgICB9CiAgICAgIC8vIGlmICh0aGlzLmZvcm1EYXRhLnJlY2VpdmVfdHlwZSA9PSAyIHx8IHRoaXMuZm9ybURhdGEucmVjZWl2ZV90eXBlID09IDMpIHsKICAgICAgLy8gICB0aGlzLmZvcm1EYXRhLmlzX3Blcm1hbmVudCA9IDE7CiAgICAgIC8vIH0KICAgICAgaWYgKHRoaXMuZm9ybURhdGEuaXNfcGVybWFuZW50KSB7CiAgICAgICAgdGhpcy5mb3JtRGF0YS50b3RhbF9jb3VudCA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMuZm9ybURhdGEudG90YWxfY291bnQgPCAxKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign5Y+R5biD5pWw6YeP5LiN6IO95bCP5LqOMScpOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodGhpcy5mb3JtRGF0YS5yZWNlaXZlX2xpbWl0IDwgMSkgewogICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCfmr4/kuKrnlKjmiLflj6/ku6Xpooblj5bmlbDph4/kuI3og73lsI/kuo4xJyk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuZm9ybURhdGEudHlwZSA9PSAwKSB7CiAgICAgICAgdGhpcy5mb3JtRGF0YS5wcm9kdWN0X2lkID0gJyc7CiAgICAgICAgdGhpcy5mb3JtRGF0YS5jYXRlZ29yeV9pZCA9ICcnOwogICAgICAgIHRoaXMucHJvZHVjdExpc3QgPSBbXTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmZvcm1EYXRhLnR5cGUgPT0gMSkgewogICAgICAgIHRoaXMuZm9ybURhdGEucHJvZHVjdF9pZCA9ICcnOwogICAgICAgIHRoaXMucHJvZHVjdExpc3QgPSBbXTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmZvcm1EYXRhLnR5cGUgPT0gMikgewogICAgICAgIHRoaXMuZm9ybURhdGEuY2F0ZWdvcnlfaWQgPSAnJzsKICAgICAgfQogICAgICBpZiAodGhpcy5kaXNhYmxlZCkgcmV0dXJuOwogICAgICB0aGlzLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgY291cG9uU2F2ZUFwaSh0aGlzLmZvcm1EYXRhKQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXMubXNnKTsKICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICBwYXRoOiB0aGlzLiRyb3V0ZVByb1N0ciArICcvbWFya2V0aW5nL3N0b3JlX2NvdXBvbl9pc3N1ZS9pbmRleCcsCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycikgPT4gewogICAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihlcnIubXNnKTsKICAgICAgICB9KTsKICAgIH0sCiAgICAvLyDkvb/nlKjmnInmlYjmnJ8tLeaXtumXtOautQogICAgZGF0ZUNoYW5nZSh0aW1lKSB7CiAgICAgIHRoaXMuZm9ybURhdGEuc3RhcnRfdXNlX3RpbWUgPSB0aW1lWzBdOwogICAgICB0aGlzLmZvcm1EYXRhLmVuZF91c2VfdGltZSA9IHRpbWVbMV07CiAgICB9LAogICAgLy8g6ZmQ5pe2CiAgICB0aW1lQ2hhbmdlKHRpbWUpIHsKICAgICAgdGhpcy5mb3JtRGF0YS5zdGFydF90aW1lID0gdGltZVswXTsKICAgICAgdGhpcy5mb3JtRGF0YS5lbmRfdGltZSA9IHRpbWVbMV07CiAgICB9LAogICAgLy/lr7nosaHmlbDnu4Tljrvph43vvJsKICAgIHVuaXF1ZShhcnIpIHsKICAgICAgY29uc3QgcmVzID0gbmV3IE1hcCgpOwogICAgICByZXR1cm4gYXJyLmZpbHRlcigoYXJyKSA9PiAhcmVzLmhhcyhhcnIucHJvZHVjdF9pZCkgJiYgcmVzLnNldChhcnIucHJvZHVjdF9pZCwgMSkpOwogICAgfSwKICAgIC8vIOmAieaLqeeahOWVhuWTgQogICAgZ2V0UHJvZHVjdElkKHByb2R1Y3RMaXN0KSB7CiAgICAgIHRoaXMubW9kYWxzID0gZmFsc2U7CiAgICAgIHRoaXMucHJvZHVjdExpc3QgPSB0aGlzLnVuaXF1ZSh0aGlzLnByb2R1Y3RMaXN0LmNvbmNhdChwcm9kdWN0TGlzdCkpOwogICAgICB0aGlzLmZvcm1EYXRhLnByb2R1Y3RfaWQgPSAnJzsKICAgICAgdGhpcy5wcm9kdWN0TGlzdC5mb3JFYWNoKCh2YWx1ZSkgPT4gewogICAgICAgIGlmICh0aGlzLmZvcm1EYXRhLnByb2R1Y3RfaWQpIHsKICAgICAgICAgIHRoaXMuZm9ybURhdGEucHJvZHVjdF9pZCArPSBgLCR7dmFsdWUucHJvZHVjdF9pZH1gOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmZvcm1EYXRhLnByb2R1Y3RfaWQgKz0gYCR7dmFsdWUucHJvZHVjdF9pZH1gOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgY2FuY2VsKCkgewogICAgICB0aGlzLm1vZGFscyA9IGZhbHNlOwogICAgfSwKICAgIC8vIOWIoOmZpOWVhuWTgQogICAgcmVtb3ZlKHByb2R1Y3RJZCkgewogICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy5wcm9kdWN0TGlzdC5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgICBpZiAodGhpcy5wcm9kdWN0TGlzdFtpbmRleF0ucHJvZHVjdF9pZCA9PSBwcm9kdWN0SWQpIHsKICAgICAgICAgIHRoaXMucHJvZHVjdExpc3Quc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5mb3JtRGF0YS5wcm9kdWN0X2lkID0gJyc7CiAgICAgIHRoaXMucHJvZHVjdExpc3QuZm9yRWFjaCgodmFsdWUpID0+IHsKICAgICAgICBpZiAodGhpcy5mb3JtRGF0YS5wcm9kdWN0X2lkKSB7CiAgICAgICAgICB0aGlzLmZvcm1EYXRhLnByb2R1Y3RfaWQgKz0gYCwke3ZhbHVlLnByb2R1Y3RfaWR9YDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5mb3JtRGF0YS5wcm9kdWN0X2lkICs9IGAke3ZhbHVlLnByb2R1Y3RfaWR9YDsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["create.vue"],"names":[],"mappings":";AA4MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"create.vue","sourceRoot":"src/pages/marketing/storeCouponIssue","sourcesContent":["<template>\n  <div>\n    <pages-header\n      ref=\"pageHeader\"\n      :title=\"$route.params.id ? '编辑优惠券' : '添加优惠券'\"\n      :backUrl=\"$routeProStr + '/marketing/store_coupon_issue/index'\"\n    ></pages-header>\n    <el-card :bordered=\"false\" shadow=\"never\" class=\"mt16\">\n      <el-form :model=\"formData\" label-width=\"160px\">\n        <el-form-item label=\"优惠券名称：\">\n          <el-input\n            v-model=\"formData.coupon_title\"\n            maxlength=\"18\"\n            show-word-limit\n            placeholder=\"请输入优惠券名称\"\n            class=\"content_width\"\n          ></el-input>\n        </el-form-item>\n        <el-form-item label=\"优惠券面值：\">\n          <el-input-number\n            :controls=\"false\"\n            :min=\"1\"\n            :max=\"9999999999\"\n            v-model=\"formData.coupon_price\"\n            class=\"content_width input-number-unit-class\"\n            class-unit=\"元\"\n            :disabled=\"isEdit\"\n          ></el-input-number>\n        </el-form-item>\n        <el-form-item label=\"用户类型：\">\n          <el-radio-group v-model=\"formData.user_type\" :disabled=\"isEdit\" @input=\"changeUserType\">\n            <el-radio :label=\"1\">普通用户</el-radio>\n            <el-radio :label=\"2\">付费会员用户</el-radio>\n          </el-radio-group>\n          <div class=\"tip\">\n            普通用户：所有用户都能获取到的优惠券；<br />\n            付费会员用户：仅付费会员才能领取的优惠券；\n          </div>\n        </el-form-item>\n        <el-form-item label=\"发送方式：\" v-show=\"formData.user_type == 1\">\n          <el-radio-group v-model=\"formData.receive_type\" :disabled=\"isEdit\">\n            <el-radio :label=\"1\">用户领取</el-radio>\n            <el-radio :label=\"3\">系统赠送</el-radio>\n          </el-radio-group>\n          <div class=\"tip\">\n            用户领取：用户需要手动领取优惠券；<br />\n            系统赠送：1.后台发放指定用户。2.添加到商品里面用户购买该商品获得。3.设置新人礼页面新用户注册赠送优惠券；\n          </div>\n        </el-form-item>\n        <el-form-item label=\"优惠劵类型：\">\n          <el-radio-group v-model=\"formData.type\" :disabled=\"isEdit\">\n            <el-radio :label=\"0\">通用券</el-radio>\n            <el-radio :label=\"1\">品类券</el-radio>\n            <el-radio :label=\"2\">商品券</el-radio>\n            <!--                        <el-radio :label=\"3\">会员券</el-radio>-->\n          </el-radio-group>\n        </el-form-item>\n        <el-form-item v-show=\"formData.type === 2\">\n          <template>\n            <div class=\"acea-row\">\n              <div v-for=\"(item, index) in productList\" :key=\"index\" class=\"pictrue\">\n                <img v-lazy=\"item.image\" />\n                <i  v-if=\"formData.type == 2 && !formData.id\" class=\"el-icon-error btndel\" v-db-click @click=\"remove(item.product_id)\"></i>\n              </div>\n              <div v-if=\"formData.type == 2 && !formData.id\" class=\"upLoad acea-row row-center-wrapper\" v-db-click @click=\"modals = true\">\n                <i class=\"el-icon-goods\" style=\"font-size: 24px\"></i>\n              </div>\n            </div>\n          </template>\n        </el-form-item>\n        <el-form-item v-show=\"formData.type === 1\">\n          <el-cascader\n            v-model=\"formData.category_id\"\n            size=\"small\"\n            :options=\"categoryList\"\n            :props=\"{ multiple: true, emitPath: false, checkStrictly: true }\"\n            clearable\n            style=\"width: 320px\"\n            :disabled=\"isEdit\"\n          ></el-cascader>\n          <div class=\"info\">选择商品的品类</div>\n        </el-form-item>\n        <el-form-item label=\"使用门槛：\">\n          <el-radio-group v-model=\"isMinPrice\" :disabled=\"isEdit\">\n            <el-radio :label=\"0\">无门槛</el-radio>\n            <el-radio :label=\"1\">有门槛</el-radio>\n          </el-radio-group>\n        </el-form-item>\n        <el-form-item v-if=\"isMinPrice\">\n          <el-input-number\n            :controls=\"false\"\n            :min=\"0\"\n            :max=\"9999999999\"\n            v-model=\"formData.use_min_price\"\n            class=\"content_width input-number-unit-class\"\n            :disabled=\"isEdit\"\n            class-unit=\"元\"\n          ></el-input-number>\n          <div class=\"info\">填写优惠券的最低消费金额</div>\n        </el-form-item>\n        <el-form-item label=\"有效期：\">\n          <el-radio-group v-model=\"isCouponTime\" :disabled=\"isEdit\">\n            <el-radio :label=\"1\">天数</el-radio>\n            <el-radio :label=\"0\">时间段</el-radio>\n          </el-radio-group>\n        </el-form-item>\n        <el-form-item v-show=\"isCouponTime\" label=\"\">\n          <el-input-number\n            :controls=\"false\"\n            :min=\"0\"\n            v-model=\"formData.coupon_time\"\n            :precision=\"0\"\n            class=\"content_width input-number-unit-class\"\n            :disabled=\"isEdit\"\n            class-unit=\"天\"\n          ></el-input-number>\n          <div class=\"info\">领取后多少天内有效</div>\n        </el-form-item>\n        <el-form-item v-show=\"!isCouponTime\" label=\"\">\n          <el-date-picker\n            v-model=\"datetime1\"\n            :disabled=\"isEdit\"\n            clearable\n            :editable=\"false\"\n            type=\"datetimerange\"\n            value-format=\"yyyy-MM-dd HH:mm:ss\"\n            style=\"width: 380px\"\n            range-separator=\"-\"\n            start-placeholder=\"开始日期\"\n            end-placeholder=\"结束日期\"\n            @change=\"dateChange\"\n          ></el-date-picker>\n        </el-form-item>\n\n        <el-form-item label=\"领取时间：\" v-if=\"formData.receive_type != 2 && formData.receive_type != 3\">\n          <el-radio-group v-model=\"isReceiveTime\" :disabled=\"isEdit\">\n            <el-radio :label=\"1\">限时</el-radio>\n            <el-radio :label=\"0\">不限时</el-radio>\n          </el-radio-group>\n        </el-form-item>\n        <el-form-item v-show=\"isReceiveTime\" label=\"\">\n          <el-date-picker\n            clearable\n            v-model=\"datetime2\"\n            type=\"datetimerange\"\n            value-format=\"yyyy/MM/dd HH:mm:ss\"\n            style=\"width: 380px\"\n            range-separator=\"-\"\n            start-placeholder=\"开始日期\"\n            end-placeholder=\"结束日期\"\n            @change=\"timeChange\"\n            :disabled=\"isEdit\"\n          ></el-date-picker>\n        </el-form-item>\n        <el-form-item label=\"优惠券发布数量：\" v-show=\"formData.receive_type == 1\">\n          <el-radio-group v-model=\"formData.is_permanent\" :disabled=\"isEdit\">\n            <el-radio :label=\"0\">限量</el-radio>\n            <el-radio :label=\"1\">不限量</el-radio>\n          </el-radio-group>\n        </el-form-item>\n        <el-form-item v-show=\"!formData.is_permanent\" label=\"\">\n          <el-input-number\n            :controls=\"false\"\n            :min=\"isEdit ? formData.total_count : 1\"\n            :max=\"9999999999\"\n            v-model=\"formData.total_count\"\n            :precision=\"0\"\n            class=\"content_width input-number-unit-class\"\n            class-unit=\"张\"\n          ></el-input-number>\n          <div class=\"info\">填写优惠券的发布数量</div>\n        </el-form-item>\n        <el-form-item label=\"用户领取数量：\" v-if=\"formData.receive_type != 2 && formData.receive_type != 3\">\n          <el-input-number\n            :controls=\"false\"\n            :min=\"isEdit ? formData.receive_limit : 1\"\n            :max=\"9999999999\"\n            v-model=\"formData.receive_limit\"\n            :precision=\"0\"\n            class=\"content_width input-number-unit-class\"\n            class-unit=\"张\"\n          ></el-input-number>\n          <div class=\"info\">填写每个用户可以领取多少张</div>\n        </el-form-item>\n        <el-form-item label=\"状态：\">\n          <el-radio-group v-model=\"formData.status\">\n            <el-radio :label=\"1\">开启</el-radio>\n            <el-radio :label=\"0\">关闭</el-radio>\n          </el-radio-group>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" v-db-click @click=\"save\" :disabled=\"disabled\">{{\n            isEdit ? '立即保存' : '立即创建'\n          }}</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n    <el-dialog :visible.sync=\"modals\" title=\"商品列表\" class=\"paymentFooter\" width=\"1000px\">\n      <goods-list ref=\"goodslist\" v-if=\"modals\" :ischeckbox=\"true\" @getProductId=\"getProductId\"></goods-list>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport goodsList from '@/components/goodsList/index';\nimport { couponSaveApi, couponDetailApi } from '@/api/marketing';\nimport { cascaderListApi } from '@/api/product';\nexport default {\n  name: 'storeCouponCreate',\n  components: {\n    goodsList,\n  },\n  data() {\n    return {\n      disabled: false,\n      formData: {\n        coupon_title: '',\n        coupon_price: 0,\n        type: 0,\n        use_min_price: 0,\n        coupon_time: 0,\n        start_use_time: 0,\n        end_use_time: 0,\n        start_time: 0,\n        end_time: 0,\n        user_type: 1,\n        receive_type: 1,\n        is_permanent: 1,\n        total_count: 1,\n        sort: 0,\n        status: 1,\n        product_id: '',\n        category_id: 0,\n        receive_limit: 1,\n      },\n      categoryList: [],\n      productList: [],\n      isMinPrice: 0,\n      isCouponTime: 1,\n      isReceiveTime: 0,\n      modals: false,\n      datetime1: ['2023-10-18 00:00:00', '2023-11-22 00:00:00'],\n      datetime2: [],\n    };\n  },\n  computed: {\n    ...mapState('media', ['isMobile']),\n    isEdit() {\n      return !!this.$route.params.edit;\n    },\n  },\n  created() {\n    this.getCategoryList();\n    if (this.$route.params.id) {\n      this.formData.id = (this.isEdit && Number(this.$route.params.id)) || 0;\n      this.getCouponDetail();\n    }\n  },\n  methods: {\n    changeUserType() {\n      if (this.formData.user_type == 2) {\n        this.formData.receive_type = 1;\n      }\n    },\n    // 品类\n    getCategoryList() {\n      cascaderListApi(1).then(async (res) => {\n        this.categoryList = res.data;\n      });\n    },\n    // 优惠券\n    getCouponDetail() {\n      couponDetailApi(this.$route.params.id)\n        .then((res) => {\n          let data = res.data;\n          this.formData.coupon_title = data.coupon_title;\n          this.formData.type = data.type;\n          this.formData.category_id = data.category_id;\n          this.formData.coupon_price = parseFloat(data.coupon_price);\n          this.formData.use_min_price = parseFloat(data.use_min_price);\n          if (this.formData.use_min_price) {\n            this.isMinPrice = 1;\n          }\n          this.formData.coupon_time = data.coupon_time;\n          this.formData.receive_type = data.receive_type;\n          this.formData.user_type = data.user_type;\n          this.formData.is_permanent = data.is_permanent;\n          this.formData.status = data.status;\n          this.formData.product_id = data.product_id;\n          this.formData.start_time = data.start_time;\n          this.formData.end_time = data.end_time;\n          this.formData.total_count = data.total_count;\n          this.formData.sort = data.sort;\n          this.formData.receive_limit = data.receive_limit;\n          if ('productInfo' in data) {\n            this.productList = data.productInfo;\n          }\n          if (!data.coupon_time) {\n            this.isCouponTime = 0;\n            this.datetime1 = [this.makeDate(data.start_use_time * 1000), this.makeDate(data.end_use_time * 1000)];\n            this.formData.start_use_time = this.makeDate(data.start_use_time * 1000);\n            this.formData.end_use_time = this.makeDate(data.end_use_time * 1000);\n          }\n          if (data.start_time) {\n            this.isReceiveTime = 1;\n            this.datetime2 = [data.start_time * 1000, data.end_time * 1000];\n            this.formData.start_time = this.makeDate(data.start_time * 1000);\n            this.formData.end_time = this.makeDate(data.end_time * 1000);\n          }\n        })\n        .catch((err) => {\n          this.$message.error(err.msg);\n        });\n    },\n    makeDate(data) {\n      let date = new Date(data);\n      let YY = date.getFullYear() + '-';\n      let MM = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '-';\n      let DD = date.getDate() < 10 ? '0' + date.getDate() : date.getDate();\n      let hh = (date.getHours() < 10 ? '0' + date.getHours() : date.getHours()) + ':';\n      let mm = (date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes()) + ':';\n      let ss = date.getSeconds() < 10 ? '0' + date.getSeconds() : date.getSeconds();\n      return YY + MM + DD + ' ' + hh + mm + ss;\n    },\n    // 创建\n    save() {\n      if (!this.formData.coupon_title) {\n        return this.$message.error('请输入优惠券名称');\n      }\n      if (this.formData.type === 2) {\n        if (!this.formData.product_id) {\n          return this.$message.error('请选择商品');\n        }\n      }\n      if (this.formData.type === 1) {\n        if (!this.formData.category_id) {\n          return this.$message.error('请选择品类');\n        }\n      }\n      if (this.formData.coupon_price <= 0) {\n        return this.$message.error('优惠券面值不能小于0');\n      }\n      if (!this.isMinPrice) {\n        this.formData.use_min_price = 0;\n      } else {\n        if (this.formData.use_min_price < 1) {\n          return this.$message.error('优惠券最低消费不能小于0');\n        }\n      }\n      if (this.isCouponTime) {\n        this.formData.start_use_time = 0;\n        this.formData.end_use_time = 0;\n        if (this.formData.coupon_time < 1) {\n          return this.$message.error('使用有效期限不能小于1天');\n        }\n      } else {\n        this.formData.coupon_time = 0;\n        if (!this.formData.start_use_time) {\n          return this.$message.error('请选择使用有效期限');\n        }\n      }\n      if (this.isReceiveTime) {\n        if (!this.formData.start_time) {\n          return this.$message.error('请选择领取时间');\n        }\n      } else {\n        this.formData.start_time = 0;\n        this.formData.end_time = 0;\n      }\n      // if (this.formData.receive_type == 2 || this.formData.receive_type == 3) {\n      //   this.formData.is_permanent = 1;\n      // }\n      if (this.formData.is_permanent) {\n        this.formData.total_count = 0;\n      } else {\n        if (this.formData.total_count < 1) {\n          return this.$message.error('发布数量不能小于1');\n        }\n      }\n      if (this.formData.receive_limit < 1) {\n        return this.$message.error('每个用户可以领取数量不能小于1');\n      }\n      if (this.formData.type == 0) {\n        this.formData.product_id = '';\n        this.formData.category_id = '';\n        this.productList = [];\n      } else if (this.formData.type == 1) {\n        this.formData.product_id = '';\n        this.productList = [];\n      } else if (this.formData.type == 2) {\n        this.formData.category_id = '';\n      }\n      if (this.disabled) return;\n      this.disabled = true;\n      couponSaveApi(this.formData)\n        .then((res) => {\n          this.$message.success(res.msg);\n          setTimeout(() => {\n            this.disabled = false;\n            this.$router.push({\n              path: this.$routeProStr + '/marketing/store_coupon_issue/index',\n            });\n          }, 1000);\n        })\n        .catch((err) => {\n          this.disabled = false;\n          this.$message.error(err.msg);\n        });\n    },\n    // 使用有效期--时间段\n    dateChange(time) {\n      this.formData.start_use_time = time[0];\n      this.formData.end_use_time = time[1];\n    },\n    // 限时\n    timeChange(time) {\n      this.formData.start_time = time[0];\n      this.formData.end_time = time[1];\n    },\n    //对象数组去重；\n    unique(arr) {\n      const res = new Map();\n      return arr.filter((arr) => !res.has(arr.product_id) && res.set(arr.product_id, 1));\n    },\n    // 选择的商品\n    getProductId(productList) {\n      this.modals = false;\n      this.productList = this.unique(this.productList.concat(productList));\n      this.formData.product_id = '';\n      this.productList.forEach((value) => {\n        if (this.formData.product_id) {\n          this.formData.product_id += `,${value.product_id}`;\n        } else {\n          this.formData.product_id += `${value.product_id}`;\n        }\n      });\n    },\n    cancel() {\n      this.modals = false;\n    },\n    // 删除商品\n    remove(productId) {\n      for (let index = 0; index < this.productList.length; index++) {\n        if (this.productList[index].product_id == productId) {\n          this.productList.splice(index, 1);\n        }\n      }\n      this.formData.product_id = '';\n      this.productList.forEach((value) => {\n        if (this.formData.product_id) {\n          this.formData.product_id += `,${value.product_id}`;\n        } else {\n          this.formData.product_id += `${value.product_id}`;\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.content_width {\n  width: 414px;\n}\n\n.info {\n  color: #888;\n  font-size: 12px;\n}\n\n.pictrue {\n  width: 60px;\n  height: 60px;\n  border: 1px dotted rgba(0, 0, 0, 0.1);\n  margin-right: 15px;\n  display: inline-block;\n  position: relative;\n  cursor: pointer;\n\n  img {\n    width: 100%;\n    height: 100%;\n  }\n\n  .btndel {\n    position: absolute;\n    z-index: 1;\n    width: 20px !important;\n    height: 20px !important;\n    left: 46px;\n    top: -4px;\n  }\n}\n\n.upLoad {\n  width: 58px;\n  height: 58px;\n  line-height: 58px;\n  border: 1px dotted rgba(0, 0, 0, 0.1);\n  border-radius: 4px;\n  background: rgba(0, 0, 0, 0.02);\n  cursor: pointer;\n}\n\n.ivu-icon-ios-close-circle {\n  position: absolute;\n  top: 0;\n  right: 0;\n  transform: translate(50%, -50%);\n}\n\n.tip {\n  color: #888;\n  font-size: 12px;\n  line-height: 16px;\n}\n</style>\n"]}]}