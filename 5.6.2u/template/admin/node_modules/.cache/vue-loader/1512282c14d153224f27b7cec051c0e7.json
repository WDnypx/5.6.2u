{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\user\\level\\handle\\task.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\user\\level\\handle\\task.vue","mtime":1711590189068},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1753254258567},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IG1hcFN0YXRlLCBtYXBNdXRhdGlvbnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IHsgdGFza0xpc3RBcGksIHNldFRhc2tTaG93QXBpLCBzZXRUYXNrTXVzdEFwaSwgY3JlYXRlVGFza0FwaSB9IGZyb20gJ0AvYXBpL3VzZXInOwppbXBvcnQgZWRpdEZyb20gZnJvbSAnQC9jb21wb25lbnRzL2Zyb20vZnJvbSc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAndGFzaycsCiAgY29tcG9uZW50czogeyBlZGl0RnJvbSB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICAvLyBsZXZlbElkczogdGhpcy5sZXZlbElkLAogICAgICBncmlkOiB7CiAgICAgICAgeGw6IDEwLAogICAgICAgIGxnOiAxMCwKICAgICAgICBtZDogMTIsCiAgICAgICAgc206IDI0LAogICAgICAgIHhzOiAyNCwKICAgICAgfSwKICAgICAgbW9kYWxzOiBmYWxzZSwKICAgICAgbGV2ZWxGcm9tOiB7CiAgICAgICAgaXNfc2hvdzogJycsCiAgICAgICAgbmFtZTogJycsCiAgICAgICAgcGFnZTogMSwKICAgICAgICBsaW1pdDogMjAsCiAgICAgIH0sCiAgICAgIHRvdGFsOiAwLAogICAgICBsZXZlbExpc3RzOiBbXSwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIEZyb21EYXRhOiBudWxsLAogICAgICBpZHM6IDAsCiAgICAgIG1vZGFsVGl0bGVTczogJycsCiAgICAgIHRpdGxlVHlwZTogJ3Rhc2snLAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZSgnbWVkaWEnLCBbJ2lzTW9iaWxlJ10pLAogICAgLi4ubWFwU3RhdGUoJ3VzZXJMZXZlbCcsIFsnbGV2ZWxJZCddKSwKICAgIGxhYmVsV2lkdGgoKSB7CiAgICAgIHJldHVybiB0aGlzLmlzTW9iaWxlID8gdW5kZWZpbmVkIDogJzgwcHgnOwogICAgfSwKICAgIGxhYmVsUG9zaXRpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmlzTW9iaWxlID8gJ3RvcCcgOiAncmlnaHQnOwogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIC4uLm1hcE11dGF0aW9ucygndXNlckxldmVsJywgWydnZXRUYXNrSWQnLCAnZ2V0bGV2ZWxJZCddKSwKICAgIC8vIOa3u+WKoAogICAgYWRkKCkgewogICAgICB0aGlzLmlkcyA9ICcnOwogICAgICB0aGlzLmdldEZyb20oKTsKICAgIH0sCiAgICAvLyDmlrDlu7og57yW6L6R6KGo5Y2VCiAgICBnZXRGcm9tKCkgewogICAgICBsZXQgZGF0YSA9IHsKICAgICAgICBpZDogdGhpcy5pZHMsCiAgICAgICAgbGV2ZWxfaWQ6IHRoaXMubGV2ZWxJZCwKICAgICAgfTsKICAgICAgdGhpcy4kbW9kYWxGb3JtKGNyZWF0ZVRhc2tBcGkoZGF0YSkpLnRoZW4oKCkgPT4gdGhpcy5nZXRMaXN0KCkpOwogICAgfSwKICAgIC8vIOe8lui+kQogICAgZWRpdChyb3cpIHsKICAgICAgdGhpcy5pZHMgPSByb3cuaWQ7CiAgICAgIHRoaXMuZ2V0RnJvbSgpOwogICAgfSwKICAgIC8vIOWFs+mXreaooeaAgeahhgogICAgaGFuZGxlUmVzZXQoKSB7CiAgICAgIHRoaXMubW9kYWxzID0gZmFsc2U7CiAgICB9LAogICAgLy8g6KGo5qC85pCc57SiCiAgICB1c2VyU2VhcmNocygpIHsKICAgICAgdGhpcy5nZXRMaXN0KCk7CiAgICB9LAogICAgLy8g5Lu75Yqh5YiX6KGoCiAgICBnZXRMaXN0KCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgICB0aGlzLmxldmVsRnJvbS5pc19zaG93ID0gdGhpcy5sZXZlbEZyb20uaXNfc2hvdyB8fCAnJzsKICAgICAgdGFza0xpc3RBcGkodGhpcy5sZXZlbElkLCB0aGlzLmxldmVsRnJvbSkKICAgICAgICAudGhlbihhc3luYyAocmVzKSA9PiB7CiAgICAgICAgICBsZXQgZGF0YSA9IHJlcy5kYXRhOwogICAgICAgICAgdGhpcy5sZXZlbExpc3RzID0gZGF0YS5saXN0OwogICAgICAgICAgdGhpcy50b3RhbCA9IHJlcy5kYXRhLmNvdW50OwogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKHJlcykgPT4gewogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICAgIH0pOwogICAgfSwKICAgIC8vIOS/ruaUueaYvuekuumakOiXjwogICAgb25jaGFuZ2VJc1Nob3cocm93KSB7CiAgICAgIGxldCBkYXRhID0gewogICAgICAgIGlkOiByb3cuaWQsCiAgICAgICAgaXNfc2hvdzogcm93LmlzX3Nob3csCiAgICAgIH07CiAgICAgIHNldFRhc2tTaG93QXBpKGRhdGEpCiAgICAgICAgLnRoZW4oYXN5bmMgKHJlcykgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHJlcy5tc2cpOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1zZyk7CiAgICAgICAgfSk7CiAgICB9LAogICAgLy8g6K6+572u5Lu75Yqh5piv5ZCm6L6+5oiQCiAgICBvbmNoYW5nZUlzTXVzdChyb3cpIHsKICAgICAgbGV0IGRhdGEgPSB7CiAgICAgICAgaWQ6IHJvdy5pZCwKICAgICAgICBpc19tdXN0OiByb3cuaXNfbXVzdCwKICAgICAgfTsKICAgICAgc2V0VGFza011c3RBcGkoZGF0YSkKICAgICAgICAudGhlbihhc3luYyAocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MocmVzLm1zZyk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKHJlcykgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubXNnKTsKICAgICAgICB9KTsKICAgIH0sCiAgICAvLyDmlrDlu7rnvJbovpHmj5DkuqTmiJDlip8KICAgIHN1Ym1pdEZhaWwoKSB7CiAgICAgIHRoaXMuZ2V0TGlzdCgpOwogICAgfSwKICAgIC8vIOWIoOmZpOS7u+WKoQogICAgZGVsKHJvdywgdGl0LCBudW0pIHsKICAgICAgbGV0IGRlbGZyb21EYXRhID0gewogICAgICAgIHRpdGxlOiB0aXQsCiAgICAgICAgbnVtOiBudW0sCiAgICAgICAgdXJsOiBgdXNlci91c2VyX2xldmVsL2RlbGV0ZV90YXNrLyR7cm93LmlkfWAsCiAgICAgICAgbWV0aG9kOiAnREVMRVRFJywKICAgICAgICBpZHM6ICcnLAogICAgICB9OwogICAgICB0aGlzLiRtb2RhbFN1cmUoZGVsZnJvbURhdGEpCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHJlcy5tc2cpOwogICAgICAgICAgdGhpcy5sZXZlbExpc3RzLnNwbGljZShudW0sIDEpOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1zZyk7CiAgICAgICAgfSk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["task.vue"],"names":[],"mappings":";AAiIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"task.vue","sourceRoot":"src/pages/user/level/handle","sourcesContent":["<template>\n  <el-dialog :visible.sync=\"modals\" title=\"等级任务\" :close-on-click-modal=\"false\" width=\"1000px\" @closed=\"handleReset\">\n    <el-form\n      ref=\"levelFrom\"\n      :model=\"levelFrom\"\n      :label-width=\"labelWidth\"\n      :label-position=\"labelPosition\"\n      @submit.native.prevent\n    >\n      <el-row :gutter=\"24\">\n        <el-col v-bind=\"grid\">\n          <el-form-item label=\"等级状态：\">\n            <el-select v-model=\"levelFrom.is_show\" placeholder=\"是否显示\" clearable @change=\"userSearchs\">\n              <el-option value=\"1\" label=\"显示\"></el-option>\n              <el-option value=\"0\" label=\"不显示\"></el-option>\n            </el-select>\n          </el-form-item>\n        </el-col>\n        <el-col v-bind=\"grid\">\n          <el-form-item label=\"等级名称：\" prop=\"status2\" label-for=\"status2\">\n            <el-input\n              search\n              enter-button\n              v-model=\"levelFrom.name\"\n              placeholder=\"请输入等级名称\"\n              @on-search=\"userSearchs\"\n              style=\"width: 100%\"\n            />\n          </el-form-item>\n        </el-col>\n      </el-row>\n    </el-form>\n    <el-divider direction=\"vertical\" dashed />\n    <el-row>\n      <el-col v-bind=\"grid\" class=\"mb15\">\n        <el-button type=\"primary\" v-db-click @click=\"add\">添加等级任务</el-button>\n      </el-col>\n      <el-col :span=\"24\" class=\"userAlert\">\n        <el-alert show-icon closable>\n          <template slot=\"title\">\n            <div>添加等级任务,任务类型中的{$num}会自动替换成限定数量+系统预设的单位生成任务名</div>\n          </template>\n        </el-alert>\n      </el-col>\n    </el-row>\n    <el-divider direction=\"vertical\" dashed />\n    <el-table\n      :data=\"levelLists\"\n      ref=\"table\"\n      v-loading=\"loading\"\n      no-userFrom-text=\"暂无数据\"\n      no-filtered-userFrom-text=\"暂无筛选结果\"\n    >\n      <el-table-column label=\"ID\" width=\"80\">\n        <template slot-scope=\"scope\">\n          <span>{{ scope.row.id }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"等级名称\" min-width=\"130\">\n        <template slot-scope=\"scope\">\n          <span>{{ scope.row.level_name }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"任务名称\" min-width=\"130\">\n        <template slot-scope=\"scope\">\n          <span>{{ scope.row.name }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"是否显示\" min-width=\"130\">\n        <template slot-scope=\"scope\">\n          <el-switch\n            class=\"defineSwitch\"\n            :active-value=\"1\"\n            :inactive-value=\"0\"\n            v-model=\"scope.row.is_show\"\n            :value=\"scope.row.is_show\"\n            size=\"large\"\n            @change=\"onchangeIsShow(scope.row)\"\n            active-text=\"显示\"\n            inactive-text=\"隐藏\"\n          >\n          </el-switch>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"务必达成\" min-width=\"130\">\n        <template slot-scope=\"scope\">\n          <el-switch\n            class=\"defineSwitch\"\n            :active-value=\"1\"\n            :inactive-value=\"0\"\n            v-model=\"scope.row.is_must\"\n            :value=\"scope.row.is_must\"\n            :true-value=\"1\"\n            :false-value=\"0\"\n            size=\"large\"\n            @change=\"onchangeIsMust(scope.row)\"\n            active-text=\"全部\"\n            inactive-text=\"其一\"\n          >\n          </el-switch>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"任务说明\" min-width=\"130\">\n        <template slot-scope=\"scope\">\n          <span>{{ scope.row.illustrate }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\" fixed=\"right\" width=\"170\">\n        <template slot-scope=\"scope\">\n          <a v-db-click @click=\"edit(scope.row)\">编辑 | </a>\n          <a v-db-click @click=\"del(scope.row, '删除等级任务', index)\"> 删除</a>\n        </template>\n      </el-table-column>\n    </el-table>\n    <div class=\"acea-row row-right page\">\n      <pagination\n        v-if=\"total\"\n        :total=\"total\"\n        :page.sync=\"levelFrom.page\"\n        :limit.sync=\"levelFrom.limit\"\n        @pagination=\"getList\"\n      />\n    </div>\n    <!-- 新建 编辑表单-->\n    <edit-from ref=\"edits\" :FromData=\"FromData\" @submitFail=\"submitFail\" :titleType=\"titleType\"></edit-from>\n  </el-dialog>\n</template>\n\n<script>\nimport { mapState, mapMutations } from 'vuex';\nimport { taskListApi, setTaskShowApi, setTaskMustApi, createTaskApi } from '@/api/user';\nimport editFrom from '@/components/from/from';\nexport default {\n  name: 'task',\n  components: { editFrom },\n  data() {\n    return {\n      // levelIds: this.levelId,\n      grid: {\n        xl: 10,\n        lg: 10,\n        md: 12,\n        sm: 24,\n        xs: 24,\n      },\n      modals: false,\n      levelFrom: {\n        is_show: '',\n        name: '',\n        page: 1,\n        limit: 20,\n      },\n      total: 0,\n      levelLists: [],\n      loading: false,\n      FromData: null,\n      ids: 0,\n      modalTitleSs: '',\n      titleType: 'task',\n    };\n  },\n  computed: {\n    ...mapState('media', ['isMobile']),\n    ...mapState('userLevel', ['levelId']),\n    labelWidth() {\n      return this.isMobile ? undefined : '80px';\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'right';\n    },\n  },\n  methods: {\n    ...mapMutations('userLevel', ['getTaskId', 'getlevelId']),\n    // 添加\n    add() {\n      this.ids = '';\n      this.getFrom();\n    },\n    // 新建 编辑表单\n    getFrom() {\n      let data = {\n        id: this.ids,\n        level_id: this.levelId,\n      };\n      this.$modalForm(createTaskApi(data)).then(() => this.getList());\n    },\n    // 编辑\n    edit(row) {\n      this.ids = row.id;\n      this.getFrom();\n    },\n    // 关闭模态框\n    handleReset() {\n      this.modals = false;\n    },\n    // 表格搜索\n    userSearchs() {\n      this.getList();\n    },\n    // 任务列表\n    getList() {\n      this.loading = true;\n      this.levelFrom.is_show = this.levelFrom.is_show || '';\n      taskListApi(this.levelId, this.levelFrom)\n        .then(async (res) => {\n          let data = res.data;\n          this.levelLists = data.list;\n          this.total = res.data.count;\n          this.loading = false;\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$message.error(res.msg);\n        });\n    },\n    // 修改显示隐藏\n    onchangeIsShow(row) {\n      let data = {\n        id: row.id,\n        is_show: row.is_show,\n      };\n      setTaskShowApi(data)\n        .then(async (res) => {\n          this.$message.success(res.msg);\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 设置任务是否达成\n    onchangeIsMust(row) {\n      let data = {\n        id: row.id,\n        is_must: row.is_must,\n      };\n      setTaskMustApi(data)\n        .then(async (res) => {\n          this.$message.success(res.msg);\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 新建编辑提交成功\n    submitFail() {\n      this.getList();\n    },\n    // 删除任务\n    del(row, tit, num) {\n      let delfromData = {\n        title: tit,\n        num: num,\n        url: `user/user_level/delete_task/${row.id}`,\n        method: 'DELETE',\n        ids: '',\n      };\n      this.$modalSure(delfromData)\n        .then((res) => {\n          this.$message.success(res.msg);\n          this.levelLists.splice(num, 1);\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n  },\n};\n</script>\n\n<style scoped></style>\n"]}]}