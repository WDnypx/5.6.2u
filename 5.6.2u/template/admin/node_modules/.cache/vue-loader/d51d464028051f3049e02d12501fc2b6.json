{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\product\\productList\\components\\goodsImport.vue?vue&type=style&index=0&id=8453a830&lang=scss&scoped=true","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\product\\productList\\components\\goodsImport.vue","mtime":1731313973090},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\css-loader\\index.js","mtime":1753254259822},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1753254262918},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\postcss-loader\\src\\index.js","mtime":1753254258547},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1753254255270},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5kb3dubG9hZCB7CiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tcHJldi1jb2xvci1wcmltYXJ5LWxpZ2h0LTkpOwogIHBhZGRpbmc6IDEycHg7CiAgYm9yZGVyLXJhZGl1czogNHB4OwogIGNvbG9yOiAjMzAzMTMzOwogIGZvbnQtc2l6ZTogMTJweDsKICBpbWcgewogICAgd2lkdGg6IDE5cHg7CiAgICBoZWlnaHQ6IDE5cHg7CiAgICBtYXJnaW46IDAgNHB4IDAgOHB4OwogIH0KICAuZG93bmxvYWQtdGV4dCB7CiAgICBjb2xvcjogdmFyKC0tcHJldi1jb2xvci1wcmltYXJ5KTsKICB9Cn0KLmdvb2RzLXVwbG9hZCB7CiAgd2lkdGg6IDEwMCU7CiAgOjp2LWRlZXAgLmVsLXVwbG9hZCB7CiAgICB3aWR0aDogMTAwJTsKICAgIC5lbC11cGxvYWQtZHJhZ2dlciB7CiAgICAgIHdpZHRoOiAxMDAlOwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgcGFkZGluZzogMTcwcHggMDsKICAgICAgLmVsLXVwbG9hZC1kcmFnZ2VyX19pY29uIHsKICAgICAgICB3aWR0aDogNDJweDsKICAgICAgICBoZWlnaHQ6IDU3cHg7CiAgICAgIH0KICAgICAgLmVsLXVwbG9hZF9fdHJpcCB7CiAgICAgICAgZm9udC13ZWlnaHQ6IDQwMDsKICAgICAgICBmb250LXNpemU6IDEycHg7CiAgICAgICAgY29sb3I6ICM5OTk5OTk7CiAgICAgICAgbWFyZ2luLXRvcDogNnB4OwogICAgICB9CiAgICB9CiAgfQogIC5maWxlLWluZm8gewogICAgaGVpZ2h0OiAzNDJweDsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgYm9yZGVyOiAxcHggZGFzaGVkICNkOWQ5ZDk7CiAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICBtYXJnaW4tdG9wOiAxMHB4OwogICAgLmFjdGl2ZS1idG4gewogICAgICBjb2xvcjogdmFyKC0tcHJldi1jb2xvci1wcmltYXJ5KTsKICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgICBmb250LXdlaWdodDogNDAwOwogICAgICBtYXJnaW46IDAgNnB4OwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICB9CiAgICAuYnRuLWltcG9ydCB7CiAgICAgIG1hcmdpbi10b3A6IDI2cHg7CiAgICB9CiAgICAuZWwtdXBsb2FkLWRyYWdnZXJfX2ljb24gewogICAgICB3aWR0aDogNDJweDsKICAgICAgaGVpZ2h0OiA1N3B4OwogICAgfQogICAgLmVsLXVwbG9hZF9fdHJpcCB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGZvbnQtd2VpZ2h0OiA0MDA7CiAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgY29sb3I6ICM5OTk7CiAgICAgIG1hcmdpbi10b3A6IDZweDsKICAgIH0KICB9Cn0KLmltcG9ydC1ydWxlIHsKICAucnVsZS10aXRsZSB7CiAgICBmb250LXdlaWdodDogNTAwOwogICAgZm9udC1zaXplOiAxNHB4OwogICAgY29sb3I6ICMzMDMxMzM7CiAgICBtYXJnaW4tYm90dG9tOiA2cHg7CiAgfQogIC5ydWxlLXRleHQgewogICAgZm9udC1zaXplOiAxMnB4OwogICAgY29sb3I6ICMzMDMxMzM7CiAgfQp9Cg=="},{"version":3,"sources":["goodsImport.vue"],"names":[],"mappings":";AAyKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"goodsImport.vue","sourceRoot":"src/pages/product/productList/components","sourcesContent":["<!-- 商品导入 -->\n<template>\n  <div class=\"goods-import\">\n    <!-- 下载模板 -->\n    <div class=\"download acea-row row-middle\">\n      <span>上传前请先按Excel模板中的格式编辑内容</span>\n      <img src=\"@/assets/images/excel-icon.png\" alt=\"\" />\n      <a href=\"/product_migration.xlsx\" download class=\"download-text cup\">下载Excel模板</a>\n    </div>\n\n    <div class=\"goods-upload mt20\">\n      <el-upload\n        v-show=\"!fileUrl && !importStatus\"\n        ref=\"upload\"\n        class=\"upload-demo\"\n        :drag=\"!fileUrl\"\n        :show-file-list=\"false\"\n        :action=\"uploadUrl\"\n        :headers=\"header\"\n        :before-upload=\"fileChange\"\n        :on-success=\"handleSuccess\"\n        accept=\".xls, .xlsx\"\n      >\n        <template>\n          <img class=\"el-upload-dragger__icon mb20\" src=\"@/assets/images/upload-icon.png\" alt=\"\" />\n          <div class=\"el-upload__text\">将文件拖到此处，或<em>点击添加</em></div>\n          <div class=\"el-upload__trip\">支持 .xls，.xlsx，限10M以内</div>\n        </template>\n      </el-upload>\n      <div v-show=\"fileUrl && !importStatus\" class=\"file-info\">\n        <img class=\"el-upload-dragger__icon mb20\" src=\"@/assets/images/upload-icon.png\" alt=\"\" />\n        <div class=\"el-upload__text\">{{ fileName }}</div>\n        <div class=\"flex mt12\" v-if=\"fileUrl && !importLoading\">\n          <div class=\"active-btn\" @click=\"selectFile\">重新上传</div>\n          <div class=\"active-btn\" @click=\"fileUrl = ''\">删除</div>\n        </div>\n        <div class=\"el-upload__trip\" v-if=\"importLoading\">\n          正在导入，您可关闭当前弹窗，稍候可在列表查看导入结果\n          <i class=\"el-icon-loading\"></i>\n        </div>\n        <el-button v-else class=\"btn-import\" type=\"primary\" size=\"small\" @click=\"importGoods\">立即导入</el-button>\n      </div>\n      <div v-show=\"fileUrl && importStatus\" class=\"file-info\">\n        <img class=\"el-upload-dragger__icon mb20\" :src=\"statusImage\" alt=\"\" />\n        <div class=\"el-upload__text\">\n          共导入 {{ resultData.all }} 个，成功 {{ resultData.success }} 个，失败 {{ resultData.fail }} 跳过\n          {{ resultData.jump }} 个\n        </div>\n        <div class=\"el-upload__trip\" v-if=\"resultData.fail > 0\">\n          您可以下载失败数据，修改后再重新导入 <span class=\"active-btn\" @click=\"downloadFailData\">下载失败数据</span>\n        </div>\n        <div>\n          <el-button class=\"btn-import\" size=\"small\" @click=\"selectFile\">再次导入</el-button>\n          <el-button type=\"primary\" class=\"btn-import\" @click=\"close\">完成</el-button>\n        </div>\n      </div>\n    </div>\n    <!-- 导入规则 -->\n    <div class=\"import-rule mt20\">\n      <div class=\"rule-title\">导入规则</div>\n      <!-- 1. 请先下载模板，在模板中按字段填写信息，然后上传该文件。\n2. 导入未完成之前，请勿关闭页面，否则可能数据错误。\n3. 文件大小不超过10MB。\n4. 限制导入10000行记录，超出部分请分多次导入。 -->\n      <div class=\"rule-text\">1. 请先下载模板，在模板中按字段填写信息，然后上传该文件。</div>\n      <div class=\"rule-text\">2. 导入未完成之前，请勿关闭页面，否则可能数据错误。</div>\n      <div class=\"rule-text\">3. 文件大小不超过10MB。</div>\n      <div class=\"rule-text\">4. 限制导入10000行记录，超出部分请分多次导入。</div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { importProductImport } from '@/api/export';\nimport Setting from '@/setting';\nimport { getCookies } from '@/libs/util';\nimport { isXlsUpload } from '@/utils/index';\n\nexport default {\n  name: 'goodsImport',\n  data() {\n    return {\n      uploadUrl: Setting.apiBaseURL + '/file/upload/1',\n      header: {\n        'Authori-zation': 'Bearer ' + getCookies('token'),\n      },\n      fileName: '',\n      fileUrl: '',\n      importStatus: false,\n      importLoading: false,\n      resultData: {\n        all: 0,\n        success: 0,\n        fail: 0,\n        jump: 0,\n      },\n      statusImage: require('@/assets/images/file-success.png'),\n    };\n  },\n  watch: {\n    resultData: {\n      handler(newValue) {\n        if (newValue.fail > 0) {\n          this.statusImage = require('@/assets/images/file-fail.png');\n        } else {\n          this.statusImage = require('@/assets/images/file-success.png');\n        }\n      },\n      deep: true, // 默认值是 false，代表是否深度监听\n    },\n  },\n  mounted() {},\n  methods: {\n    fileChange(file, fileList) {\n      if (isXlsUpload(file)) {\n        // 限制10M\n        if (file.size >= 10485760) {\n          this.$message.error('文件大小不能超过10MB');\n          return false;\n        } else {\n          this.fileName = file.name;\n        }\n      } else {\n        return false;\n      }\n    },\n    selectFile() {\n      this.importStatus = false;\n      this.importLoading = false;\n      // 调起选择文件\n      this.$refs['upload'].$refs['upload-inner'].handleClick();\n    },\n    handleSuccess(res, file, fileList) {\n      console.log(res, '2');\n      if (res.status === 200) {\n        this.fileUrl = res.data.src;\n      }\n    },\n    importGoods() {\n      this.importLoading = true;\n      this.importStatus = false;\n      importProductImport({\n        file: this.fileUrl,\n      })\n        .then((res) => {\n          // 返回导入结果\n          this.importStatus = true;\n          this.resultData = res.data;\n        })\n        .catch((err) => {\n          this.importLoading = false;\n          this.importStatus = false;\n          this.$message.error(err.msg);\n        });\n    },\n    close() {\n      this.fileUrl = '';\n      this.fileName = '';\n      this.importStatus = false;\n      this.$emit('close');\n    },\n    downloadFailData() {\n      // 下载失败数据\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.download {\n  background-color: var(--prev-color-primary-light-9);\n  padding: 12px;\n  border-radius: 4px;\n  color: #303133;\n  font-size: 12px;\n  img {\n    width: 19px;\n    height: 19px;\n    margin: 0 4px 0 8px;\n  }\n  .download-text {\n    color: var(--prev-color-primary);\n  }\n}\n.goods-upload {\n  width: 100%;\n  ::v-deep .el-upload {\n    width: 100%;\n    .el-upload-dragger {\n      width: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      flex-direction: column;\n      padding: 170px 0;\n      .el-upload-dragger__icon {\n        width: 42px;\n        height: 57px;\n      }\n      .el-upload__trip {\n        font-weight: 400;\n        font-size: 12px;\n        color: #999999;\n        margin-top: 6px;\n      }\n    }\n  }\n  .file-info {\n    height: 342px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n    border: 1px dashed #d9d9d9;\n    border-radius: 4px;\n    margin-top: 10px;\n    .active-btn {\n      color: var(--prev-color-primary);\n      font-size: 12px;\n      font-weight: 400;\n      margin: 0 6px;\n      cursor: pointer;\n    }\n    .btn-import {\n      margin-top: 26px;\n    }\n    .el-upload-dragger__icon {\n      width: 42px;\n      height: 57px;\n    }\n    .el-upload__trip {\n      display: flex;\n      align-items: center;\n      font-weight: 400;\n      font-size: 12px;\n      color: #999;\n      margin-top: 6px;\n    }\n  }\n}\n.import-rule {\n  .rule-title {\n    font-weight: 500;\n    font-size: 14px;\n    color: #303133;\n    margin-bottom: 6px;\n  }\n  .rule-text {\n    font-size: 12px;\n    color: #303133;\n  }\n}\n</style>\n"]}]}