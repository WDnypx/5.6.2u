{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\setting\\user\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\setting\\user\\index.vue","mtime":1711590189061},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1753254258567},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IHVwZHRhZUFkbWluIH0gZnJvbSAnQC9hcGkvdXNlcic7CmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCc7CmltcG9ydCBDcm9wcGVySW1nIGZyb20gJ0AvY29tcG9uZW50cy9jcm9wcGVySW1nJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdzZXR0aW5nX3VzZXInLAogIGNvbXBvbmVudHM6IHsgQ3JvcHBlckltZyB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZSgnbWVkaWEnLCBbJ2lzTW9iaWxlJ10pLAogICAgLi4ubWFwU3RhdGUoJ3VzZXJMZXZlbCcsIFsnY2F0ZWdvcnlJZCddKSwKICAgIGxhYmVsV2lkdGgoKSB7CiAgICAgIHJldHVybiB0aGlzLmlzTW9iaWxlID8gdW5kZWZpbmVkIDogJzgwcHgnOwogICAgfSwKICAgIGxhYmVsUG9zaXRpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmlzTW9iaWxlID8gJ3RvcCcgOiAncmlnaHQnOwogICAgfSwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhY2NvdW50OiAnJywKICAgICAgYXZhdGFyTW9hZGw6IGZhbHNlLAogICAgICBmb3JtVmFsaWRhdGU6IHsKICAgICAgICBhdmF0YXI6ICcnLAogICAgICAgIHJlYWxfbmFtZTogJycsCiAgICAgICAgcHdkOiAnJywKICAgICAgICBuZXdfcHdkOiAnJywKICAgICAgICBjb25mX3B3ZDogJycsCiAgICAgIH0sCiAgICAgIHJ1bGVWYWxpZGF0ZTogewogICAgICAgIHJlYWxfbmFtZTogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfmgqjnmoTlp5PlkI3kuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnYmx1cicgfV0sCiAgICAgIH0sCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuYWNjb3VudCA9IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJJbmZvLnVzZXJJbmZvLmFjY291bnQ7CiAgICB0aGlzLmZvcm1WYWxpZGF0ZS5oZWFkX3BpYyA9IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJJbmZvLnVzZXJJbmZvLmhlYWRfcGljOwogICAgdGhpcy5mb3JtVmFsaWRhdGUucmVhbF9uYW1lID0gdGhpcy4kc3RvcmUuc3RhdGUudXNlckluZm8udXNlckluZm8ucmVhbF9uYW1lOwogIH0sCiAgbWV0aG9kczogewogICAgdXBsb2FkSW1nU3VjY2VzcyhkYXRhKSB7CiAgICAgIHRoaXMuYXZhdGFyTW9hZGwgPSBmYWxzZTsKICAgICAgdGhpcy5mb3JtVmFsaWRhdGUuaGVhZF9waWMgPSBkYXRhLnNyYzsKICAgIH0sCiAgICBoYW5kbGVTdWJtaXQobmFtZSkgewogICAgICB0aGlzLiRyZWZzW25hbWVdLnZhbGlkYXRlKCh2YWxpZCkgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgdXBkdGFlQWRtaW4odGhpcy5mb3JtVmFsaWRhdGUpCiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3VzZXJJbmZvL3VzZXJSZWFsTmFtZScsIHRoaXMuZm9ybVZhbGlkYXRlLnJlYWxfbmFtZSk7CiAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCd1c2VySW5mby91c2VyUmVhbEhlYWRQaWMnLCB0aGlzLmZvcm1WYWxpZGF0ZS5oZWFkX3BpYyk7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHJlcy5tc2cpOwogICAgICAgICAgICB9KQogICAgICAgICAgICAuY2F0Y2goKHJlcykgPT4gewogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1zZyk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAodGhpcy5mb3JtVmFsaWRhdGUubmV3X3B3ZCAhPT0gdGhpcy5mb3JtVmFsaWRhdGUuY29uZl9wd2QpIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5oKo6L6T5YWl55qE5paw5a+G56CB5LiO5pen5a+G56CB5LiN5LiA6Ie0Jyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AA2CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/setting/user","sourcesContent":["<template>\n  <div>\n    <el-card :bordered=\"false\" shadow=\"never\" class=\"ivu-mt\">\n      <el-form\n        ref=\"formValidate\"\n        :model=\"formValidate\"\n        :rules=\"ruleValidate\"\n        label-width=\"160px\"\n        label-position=\"right\"\n      >\n        <el-form-item label=\"头像：\">\n          <div class=\"avatar\" v-db-click @click=\"avatarMoadl = true\">\n            <img v-if=\"formValidate.head_pic\" :src=\"formValidate.head_pic\" alt=\"\" />\n            <img v-else src=\"../../../assets/images/f.png\" alt=\"\" />\n          </div>\n        </el-form-item>\n        <el-form-item label=\"账号：\" prop=\"\">\n          <el-input type=\"text\" v-model=\"account\" :disabled=\"true\" class=\"input\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"姓名：\" prop=\"real_name\">\n          <el-input type=\"text\" v-model=\"formValidate.real_name\" class=\"input\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"原始密码：\">\n          <el-input type=\"password\" v-model=\"formValidate.pwd\" class=\"input\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"新密码：\">\n          <el-input type=\"password\" v-model=\"formValidate.new_pwd\" class=\"input\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"确认新密码：\">\n          <el-input type=\"password\" v-model=\"formValidate.conf_pwd\" class=\"input\"></el-input>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" v-db-click @click=\"handleSubmit('formValidate')\">提交</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n    <el-dialog :visible.sync=\"avatarMoadl\" title=\"头像上传\" width=\"720px\">\n      <CropperImg v-if=\"avatarMoadl\" @uploadImgSuccess=\"uploadImgSuccess\"></CropperImg>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { updtaeAdmin } from '@/api/user';\nimport { mapState } from 'vuex';\nimport CropperImg from '@/components/cropperImg';\nexport default {\n  name: 'setting_user',\n  components: { CropperImg },\n  computed: {\n    ...mapState('media', ['isMobile']),\n    ...mapState('userLevel', ['categoryId']),\n    labelWidth() {\n      return this.isMobile ? undefined : '80px';\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'right';\n    },\n  },\n  data() {\n    return {\n      account: '',\n      avatarMoadl: false,\n      formValidate: {\n        avatar: '',\n        real_name: '',\n        pwd: '',\n        new_pwd: '',\n        conf_pwd: '',\n      },\n      ruleValidate: {\n        real_name: [{ required: true, message: '您的姓名不能为空', trigger: 'blur' }],\n      },\n    };\n  },\n  mounted() {\n    this.account = this.$store.state.userInfo.userInfo.account;\n    this.formValidate.head_pic = this.$store.state.userInfo.userInfo.head_pic;\n    this.formValidate.real_name = this.$store.state.userInfo.userInfo.real_name;\n  },\n  methods: {\n    uploadImgSuccess(data) {\n      this.avatarMoadl = false;\n      this.formValidate.head_pic = data.src;\n    },\n    handleSubmit(name) {\n      this.$refs[name].validate((valid) => {\n        if (valid) {\n          updtaeAdmin(this.formValidate)\n            .then((res) => {\n              this.$store.commit('userInfo/userRealName', this.formValidate.real_name);\n              this.$store.commit('userInfo/userRealHeadPic', this.formValidate.head_pic);\n              this.$message.success(res.msg);\n            })\n            .catch((res) => {\n              this.$message.error(res.msg);\n            });\n        } else {\n          if (this.formValidate.new_pwd !== this.formValidate.conf_pwd) {\n            this.$message.error('您输入的新密码与旧密码不一致');\n          }\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.input {\n  width: 400px;\n}\n.avatar {\n  width: 80px;\n  height: 80px;\n  img {\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    border: 1px solid #f2f2f2;\n  }\n}\n</style>\n"]}]}