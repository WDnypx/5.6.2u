{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\setting\\setSystem\\index.vue?vue&type=style&index=0&id=31e0bd3e&scoped=true&lang=scss","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\setting\\setSystem\\index.vue","mtime":1726708129071},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\css-loader\\index.js","mtime":1753254259822},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1753254262918},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\postcss-loader\\src\\index.js","mtime":1753254258547},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1753254255270},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Cjo6di1kZWVwIC5lbC10YWJzX19oZWFkZXIgewogIG1hcmdpbjogdW5zZXQ7Cn0KOjp2LWRlZXAgLmVsLXRhYnNfX2l0ZW0gewogIGhlaWdodDogNTRweCAhaW1wb3J0YW50OwogIGxpbmUtaGVpZ2h0OiA1NHB4ICFpbXBvcnRhbnQ7Cn0KOjp2LWRlZXAgLmVsLWlucHV0LW51bWJlciB7CiAgd2lkdGg6IDQxNHB4Owp9Cjo6di1kZWVwIC5lbC1pbnB1dCB7CiAgd2lkdGg6IDQxNHB4Owp9Cjo6di1kZWVwIC5lbC1pbnB1dC1udW1iZXIgLmVsLWlucHV0X19pbm5lciB7CiAgdGV4dC1hbGlnbjogdW5zZXQ7Cn0KLml2dS10YWJzIHsKICBtYXJnaW4tYm90dG9tOiAxOHB4Owp9CgouZnJvbUJveCB7CiAgbWluLWhlaWdodDogY2FsYygxMDB2aCAtIDIwMHB4KTsKICBtYXJnaW4tdG9wOiAwcHggIWltcG9ydGFudDsKfQoKLmFydGljbGUtbWFuYWdlciA6OnYtZGVlcCAuaXZ1LWZvcm0taXRlbSB7CiAgbWFyZ2luLWJvdHRvbTogMjBweCAhaW1wb3J0YW50Owp9Ci8vIDo6di1kZWVwIC5mb3JtLWNyZWF0ZSAuZWwtYnV0dG9uewovLyAgIGZsb2F0OiByaWdodDsKLy8gfQpib2R5IDo6di1kZWVwIC5lbC1kaWFsb2cgLmVsLWRpYWxvZ19faGVhZGVyIHsKICBib3JkZXI6IG5vbmUgIWltcG9ydGFudDsKfQo6OnYtZGVlcCAuZWwtZm9ybS1pdGVtLS1zbWFsbCAuZWwtZm9ybS1pdGVtX19sYWJlbCB7CiAgbGluZS1oZWlnaHQ6IDE0cHg7CiAgLy8gbWFyZ2luLXRvcDogMTBweDsKfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AA6PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/setting/setSystem","sourcesContent":["<template>\n  <div v-loading=\"spinShow\">\n    <div class=\"i-layout-page-header header-title\" v-if=\"!headerList.length\">\n      <span class=\"ivu-page-header-title\">{{ $route.meta.title }}</span>\n    </div>\n    <div class=\"article-manager\">\n      <el-card :bordered=\"false\" shadow=\"never\" class=\"ivu-mt fromBox\" :body-style=\"{ padding: '0 20px 20px' }\">\n        <el-tabs v-model=\"currentTab\" @tab-click=\"changeTab\" v-if=\"headerList.length\">\n          <el-tab-pane\n            :icon=\"item.icon\"\n            :label=\"item.label\"\n            :name=\"item.value.toString()\"\n            v-for=\"(item, index) in headerList\"\n            :key=\"index\"\n          />\n        </el-tabs>\n        <el-tabs v-model=\"childrenId\" v-if=\"headerChildrenList.length\">\n          <el-tab-pane\n            :label=\"item.label\"\n            :name=\"item.id.toString()\"\n            v-for=\"(item, index) in headerChildrenList\"\n            :key=\"index\"\n          ></el-tab-pane>\n        </el-tabs>\n        <form-create\n          :option=\"option\"\n          :rule=\"rules\"\n          @submit=\"onSubmit\"\n          v-if=\"rules.length\"\n          style=\"padding-top: 20px\"\n        ></form-create>\n      </el-card>\n    </div>\n  </div>\n</template>\n\n<script>\nimport formCreate from '@form-create/element-ui';\nimport { headerListApi, dataFromApi } from '@/api/setting';\nimport request from '@/libs/request';\nimport { getLogo } from '@/api/common';\nexport default {\n  name: 'setting_setSystem',\n  components: { formCreate: formCreate.$form() },\n  data() {\n    return {\n      rules: [],\n      option: {\n        form: {\n          labelWidth: '120px',\n        },\n        submitBtn: {\n          col: {\n            span: 3,\n            push: 3,\n          },\n        },\n        global: {\n          upload: {\n            props: {\n              onSuccess(res, file) {\n                if (res.status === 200) {\n                  file.url = res.data.src;\n                } else {\n                  this.$message.error(res.msg);\n                }\n              },\n            },\n          },\n          frame: {\n            props: {\n              closeBtn: false,\n              okBtn: false,\n            },\n          },\n        },\n      },\n      spinShow: false,\n      FromData: null,\n      currentTab: '',\n      headerList: [],\n      headerChildrenList: [],\n      childrenId: '',\n      title: '',\n    };\n  },\n  created() {\n    this.getAllData();\n  },\n  watch: {\n    $route(to, from) {\n      this.headerChildrenList = [];\n      this.getAllData();\n    },\n    childrenId() {\n      this.getFrom();\n    },\n  },\n  methods: {\n    childrenList(index) {\n      let that = this;\n      that.headerList.forEach(function (item) {\n        if (item.value.toString() === that.currentTab) {\n          if (item.children === undefined) {\n            that.childrenId = item.id;\n            that.headerChildrenList = [];\n          } else {\n            that.headerChildrenList = item.children;\n            that.childrenId = item.children.length ? item.children[index ? index : 0].id.toString() : '';\n          }\n        }\n      });\n    },\n    // 头部tab\n    getHeader(index) {\n      this.spinShow = true;\n      return new Promise((resolve, reject) => {\n        if (this.$route.query.tab_id) {\n          this.currentTab = this.$route.query.tab_id;\n        }\n        let tab_id = this.$route.params.tab_id ? this.$route.params.tab_id : this.$route.query.tab_id;\n        let data = {\n          type: this.$route.params.type ? this.$route.params.type : 0,\n          pid: tab_id ? tab_id : 0,\n        };\n        headerListApi(data)\n          .then(async (res) => {\n            let config = res.data.config_tab;\n            this.headerList = config;\n            if (!this.currentTab) {\n            }\n            if (this.$route.query.tab_id) {\n              this.currentTab = this.$route.query.tab_id;\n            } else {\n              this.currentTab = config[index ? index : 0].value.toString();\n            }\n            this.childrenList(index ? 1 : 0);\n            resolve(this.currentTab);\n            this.spinShow = false;\n          })\n          .catch((err) => {\n            this.spinShow = false;\n            this.$message.error(err);\n          });\n      });\n    },\n    // 表单\n    getFrom() {\n      this.spinShow = true;\n      return new Promise((resolve, reject) => {\n        let ids = '';\n        if (this.$route.params.type === '3') {\n          ids = this.$route.params.tab_id;\n        } else {\n          if (this.childrenId) {\n            ids = this.childrenId;\n          } else {\n            ids = this.currentTab;\n          }\n        }\n        let data = {\n          tab_id: Number(ids),\n        };\n        let logistics = 'freight/config/edit_basics',\n          agent = 'agent/config/edit_basics',\n          integral = 'marketing/integral_config/edit_basics',\n          sms = 'serve/sms_config/edit_basics',\n          config = 'setting/config/edit_basics';\n        let url =\n          this.$route.name === 'setting_logistics'\n            ? logistics\n            : this.$route.name === 'setting_distributionSet'\n            ? agent\n            : this.$route.name === 'setting_message'\n            ? sms\n            : this.$route.name === 'setting_setSystem'\n            ? config\n            : integral;\n        dataFromApi(data, url)\n          .then(async (res) => {\n            this.spinShow = false;\n            if (res.data.status === false) {\n              return this.$authLapse(res.data);\n            }\n            this.FromData = res.data;\n            // res.data.rules.forEach((e) => {\n            //   e.title += ':';\n            //   if (e.control) {\n            //   }\n            // });\n            this.addColon(res.data.rules);\n            this.rules = res.data.rules;\n            this.title = res.data.title;\n          })\n          .catch((res) => {\n            this.spinShow = false;\n            this.$message.error(res.msg);\n          });\n      });\n    },\n    addColon(arr) {\n      for (let i = 0; i < arr.length; i++) {\n        const c = arr[i];\n        c.title += ':';\n        if (c.control) {\n          for (let j = 0; j < c.control.length; j++) {\n            const e = c.control[j];\n            if (e.rule.length) {\n              this.addColon(e.rule);\n            }\n          }\n        }\n      }\n    },\n    async getAllData() {\n      if (this.$route.query.from === 'download') {\n        await this.getHeader(2);\n      } else if (this.$route.params.type !== '3') {\n        this.childrenId = '';\n        await this.getHeader();\n      } else {\n        this.headerList = [];\n        this.getFrom();\n      }\n    },\n    // 选择\n    changeTab() {\n      this.childrenList();\n    },\n    // 提交表单 group\n    onSubmit(formData) {\n      request({\n        url: this.FromData.action,\n        method: this.FromData.method,\n        data: formData,\n      })\n        .then((res) => {\n          this.$message.success(res.msg);\n          if (formData.site_name) {\n            localStorage.setItem('ADMIN_TITLE', formData.site_name);\n            this.$store.commit('setAdminTitle', formData.site_name);\n            window.document.title = `${formData.site_name} - 系统设置`;\n          }\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n::v-deep .el-tabs__header {\n  margin: unset;\n}\n::v-deep .el-tabs__item {\n  height: 54px !important;\n  line-height: 54px !important;\n}\n::v-deep .el-input-number {\n  width: 414px;\n}\n::v-deep .el-input {\n  width: 414px;\n}\n::v-deep .el-input-number .el-input__inner {\n  text-align: unset;\n}\n.ivu-tabs {\n  margin-bottom: 18px;\n}\n\n.fromBox {\n  min-height: calc(100vh - 200px);\n  margin-top: 0px !important;\n}\n\n.article-manager ::v-deep .ivu-form-item {\n  margin-bottom: 20px !important;\n}\n// ::v-deep .form-create .el-button{\n//   float: right;\n// }\nbody ::v-deep .el-dialog .el-dialog__header {\n  border: none !important;\n}\n::v-deep .el-form-item--small .el-form-item__label {\n  line-height: 14px;\n  // margin-top: 10px;\n}\n</style>\n"]}]}