{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\marketing\\storeSeckill\\create.vue?vue&type=style&index=0&id=e309f040&lang=scss&scoped=true","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\marketing\\storeSeckill\\create.vue","mtime":1740118394129},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\css-loader\\index.js","mtime":1753254259822},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1753254262918},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\postcss-loader\\src\\index.js","mtime":1753254258547},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1753254255270},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5jb250ZW50X3dpZHRoIHsKICB3aWR0aDogNDYwcHg7Cn0KLm1heFcgOjp2LWRlZXAgLml2dS1zZWxlY3QtZHJvcGRvd24gewogIG1heC13aWR0aDogNjAwcHg7Cn0KLmdyZXkgewogIGNvbG9yOiAjOTk5OwogIGZvbnQtc2l6ZTogMTJweDsKfQoudGFiQm94X2ltZyB7CiAgd2lkdGg6IDUwcHg7CiAgaGVpZ2h0OiA1MHB4OwogIG1hcmdpbjogMCBhdXRvOwp9Ci50YWJCb3hfaW1nIGltZyB7CiAgd2lkdGg6IDEwMCU7CiAgaGVpZ2h0OiAxMDAlOwp9Ci5wcmljZUJveCB7CiAgd2lkdGg6IDEwMCU7Cn0KLmZvcm0gewogIC5waWNCb3ggewogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgY3Vyc29yOiBwb2ludGVyOwogIH0KICAucGljdHJ1ZSB7CiAgICB3aWR0aDogNjBweDsKICAgIGhlaWdodDogNjBweDsKICAgIGJvcmRlcjogMXB4IGRvdHRlZCByZ2JhKDAsIDAsIDAsIDAuMSk7CiAgICBtYXJnaW4tcmlnaHQ6IDE1cHg7CiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICBjdXJzb3I6IHBvaW50ZXI7CgogICAgaW1nIHsKICAgICAgd2lkdGg6IDEwMCU7CiAgICAgIGhlaWdodDogMTAwJTsKICAgIH0KICAgIC5idG5kZWwgewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHotaW5kZXg6IDk7CiAgICAgIHdpZHRoOiAyMHB4ICFpbXBvcnRhbnQ7CiAgICAgIGhlaWdodDogMjBweCAhaW1wb3J0YW50OwogICAgICBsZWZ0OiA0NnB4OwogICAgICB0b3A6IC00cHg7CiAgICB9CiAgfQogIC51cExvYWQgewogICAgd2lkdGg6IDU4cHg7CiAgICBoZWlnaHQ6IDU4cHg7CiAgICBsaW5lLWhlaWdodDogNThweDsKICAgIGJvcmRlcjogMXB4IGRvdHRlZCByZ2JhKDAsIDAsIDAsIDAuMSk7CiAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuMDIpOwogICAgY3Vyc29yOiBwb2ludGVyOwogIH0KICAuY29sIHsKICAgIGNvbG9yOiAjMmQ4Y2YwOwogICAgY3Vyc29yOiBwb2ludGVyOwogIH0KfQouYWRkZm9udCB7CiAgZm9udC1zaXplOiAxMnB4OwogIGNvbG9yOiB2YXIoLS1wcmV2LWNvbG9yLXByaW1hcnkpOwogIG1hcmdpbi1sZWZ0OiAxNHB4OwogIGN1cnNvcjogcG9pbnRlcjsKICBtYXJnaW4tbGVmdDogMTBweDsKICBjdXJzb3I6IHBvaW50ZXI7Cn0K"},{"version":3,"sources":["create.vue"],"names":[],"mappings":";AA43BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"create.vue","sourceRoot":"src/pages/marketing/storeSeckill","sourcesContent":["<template>\n  <div v-loading=\"spinShow\">\n    <pages-header\n      ref=\"pageHeader\"\n      :title=\"$route.params.id ? '编辑秒杀商品' : '添加秒杀商品'\"\n      :backUrl=\"$routeProStr + '/marketing/store_seckill/index'\"\n    ></pages-header>\n    <el-card :bordered=\"false\" shadow=\"never\" class=\"mt16\">\n      <el-row class=\"mt30 acea-row row-middle row-center\">\n        <el-col :span=\"20\">\n          <steps :stepList=\"stepList\" :isActive=\"current\"></steps>\n        </el-col>\n        <el-col :span=\"23\">\n          <el-form\n            class=\"form mt30\"\n            ref=\"formValidate\"\n            :model=\"formValidate\"\n            :rules=\"ruleValidate\"\n            @on-validate=\"validate\"\n            :label-width=\"labelWidth\"\n            :label-position=\"labelPosition\"\n            @submit.native.prevent\n          >\n            <el-form-item label=\"选择商品：\" prop=\"image_input\" v-if=\"current === 0\">\n              <div class=\"picBox\" v-db-click @click=\"changeGoods\">\n                <div class=\"pictrue\" v-if=\"formValidate.image\">\n                  <img v-lazy=\"formValidate.image\" />\n                </div>\n                <div class=\"upLoad acea-row row-center-wrapper\" v-else>\n                  <i class=\"el-icon-goods\" style=\"font-size: 24px\"></i>\n                </div>\n              </div>\n            </el-form-item>\n            <el-col v-show=\"current === 1\">\n              <el-col :span=\"24\">\n                <el-form-item label=\"商品轮播图：\" prop=\"images\">\n                  <div class=\"acea-row\">\n                    <div\n                      class=\"pictrue\"\n                      v-for=\"(item, index) in formValidate.images\"\n                      :key=\"index\"\n                      draggable=\"true\"\n                      @dragstart=\"handleDragStart($event, item)\"\n                      @dragover.prevent=\"handleDragOver($event, item)\"\n                      @dragenter=\"handleDragEnter($event, item)\"\n                      @dragend=\"handleDragEnd($event, item)\"\n                    >\n                      <img v-lazy=\"item\" />\n                      <i class=\"el-icon-circle-close btndel\" v-db-click @click=\"handleRemove(index)\"></i>\n                    </div>\n                    <div\n                      v-if=\"formValidate.images.length < 10\"\n                      class=\"upLoad acea-row row-center-wrapper\"\n                      v-db-click\n                      @click=\"modalPicTap('duo')\"\n                    >\n                      <i class=\"el-icon-picture-outline\" style=\"font-size: 24px\"></i>\n                    </div>\n                  </div>\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"24\">\n                <el-col v-bind=\"grid\">\n                  <el-form-item label=\"商品标题：\" prop=\"title\" label-for=\"title\">\n                    <el-input\n                      clearable\n                      placeholder=\"请输入商品标题\"\n                      v-model=\"formValidate.title\"\n                      class=\"content_width\"\n                      maxlength=\"80\"\n                      show-word-limit\n                    />\n                  </el-form-item>\n                </el-col>\n              </el-col>\n              <el-col :span=\"24\">\n                <el-col v-bind=\"grid\">\n                  <el-form-item label=\"秒杀活动简介：\" prop=\"info\" label-for=\"info\">\n                    <el-input\n                      placeholder=\"请输入秒杀活动简介\"\n                      type=\"textarea\"\n                      :rows=\"4\"\n                      v-model=\"formValidate.info\"\n                      class=\"content_width\"\n                      maxlength=\"100\"\n                      show-word-limit\n                    />\n                  </el-form-item>\n                </el-col>\n              </el-col>\n              <el-col :span=\"24\">\n                <el-form-item label=\"活动时间：\" prop=\"section_time\">\n                  <div>\n                    <el-date-picker\n                      clearable\n                      :editable=\"false\"\n                      type=\"daterange\"\n                      format=\"yyyy-MM-dd\"\n                      value-format=\"yyyy-MM-dd\"\n                      range-separator=\"-\"\n                      start-placeholder=\"开始日期\"\n                      end-placeholder=\"结束日期\"\n                      @change=\"onchangeTime\"\n                      class=\"content_width\"\n                      v-model=\"formValidate.section_time\"\n                    ></el-date-picker>\n                    <div class=\"grey\">设置活动开启结束时间，用户可以在有效时间内参与秒杀</div>\n                  </div>\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"24\" v-if=\"formValidate.virtual_type == 0\">\n                <el-form-item label=\"物流方式：\" prop=\"logistics\">\n                  <el-checkbox-group v-model=\"formValidate.logistics\">\n                    <el-checkbox label=\"1\">快递</el-checkbox>\n                    <el-checkbox label=\"2\">到店</el-checkbox>\n                  </el-checkbox-group>\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"24\" v-if=\"formValidate.virtual_type == 0\">\n                <el-form-item label=\"运费设置：\" :prop=\"formValidate.freight != 1 ? 'freight' : ''\">\n                  <el-radio-group v-model=\"formValidate.freight\">\n                    <el-radio :label=\"2\">固定邮费</el-radio>\n                    <el-radio :label=\"3\">运费模板</el-radio>\n                  </el-radio-group>\n                </el-form-item>\n              </el-col>\n              <el-col\n                :span=\"24\"\n                v-if=\"formValidate.freight != 3 && formValidate.freight != 1 && formValidate.virtual_type == 0\"\n              >\n                <el-form-item label=\"\">\n                  <div class=\"acea-row\">\n                    <el-input-number\n                      :controls=\"false\"\n                      :min=\"0\"\n                      :max=\"9999999999\"\n                      v-model=\"formValidate.postage\"\n                      placeholder=\"请输入金额\"\n                      class=\"content_width input-number-unit-class\"\n                      class-unit=\"元\"\n                    />\n                  </div>\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"24\" v-if=\"formValidate.freight == 3 && formValidate.virtual_type == 0\">\n                <el-form-item label=\"\" prop=\"temp_id\">\n                  <div class=\"acea-row\">\n                    <el-select\n                      v-model=\"formValidate.temp_id\"\n                      clearable\n                      placeholder=\"请选择运费模板\"\n                      class=\"content_width\"\n                    >\n                      <el-option\n                        v-for=\"(item, index) in templateList\"\n                        :value=\"item.id\"\n                        :key=\"index\"\n                        :label=\"item.name\"\n                      ></el-option>\n                    </el-select>\n                    <span class=\"addfont\" v-db-click @click=\"freight\">新增运费模板</span>\n                  </div>\n                </el-form-item>\n              </el-col>\n\n              <el-col :span=\"24\">\n                <el-form-item label=\"开始时间：\" prop=\"time_id\">\n                  <div>\n                    <el-select v-model=\"formValidate.time_id\" multiple class=\"content_width\">\n                      <el-option\n                        v-for=\"item in timeList\"\n                        :value=\"item.id\"\n                        :key=\"item.id\"\n                        :label=\"item.time_name\"\n                      ></el-option>\n                    </el-select>\n                    <div class=\"grey\">\n                      选择产品开始时间段，该时间段内用户可参与购买；其它时间段会显示活动未开始或已结束。如活动超过一天，则活动期内，每天都会定时开启\n                    </div>\n                  </div>\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"24\">\n                <el-form-item label=\"总购买数量限制：\" prop=\"num\">\n                  <div>\n                    <el-input-number\n                      :controls=\"false\"\n                      :min=\"1\"\n                      placeholder=\"请输入数量限制\"\n                      element-id=\"num\"\n                      :precision=\"0\"\n                      :max=\"10000\"\n                      v-model=\"formValidate.num\"\n                      class=\"content_width\"\n                    />\n                    <div class=\"grey\">\n                      活动有效期内每个用户可购买该商品总数限制。例如设置为4，表示本次活动有效期内，每个用户最多可购买总数4个\n                    </div>\n                  </div>\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"24\">\n                <el-form-item label=\"单次购买数量限制：\" prop=\"once_num\">\n                  <div>\n                    <el-input-number\n                      :controls=\"false\"\n                      :min=\"1\"\n                      placeholder=\"请输入单次购买数量限制\"\n                      element-id=\"once_num\"\n                      :precision=\"0\"\n                      :max=\"10000\"\n                      v-model=\"formValidate.once_num\"\n                      class=\"content_width\"\n                    />\n                    <div class=\"grey\">\n                      用户参与秒杀时，一次购买最大数量限制。例如设置为2，表示参与秒杀时，用户一次购买数量最大可选择2个\n                    </div>\n                  </div>\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"24\">\n                <el-form-item label=\"单位：\" prop=\"unit_name\" label-for=\"unit_name\">\n                  <el-input\n                    placeholder=\"请输入单位\"\n                    element-id=\"unit_name\"\n                    v-model=\"formValidate.unit_name\"\n                    class=\"content_width\"\n                  />\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"24\">\n                <el-form-item label=\"排序：\">\n                  <el-input-number\n                    :controls=\"false\"\n                    placeholder=\"请输入排序\"\n                    element-id=\"sort\"\n                    :precision=\"0\"\n                    :max=\"10000\"\n                    :min=\"0\"\n                    v-model=\"formValidate.sort\"\n                    class=\"content_width\"\n                  />\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"24\">\n                <el-form-item label=\"秒杀是否参与分销：\" props=\"is_commission\" label-for=\"is_commission\">\n                  <div>\n                    <el-switch\n                      class=\"defineSwitch\"\n                      :active-value=\"1\"\n                      :inactive-value=\"0\"\n                      v-model=\"formValidate.is_commission\"\n                      size=\"large\"\n                      active-text=\"开启\"\n                      inactive-text=\"关闭\"\n                    >\n                    </el-switch>\n                    <div class=\"grey\">商品是否参与商城分销返佣</div>\n                  </div>\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"24\">\n                <el-form-item label=\"活动状态：\" props=\"status\" label-for=\"status\">\n                  <el-switch\n                    class=\"defineSwitch\"\n                    :active-value=\"1\"\n                    :inactive-value=\"0\"\n                    v-model=\"formValidate.status\"\n                    size=\"large\"\n                    active-text=\"开启\"\n                    inactive-text=\"关闭\"\n                  >\n                  </el-switch>\n                </el-form-item>\n              </el-col>\n              <el-col :span=\"24\">\n                <el-form-item label=\"规格选择：\">\n                  <el-table\n                    ref=\"multipleTable\"\n                    :row-key=\"getRowKeys\"\n                    :data=\"specsData\"\n                    border\n                    @selection-change=\"changeCheckbox\"\n                  >\n                    <el-table-column type=\"selection\" :reserve-selection=\"true\" width=\"55\"> </el-table-column>\n                    <el-table-column\n                      :label=\"item.title\"\n                      :min-width=\"item.minWidth\"\n                      v-for=\"(item, index) in columns\"\n                      :key=\"index\"\n                    >\n                      <template slot-scope=\"scope\">\n                        <template v-if=\"item.key\">\n                          <div>\n                            <span>{{ scope.row[item.key] }}</span>\n                          </div>\n                        </template>\n                        <template v-else-if=\"item.slot === 'pic'\">\n                          <div\n                            class=\"acea-row row-middle row-center-wrapper\"\n                            v-db-click\n                            @click=\"modalPicTap('dan', 'danTable', scope.$index)\"\n                          >\n                            <div class=\"pictrue pictrueTab\" v-if=\"scope.row.pic\">\n                              <img v-lazy=\"scope.row.pic\" />\n                            </div>\n                            <div class=\"upLoad pictrueTab acea-row row-center-wrapper\" v-else>\n                              <i class=\"el-icon-picture-outline\" style=\"font-size: 24px\"></i>\n                            </div>\n                          </div>\n                        </template>\n                        <template v-else-if=\"item.slot === 'price'\">\n                          <el-input-number\n                            :controls=\"false\"\n                            v-model=\"scope.row.price\"\n                            :min=\"0\"\n                            :precision=\"2\"\n                            class=\"priceBox\"\n                            :active-change=\"false\"\n                          ></el-input-number>\n                        </template>\n                        <template v-else-if=\"item.slot === 'quota'\">\n                          <el-input-number\n                            :controls=\"false\"\n                            v-model=\"scope.row.quota\"\n                            :min=\"1\"\n                            active-change\n                            class=\"priceBox\"\n                          ></el-input-number>\n                        </template>\n                      </template>\n                    </el-table-column>\n                  </el-table>\n                </el-form-item>\n              </el-col>\n            </el-col>\n            <el-row v-show=\"current === 2\">\n              <el-col :span=\"24\">\n                <el-form-item label=\"内容：\">\n                  <WangEditor style=\"width: 90%\" :content=\"formValidate.description\" @editorContent=\"getEditorContent\">\n                  </WangEditor>\n                </el-form-item>\n              </el-col>\n            </el-row>\n            <el-col :span=\"24\">\n              <el-form-item>\n                <el-button\n                  class=\"submission\"\n                  v-db-click\n                  @click=\"step\"\n                  :disabled=\"($route.params.id && current === 1) || current === 0\"\n                  >上一步\n                </el-button>\n                <el-button\n                  :disabled=\"submitOpen && current === 2\"\n                  type=\"primary\"\n                  class=\"submission\"\n                  v-db-click\n                  @click=\"next('formValidate')\"\n                  >{{ current === 2 ? '提交' : '下一步' }}</el-button\n                >\n              </el-form-item>\n            </el-col>\n          </el-form>\n        </el-col>\n      </el-row>\n    </el-card>\n    <!-- 选择商品-->\n    <el-dialog :visible.sync=\"modals\" title=\"商品列表\" class=\"paymentFooter\" width=\"1000px\">\n      <goods-list ref=\"goodslist\" @getProductId=\"getProductId\"></goods-list>\n    </el-dialog>\n    <!-- 上传图片-->\n    <el-dialog :visible.sync=\"modalPic\" width=\"950px\" title=\"上传商品图\" :close-on-click-modal=\"false\">\n      <uploadPictures\n        :isChoice=\"isChoice\"\n        @getPic=\"getPic\"\n        @getPicD=\"getPicD\"\n        :gridBtn=\"gridBtn\"\n        :gridPic=\"gridPic\"\n        v-if=\"modalPic\"\n      ></uploadPictures>\n    </el-dialog>\n    <!-- 运费模板-->\n    <freight-template ref=\"template\" @addSuccess=\"productGetTemplate\"></freight-template>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport goodsList from '@/components/goodsList/index';\nimport WangEditor from '@/components/wangEditor/index.vue';\nimport uploadPictures from '@/components/uploadPictures';\nimport { seckillInfoApi, seckillAddApi, seckillTimeListApi, productAttrsApi } from '@/api/marketing';\nimport { productGetTemplateApi } from '@/api/product';\nimport freightTemplate from '@/components/freightTemplate/index';\nimport steps from '@/components/steps/index';\n\nexport default {\n  name: 'storeSeckillCreate',\n  components: {\n    goodsList,\n    uploadPictures,\n    WangEditor,\n    freightTemplate,\n    steps,\n  },\n  data() {\n    return {\n      stepList: ['选择秒杀商品', '填写基础信息', '修改商品详情'],\n      submitOpen: false,\n      spinShow: false,\n      isChoice: '',\n      current: 0,\n      modalPic: false,\n      grid: {\n        xl: 12,\n        lg: 20,\n        md: 24,\n        sm: 24,\n        xs: 24,\n      },\n      grid2: {\n        xl: 8,\n        lg: 12,\n        md: 12,\n        sm: 24,\n        xs: 24,\n      },\n      gridPic: {\n        xl: 6,\n        lg: 8,\n        md: 12,\n        sm: 12,\n        xs: 12,\n      },\n      gridBtn: {\n        xl: 4,\n        lg: 8,\n        md: 8,\n        sm: 8,\n        xs: 8,\n      },\n      myConfig: {\n        autoHeightEnabled: false, // 编辑器不自动被内容撑高\n        initialFrameHeight: 500, // 初始容器高度\n        initialFrameWidth: '100%', // 初始容器宽度\n        UEDITOR_HOME_URL: '/UEditor/',\n        serverUrl: '',\n      },\n      modals: false,\n      modal_loading: false,\n      images: [],\n      formValidate: {\n        images: [],\n        info: '',\n        title: '',\n        image: '',\n        unit_name: '',\n        price: 0,\n        logistics: ['1'], //选择物流方式\n        freight: 2, //运费设置\n        postage: 1, //设置运费金额\n        ot_price: 0,\n        cost: 0,\n        sales: 0,\n        stock: 0,\n        sort: 0,\n        num: 1,\n        once_num: 1,\n        give_integral: 0,\n        postage: 0,\n        section_time: [],\n        is_postage: 0,\n        is_hot: 0,\n        status: 0,\n        description: '',\n        id: 0,\n        product_id: 0,\n        temp_id: '',\n        time_id: [],\n        attrs: [],\n        items: [],\n        is_commission: 0,\n      },\n      description: '',\n      templateList: [],\n      timeList: [],\n      columns: [],\n      specsData: [],\n      picTit: '',\n      tableIndex: 0,\n      ruleValidate: {\n        image: [{ required: true, message: '请选择主图', trigger: 'change' }],\n        images: [\n          {\n            required: true,\n            type: 'array',\n            message: '请选择主图',\n            trigger: 'change',\n          },\n          {\n            type: 'array',\n            min: 1,\n            message: 'Choose two hobbies at best',\n            trigger: 'change',\n          },\n        ],\n        title: [{ required: true, message: '请输入商品标题', trigger: 'blur' }],\n        info: [{ required: true, message: '请输入秒杀活动简介', trigger: 'blur' }],\n        section_time: [\n          {\n            required: true,\n            type: 'array',\n            message: '请选择活动时间',\n            trigger: 'change',\n          },\n        ],\n        unit_name: [{ required: true, message: '请输入单位', trigger: 'blur' }],\n        price: [\n          {\n            required: true,\n            type: 'number',\n            message: '请输入秒杀价',\n            trigger: 'blur',\n          },\n        ],\n        ot_price: [\n          {\n            required: true,\n            type: 'number',\n            message: '请输入原价',\n            trigger: 'blur',\n          },\n        ],\n        cost: [\n          {\n            required: true,\n            type: 'number',\n            message: '请输入成本价',\n            trigger: 'blur',\n          },\n        ],\n        stock: [\n          {\n            required: true,\n            type: 'number',\n            message: '请输入库存',\n            trigger: 'blur',\n          },\n        ],\n        num: [\n          {\n            required: true,\n            type: 'number',\n            message: '请输入购买数量限制',\n            trigger: 'blur',\n          },\n        ],\n        once_num: [\n          {\n            required: true,\n            type: 'number',\n            message: '请输入单次购买数量限制',\n            trigger: 'blur',\n          },\n        ],\n        temp_id: [\n          {\n            required: true,\n            message: '请选择运费模板',\n            trigger: 'change',\n            type: 'number',\n          },\n        ],\n        time_id: [\n          {\n            required: true,\n            message: '请选择开始时间',\n            trigger: 'change',\n            type: 'array',\n          },\n        ],\n      },\n      copy: 0,\n    };\n  },\n  computed: {\n    ...mapState('media', ['isMobile']),\n    labelWidth() {\n      return this.isMobile ? undefined : '135px';\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'right';\n    },\n  },\n  mounted() {\n    if (this.$route.params.id) {\n      this.copy = this.$route.params.copy;\n      this.current = 1;\n      this.getInfo();\n    }\n    this.productGetTemplate();\n    this.seckillTimeList();\n  },\n  methods: {\n    getEditorContent(data) {\n      this.description = data;\n    },\n    // 添加运费模板\n    freight() {\n      this.$refs.template.id = 0;\n      this.$refs.template.isTemplate = true;\n    },\n    // 秒杀规格；\n    productAttrs(rows) {\n      let that = this;\n      productAttrsApi(rows.id, 1)\n        .then((res) => {\n          let data = res.data.info;\n          let selection = {\n            type: 'selection',\n            width: 60,\n            align: 'center',\n          };\n          that.specsData = data.attrs;\n          that.specsData.forEach(function (item, index) {\n            that.$set(that.specsData[index], 'id', index);\n          });\n          that.formValidate.items = data.items;\n          that.columns = data.header;\n        })\n        .catch((res) => {\n          that.$message.error(res.msg);\n        });\n    },\n\n    // 多选\n    changeCheckbox(selection) {\n      this.formValidate.attrs = selection;\n    },\n    seckillTimeList() {\n      let that = this;\n      seckillTimeListApi()\n        .then((res) => {\n          that.timeList = res.data.list.data;\n        })\n        .catch((res) => {\n          that.$message.error(res.msg);\n        });\n    },\n    // 获取运费模板；\n    productGetTemplate() {\n      productGetTemplateApi().then((res) => {\n        this.templateList = res.data;\n      });\n    },\n    // 表单验证\n    validate(prop, status, error) {\n      if (status === false) {\n        this.$message.error(error);\n      }\n    },\n    // 商品id\n    getProductId(row) {\n      this.modal_loading = false;\n      this.modals = false;\n      setTimeout(() => {\n        this.formValidate = {\n          images: row.slider_image,\n          info: row.store_info,\n          title: row.store_name,\n          image: row.image,\n          unit_name: row.unit_name,\n          price: 0, // 不取商品中的原价\n          ot_price: row.ot_price,\n          cost: row.cost,\n          sales: row.sales,\n          stock: row.stock,\n          sort: row.sort,\n          num: 1,\n          once_num: 1,\n          give_integral: row.give_integral,\n          postage: row.postage,\n          section_time: [],\n          is_postage: row.is_postage,\n          is_hot: row.is_hot,\n          status: 0,\n          description: row.description,\n          id: 0,\n          product_id: row.id,\n          temp_id: row.temp_id,\n          logistics: row.logistics, //选择物流方式\n          freight: row.freight, //运费设置\n          postage: row.postage, //设置运费金额\n          custom_form: row.custom_form, //自定义表单数据\n          virtual_type: row.virtual_type, //虚拟商品类型\n          is_commission: row.is_commission,\n        };\n        this.productAttrs(row);\n        this.$refs.goodslist.productRow = null;\n      }, 500);\n    },\n\n    cancel() {\n      this.modals = false;\n    },\n    // 具体日期\n    onchangeTime(e) {\n      this.formValidate.section_time = e;\n    },\n    // 详情\n    getInfo() {\n      this.spinShow = true;\n      seckillInfoApi(this.$route.params.id)\n        .then(async (res) => {\n          let that = this;\n          let info = res.data.info;\n          let selection = {\n            type: 'selection',\n            width: 60,\n            align: 'center',\n          };\n          this.formValidate = info;\n          this.$set(this.formValidate, 'items', info.attrs.items);\n          this.columns = info.attrs.header;\n          // this.columns.unshift(selection);\n          that.specsData = info.attrs.value;\n          that.specsData.forEach(function (item, index) {\n            that.$set(that.specsData[index], 'id', index);\n          });\n          let data = info.attrs;\n          let attr = [];\n          for (let index in info.attrs.value) {\n            if (info.attrs.value[index]._checked) {\n              attr.push(info.attrs.value[index]);\n            }\n          }\n          that.formValidate.attrs = attr;\n          attr.forEach((row) => {\n            that.$refs.multipleTable.toggleRowSelection(row, true);\n          });\n          this.spinShow = false;\n        })\n        .catch((res) => {\n          this.spinShow = false;\n          this.$message.error(res.msg);\n        });\n    },\n    getRowKeys(row) {\n      return row.id;\n    },\n    changePrice(e, index) {\n      this.$set(this.specsData[index], 'price', e);\n    },\n    // 下一步\n    next(name) {\n      let that = this;\n      if (this.current === 2) {\n        this.formValidate.description = this.description;\n        this.$refs[name].validate((valid) => {\n          if (valid) {\n            if (this.copy == 1) this.formValidate.copy = 1;\n            this.formValidate.id = Number(this.$route.params.id) || 0;\n            this.submitOpen = true;\n            seckillAddApi(this.formValidate)\n              .then(async (res) => {\n                this.submitOpen = false;\n                this.$message.success(res.msg);\n                setTimeout(() => {\n                  this.$router.push({\n                    path: this.$routeProStr + '/marketing/store_seckill/index',\n                  });\n                }, 500);\n              })\n              .catch((res) => {\n                this.submitOpen = false;\n                this.$message.error(res.msg);\n              });\n          } else {\n            return false;\n          }\n        });\n      } else if (this.current === 1) {\n        this.$refs[name].validate((valid) => {\n          if (valid) {\n            if (!that.formValidate.attrs) {\n              return that.$message.error('请选择属性规格');\n            } else {\n              for (let index in that.formValidate.attrs) {\n                if (that.formValidate.attrs[index].price > this.formValidate.attrs[index]['ot_price']) {\n                  return that.$message.error('秒杀价格不能大于原价');\n                }\n                if (that.formValidate.attrs[index].quota <= 0) {\n                  return that.$message.error('秒杀限量必须大于0');\n                }\n                if (this.formValidate.attrs[index].quota > this.formValidate.attrs[index]['stock']) {\n                  return this.$message.error('秒杀限量不能超过规格库存');\n                }\n              }\n            }\n            this.current += 1;\n          }\n        });\n      } else {\n        if (this.formValidate.images) {\n          this.current += 1;\n        } else {\n          this.$message.warning('请选择商品');\n        }\n      }\n    },\n    // 上一步\n    step() {\n      this.current--;\n    },\n    // 内容\n    getContent(val) {\n      this.formValidate.description = val;\n    },\n    // 点击商品图\n    modalPicTap(tit, picTit, index) {\n      this.modalPic = true;\n      this.isChoice = tit === 'dan' ? '单选' : '多选';\n      this.picTit = picTit;\n      this.tableIndex = index;\n    },\n    // 获取单张图片信息\n    getPic(pc) {\n      switch (this.picTit) {\n        case 'danFrom':\n          this.formValidate.image = pc.att_dir;\n          break;\n        // case 'danTable':\n        //     this.specsData[this.tableIndex].pic = pc.att_dir;\n        //     break;\n        default:\n          if (!!this.formValidate.attrs && this.formValidate.attrs.length) {\n            this.$set(this.specsData[this.tableIndex], '_checked', true);\n          }\n          this.specsData[this.tableIndex].pic = pc.att_dir;\n      }\n      this.modalPic = false;\n    },\n    // 获取多张图信息\n    getPicD(pc) {\n      this.images = pc;\n      this.images.map((item) => {\n        this.formValidate.images.push(item.att_dir);\n        this.formValidate.images = this.formValidate.images.splice(0, 10);\n      });\n      this.modalPic = false;\n    },\n    handleRemove(i) {\n      this.images.splice(i, 1);\n      this.formValidate.images.splice(i, 1);\n    },\n    // 选择商品\n    changeGoods() {\n      this.modals = true;\n      this.$nextTick((e) => {\n        this.$refs.goodslist.formValidate.is_show = -1;\n        this.$refs.goodslist.formValidate.type = 3;\n        this.$refs.goodslist.getList();\n        this.$refs.goodslist.goodsCategory();\n      });\n    }, // 移动\n    handleDragStart(e, item) {\n      this.dragging = item;\n    },\n    handleDragEnd(e, item) {\n      this.dragging = null;\n    },\n    // 首先把div变成可以放置的元素，即重写dragenter/dragover\n    handleDragOver(e) {\n      e.dataTransfer.dropEffect = 'move'; // e.dataTransfer.dropEffect=\"move\";//在dragenter中针对放置目标来设置!\n    },\n    handleDragEnter(e, item) {\n      e.dataTransfer.effectAllowed = 'move'; // 为需要移动的元素设置dragstart事件\n      if (item === this.dragging) {\n        return;\n      }\n      const newItems = [...this.formValidate.images];\n      const src = newItems.indexOf(this.dragging);\n      const dst = newItems.indexOf(item);\n      newItems.splice(dst, 0, ...newItems.splice(src, 1));\n      this.formValidate.images = newItems;\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.content_width {\n  width: 460px;\n}\n.maxW ::v-deep .ivu-select-dropdown {\n  max-width: 600px;\n}\n.grey {\n  color: #999;\n  font-size: 12px;\n}\n.tabBox_img {\n  width: 50px;\n  height: 50px;\n  margin: 0 auto;\n}\n.tabBox_img img {\n  width: 100%;\n  height: 100%;\n}\n.priceBox {\n  width: 100%;\n}\n.form {\n  .picBox {\n    display: inline-block;\n    cursor: pointer;\n  }\n  .pictrue {\n    width: 60px;\n    height: 60px;\n    border: 1px dotted rgba(0, 0, 0, 0.1);\n    margin-right: 15px;\n    display: inline-block;\n    position: relative;\n    cursor: pointer;\n\n    img {\n      width: 100%;\n      height: 100%;\n    }\n    .btndel {\n      position: absolute;\n      z-index: 9;\n      width: 20px !important;\n      height: 20px !important;\n      left: 46px;\n      top: -4px;\n    }\n  }\n  .upLoad {\n    width: 58px;\n    height: 58px;\n    line-height: 58px;\n    border: 1px dotted rgba(0, 0, 0, 0.1);\n    border-radius: 4px;\n    background: rgba(0, 0, 0, 0.02);\n    cursor: pointer;\n  }\n  .col {\n    color: #2d8cf0;\n    cursor: pointer;\n  }\n}\n.addfont {\n  font-size: 12px;\n  color: var(--prev-color-primary);\n  margin-left: 14px;\n  cursor: pointer;\n  margin-left: 10px;\n  cursor: pointer;\n}\n</style>\n"]}]}