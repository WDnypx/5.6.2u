{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\babel-loader\\lib\\index.js!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\product\\productList\\components\\goodsImport.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\product\\productList\\components\\goodsImport.vue","mtime":1731313973090},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\babel.config.js","mtime":1679965410000},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\.babelrc","mtime":1679965410000},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1753254258567},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCB7IGltcG9ydFByb2R1Y3RJbXBvcnQgfSBmcm9tICdAL2FwaS9leHBvcnQnOwppbXBvcnQgU2V0dGluZyBmcm9tICdAL3NldHRpbmcnOwppbXBvcnQgeyBnZXRDb29raWVzIH0gZnJvbSAnQC9saWJzL3V0aWwnOwppbXBvcnQgeyBpc1hsc1VwbG9hZCB9IGZyb20gJ0AvdXRpbHMvaW5kZXgnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2dvb2RzSW1wb3J0JywKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdXBsb2FkVXJsOiBTZXR0aW5nLmFwaUJhc2VVUkwgKyAnL2ZpbGUvdXBsb2FkLzEnLAogICAgICBoZWFkZXI6IHsKICAgICAgICAnQXV0aG9yaS16YXRpb24nOiAnQmVhcmVyICcgKyBnZXRDb29raWVzKCd0b2tlbicpCiAgICAgIH0sCiAgICAgIGZpbGVOYW1lOiAnJywKICAgICAgZmlsZVVybDogJycsCiAgICAgIGltcG9ydFN0YXR1czogZmFsc2UsCiAgICAgIGltcG9ydExvYWRpbmc6IGZhbHNlLAogICAgICByZXN1bHREYXRhOiB7CiAgICAgICAgYWxsOiAwLAogICAgICAgIHN1Y2Nlc3M6IDAsCiAgICAgICAgZmFpbDogMCwKICAgICAgICBqdW1wOiAwCiAgICAgIH0sCiAgICAgIHN0YXR1c0ltYWdlOiByZXF1aXJlKCdAL2Fzc2V0cy9pbWFnZXMvZmlsZS1zdWNjZXNzLnBuZycpCiAgICB9OwogIH0sCiAgd2F0Y2g6IHsKICAgIHJlc3VsdERhdGE6IHsKICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcihuZXdWYWx1ZSkgewogICAgICAgIGlmIChuZXdWYWx1ZS5mYWlsID4gMCkgewogICAgICAgICAgdGhpcy5zdGF0dXNJbWFnZSA9IHJlcXVpcmUoJ0AvYXNzZXRzL2ltYWdlcy9maWxlLWZhaWwucG5nJyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuc3RhdHVzSW1hZ2UgPSByZXF1aXJlKCdAL2Fzc2V0cy9pbWFnZXMvZmlsZS1zdWNjZXNzLnBuZycpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZGVlcDogdHJ1ZSAvLyDpu5jorqTlgLzmmK8gZmFsc2XvvIzku6PooajmmK/lkKbmt7Hluqbnm5HlkKwKICAgIH0KICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7fSwKICBtZXRob2RzOiB7CiAgICBmaWxlQ2hhbmdlOiBmdW5jdGlvbiBmaWxlQ2hhbmdlKGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIGlmIChpc1hsc1VwbG9hZChmaWxlKSkgewogICAgICAgIC8vIOmZkOWItjEwTQogICAgICAgIGlmIChmaWxlLnNpemUgPj0gMTA0ODU3NjApIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+aWh+S7tuWkp+Wwj+S4jeiDvei2hei/hzEwTUInKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5maWxlTmFtZSA9IGZpbGUubmFtZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9LAogICAgc2VsZWN0RmlsZTogZnVuY3Rpb24gc2VsZWN0RmlsZSgpIHsKICAgICAgdGhpcy5pbXBvcnRTdGF0dXMgPSBmYWxzZTsKICAgICAgdGhpcy5pbXBvcnRMb2FkaW5nID0gZmFsc2U7CiAgICAgIC8vIOiwg+i1t+mAieaLqeaWh+S7tgogICAgICB0aGlzLiRyZWZzWyd1cGxvYWQnXS4kcmVmc1sndXBsb2FkLWlubmVyJ10uaGFuZGxlQ2xpY2soKTsKICAgIH0sCiAgICBoYW5kbGVTdWNjZXNzOiBmdW5jdGlvbiBoYW5kbGVTdWNjZXNzKHJlcywgZmlsZSwgZmlsZUxpc3QpIHsKICAgICAgY29uc29sZS5sb2cocmVzLCAnMicpOwogICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgdGhpcy5maWxlVXJsID0gcmVzLmRhdGEuc3JjOwogICAgICB9CiAgICB9LAogICAgaW1wb3J0R29vZHM6IGZ1bmN0aW9uIGltcG9ydEdvb2RzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB0aGlzLmltcG9ydExvYWRpbmcgPSB0cnVlOwogICAgICB0aGlzLmltcG9ydFN0YXR1cyA9IGZhbHNlOwogICAgICBpbXBvcnRQcm9kdWN0SW1wb3J0KHsKICAgICAgICBmaWxlOiB0aGlzLmZpbGVVcmwKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgLy8g6L+U5Zue5a+85YWl57uT5p6cCiAgICAgICAgX3RoaXMuaW1wb3J0U3RhdHVzID0gdHJ1ZTsKICAgICAgICBfdGhpcy5yZXN1bHREYXRhID0gcmVzLmRhdGE7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICBfdGhpcy5pbXBvcnRMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgX3RoaXMuaW1wb3J0U3RhdHVzID0gZmFsc2U7CiAgICAgICAgX3RoaXMuJG1lc3NhZ2UuZXJyb3IoZXJyLm1zZyk7CiAgICAgIH0pOwogICAgfSwKICAgIGNsb3NlOiBmdW5jdGlvbiBjbG9zZSgpIHsKICAgICAgdGhpcy5maWxlVXJsID0gJyc7CiAgICAgIHRoaXMuZmlsZU5hbWUgPSAnJzsKICAgICAgdGhpcy5pbXBvcnRTdGF0dXMgPSBmYWxzZTsKICAgICAgdGhpcy4kZW1pdCgnY2xvc2UnKTsKICAgIH0sCiAgICBkb3dubG9hZEZhaWxEYXRhOiBmdW5jdGlvbiBkb3dubG9hZEZhaWxEYXRhKCkgewogICAgICAvLyDkuIvovb3lpLHotKXmlbDmja4KICAgIH0KICB9Cn07"},{"version":3,"names":["importProductImport","Setting","getCookies","isXlsUpload","name","data","uploadUrl","apiBaseURL","header","fileName","fileUrl","importStatus","importLoading","resultData","all","success","fail","jump","statusImage","require","watch","handler","newValue","deep","mounted","methods","fileChange","file","fileList","size","$message","error","selectFile","$refs","handleClick","handleSuccess","res","console","log","status","src","importGoods","_this","then","catch","err","msg","close","$emit","downloadFailData"],"sources":["src/pages/product/productList/components/goodsImport.vue"],"sourcesContent":["<!-- 商品导入 -->\n<template>\n  <div class=\"goods-import\">\n    <!-- 下载模板 -->\n    <div class=\"download acea-row row-middle\">\n      <span>上传前请先按Excel模板中的格式编辑内容</span>\n      <img src=\"@/assets/images/excel-icon.png\" alt=\"\" />\n      <a href=\"/product_migration.xlsx\" download class=\"download-text cup\">下载Excel模板</a>\n    </div>\n\n    <div class=\"goods-upload mt20\">\n      <el-upload\n        v-show=\"!fileUrl && !importStatus\"\n        ref=\"upload\"\n        class=\"upload-demo\"\n        :drag=\"!fileUrl\"\n        :show-file-list=\"false\"\n        :action=\"uploadUrl\"\n        :headers=\"header\"\n        :before-upload=\"fileChange\"\n        :on-success=\"handleSuccess\"\n        accept=\".xls, .xlsx\"\n      >\n        <template>\n          <img class=\"el-upload-dragger__icon mb20\" src=\"@/assets/images/upload-icon.png\" alt=\"\" />\n          <div class=\"el-upload__text\">将文件拖到此处，或<em>点击添加</em></div>\n          <div class=\"el-upload__trip\">支持 .xls，.xlsx，限10M以内</div>\n        </template>\n      </el-upload>\n      <div v-show=\"fileUrl && !importStatus\" class=\"file-info\">\n        <img class=\"el-upload-dragger__icon mb20\" src=\"@/assets/images/upload-icon.png\" alt=\"\" />\n        <div class=\"el-upload__text\">{{ fileName }}</div>\n        <div class=\"flex mt12\" v-if=\"fileUrl && !importLoading\">\n          <div class=\"active-btn\" @click=\"selectFile\">重新上传</div>\n          <div class=\"active-btn\" @click=\"fileUrl = ''\">删除</div>\n        </div>\n        <div class=\"el-upload__trip\" v-if=\"importLoading\">\n          正在导入，您可关闭当前弹窗，稍候可在列表查看导入结果\n          <i class=\"el-icon-loading\"></i>\n        </div>\n        <el-button v-else class=\"btn-import\" type=\"primary\" size=\"small\" @click=\"importGoods\">立即导入</el-button>\n      </div>\n      <div v-show=\"fileUrl && importStatus\" class=\"file-info\">\n        <img class=\"el-upload-dragger__icon mb20\" :src=\"statusImage\" alt=\"\" />\n        <div class=\"el-upload__text\">\n          共导入 {{ resultData.all }} 个，成功 {{ resultData.success }} 个，失败 {{ resultData.fail }} 跳过\n          {{ resultData.jump }} 个\n        </div>\n        <div class=\"el-upload__trip\" v-if=\"resultData.fail > 0\">\n          您可以下载失败数据，修改后再重新导入 <span class=\"active-btn\" @click=\"downloadFailData\">下载失败数据</span>\n        </div>\n        <div>\n          <el-button class=\"btn-import\" size=\"small\" @click=\"selectFile\">再次导入</el-button>\n          <el-button type=\"primary\" class=\"btn-import\" @click=\"close\">完成</el-button>\n        </div>\n      </div>\n    </div>\n    <!-- 导入规则 -->\n    <div class=\"import-rule mt20\">\n      <div class=\"rule-title\">导入规则</div>\n      <!-- 1. 请先下载模板，在模板中按字段填写信息，然后上传该文件。\n2. 导入未完成之前，请勿关闭页面，否则可能数据错误。\n3. 文件大小不超过10MB。\n4. 限制导入10000行记录，超出部分请分多次导入。 -->\n      <div class=\"rule-text\">1. 请先下载模板，在模板中按字段填写信息，然后上传该文件。</div>\n      <div class=\"rule-text\">2. 导入未完成之前，请勿关闭页面，否则可能数据错误。</div>\n      <div class=\"rule-text\">3. 文件大小不超过10MB。</div>\n      <div class=\"rule-text\">4. 限制导入10000行记录，超出部分请分多次导入。</div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { importProductImport } from '@/api/export';\nimport Setting from '@/setting';\nimport { getCookies } from '@/libs/util';\nimport { isXlsUpload } from '@/utils/index';\n\nexport default {\n  name: 'goodsImport',\n  data() {\n    return {\n      uploadUrl: Setting.apiBaseURL + '/file/upload/1',\n      header: {\n        'Authori-zation': 'Bearer ' + getCookies('token'),\n      },\n      fileName: '',\n      fileUrl: '',\n      importStatus: false,\n      importLoading: false,\n      resultData: {\n        all: 0,\n        success: 0,\n        fail: 0,\n        jump: 0,\n      },\n      statusImage: require('@/assets/images/file-success.png'),\n    };\n  },\n  watch: {\n    resultData: {\n      handler(newValue) {\n        if (newValue.fail > 0) {\n          this.statusImage = require('@/assets/images/file-fail.png');\n        } else {\n          this.statusImage = require('@/assets/images/file-success.png');\n        }\n      },\n      deep: true, // 默认值是 false，代表是否深度监听\n    },\n  },\n  mounted() {},\n  methods: {\n    fileChange(file, fileList) {\n      if (isXlsUpload(file)) {\n        // 限制10M\n        if (file.size >= 10485760) {\n          this.$message.error('文件大小不能超过10MB');\n          return false;\n        } else {\n          this.fileName = file.name;\n        }\n      } else {\n        return false;\n      }\n    },\n    selectFile() {\n      this.importStatus = false;\n      this.importLoading = false;\n      // 调起选择文件\n      this.$refs['upload'].$refs['upload-inner'].handleClick();\n    },\n    handleSuccess(res, file, fileList) {\n      console.log(res, '2');\n      if (res.status === 200) {\n        this.fileUrl = res.data.src;\n      }\n    },\n    importGoods() {\n      this.importLoading = true;\n      this.importStatus = false;\n      importProductImport({\n        file: this.fileUrl,\n      })\n        .then((res) => {\n          // 返回导入结果\n          this.importStatus = true;\n          this.resultData = res.data;\n        })\n        .catch((err) => {\n          this.importLoading = false;\n          this.importStatus = false;\n          this.$message.error(err.msg);\n        });\n    },\n    close() {\n      this.fileUrl = '';\n      this.fileName = '';\n      this.importStatus = false;\n      this.$emit('close');\n    },\n    downloadFailData() {\n      // 下载失败数据\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.download {\n  background-color: var(--prev-color-primary-light-9);\n  padding: 12px;\n  border-radius: 4px;\n  color: #303133;\n  font-size: 12px;\n  img {\n    width: 19px;\n    height: 19px;\n    margin: 0 4px 0 8px;\n  }\n  .download-text {\n    color: var(--prev-color-primary);\n  }\n}\n.goods-upload {\n  width: 100%;\n  ::v-deep .el-upload {\n    width: 100%;\n    .el-upload-dragger {\n      width: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      flex-direction: column;\n      padding: 170px 0;\n      .el-upload-dragger__icon {\n        width: 42px;\n        height: 57px;\n      }\n      .el-upload__trip {\n        font-weight: 400;\n        font-size: 12px;\n        color: #999999;\n        margin-top: 6px;\n      }\n    }\n  }\n  .file-info {\n    height: 342px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n    border: 1px dashed #d9d9d9;\n    border-radius: 4px;\n    margin-top: 10px;\n    .active-btn {\n      color: var(--prev-color-primary);\n      font-size: 12px;\n      font-weight: 400;\n      margin: 0 6px;\n      cursor: pointer;\n    }\n    .btn-import {\n      margin-top: 26px;\n    }\n    .el-upload-dragger__icon {\n      width: 42px;\n      height: 57px;\n    }\n    .el-upload__trip {\n      display: flex;\n      align-items: center;\n      font-weight: 400;\n      font-size: 12px;\n      color: #999;\n      margin-top: 6px;\n    }\n  }\n}\n.import-rule {\n  .rule-title {\n    font-weight: 500;\n    font-size: 14px;\n    color: #303133;\n    margin-bottom: 6px;\n  }\n  .rule-text {\n    font-size: 12px;\n    color: #303133;\n  }\n}\n</style>\n"],"mappings":";AAyEA,SAAAA,mBAAA;AACA,OAAAC,OAAA;AACA,SAAAC,UAAA;AACA,SAAAC,WAAA;AAEA;EACAC,IAAA;EACAC,IAAA,WAAAA,KAAA;IACA;MACAC,SAAA,EAAAL,OAAA,CAAAM,UAAA;MACAC,MAAA;QACA,8BAAAN,UAAA;MACA;MACAO,QAAA;MACAC,OAAA;MACAC,YAAA;MACAC,aAAA;MACAC,UAAA;QACAC,GAAA;QACAC,OAAA;QACAC,IAAA;QACAC,IAAA;MACA;MACAC,WAAA,EAAAC,OAAA;IACA;EACA;EACAC,KAAA;IACAP,UAAA;MACAQ,OAAA,WAAAA,QAAAC,QAAA;QACA,IAAAA,QAAA,CAAAN,IAAA;UACA,KAAAE,WAAA,GAAAC,OAAA;QACA;UACA,KAAAD,WAAA,GAAAC,OAAA;QACA;MACA;MACAI,IAAA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;EACAC,OAAA;IACAC,UAAA,WAAAA,WAAAC,IAAA,EAAAC,QAAA;MACA,IAAAzB,WAAA,CAAAwB,IAAA;QACA;QACA,IAAAA,IAAA,CAAAE,IAAA;UACA,KAAAC,QAAA,CAAAC,KAAA;UACA;QACA;UACA,KAAAtB,QAAA,GAAAkB,IAAA,CAAAvB,IAAA;QACA;MACA;QACA;MACA;IACA;IACA4B,UAAA,WAAAA,WAAA;MACA,KAAArB,YAAA;MACA,KAAAC,aAAA;MACA;MACA,KAAAqB,KAAA,WAAAA,KAAA,iBAAAC,WAAA;IACA;IACAC,aAAA,WAAAA,cAAAC,GAAA,EAAAT,IAAA,EAAAC,QAAA;MACAS,OAAA,CAAAC,GAAA,CAAAF,GAAA;MACA,IAAAA,GAAA,CAAAG,MAAA;QACA,KAAA7B,OAAA,GAAA0B,GAAA,CAAA/B,IAAA,CAAAmC,GAAA;MACA;IACA;IACAC,WAAA,WAAAA,YAAA;MAAA,IAAAC,KAAA;MACA,KAAA9B,aAAA;MACA,KAAAD,YAAA;MACAX,mBAAA;QACA2B,IAAA,OAAAjB;MACA,GACAiC,IAAA,WAAAP,GAAA;QACA;QACAM,KAAA,CAAA/B,YAAA;QACA+B,KAAA,CAAA7B,UAAA,GAAAuB,GAAA,CAAA/B,IAAA;MACA,GACAuC,KAAA,WAAAC,GAAA;QACAH,KAAA,CAAA9B,aAAA;QACA8B,KAAA,CAAA/B,YAAA;QACA+B,KAAA,CAAAZ,QAAA,CAAAC,KAAA,CAAAc,GAAA,CAAAC,GAAA;MACA;IACA;IACAC,KAAA,WAAAA,MAAA;MACA,KAAArC,OAAA;MACA,KAAAD,QAAA;MACA,KAAAE,YAAA;MACA,KAAAqC,KAAA;IACA;IACAC,gBAAA,WAAAA,iBAAA;MACA;IAAA;EAEA;AACA","ignoreList":[]}]}