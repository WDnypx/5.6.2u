{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\babel-loader\\lib\\index.js!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\app\\upload\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\app\\upload\\index.vue","mtime":1711590189034},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\babel.config.js","mtime":1679965410000},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\.babelrc","mtime":1679965410000},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1753254258567},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvciBmcm9tICJEOi9wYy96bS9cdTY2MDZcdTY2MEVcdTk2MTRcdTdGRDRcdTc5RDFcdTYyODBcdTY3MDlcdTk2NTBcdTUxNkNcdTUzRjgvXHU2RTkwXHU3ODAxL0NSTUVCLUJaIHY1LjYuMigyMDI1MDYzMCkvdGVtcGxhdGUvYWRtaW4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3JlZ2VuZXJhdG9yLmpzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6L3BjL3ptL1x1NjYwNlx1NjYwRVx1OTYxNFx1N0ZENFx1NzlEMVx1NjI4MFx1NjcwOVx1OTY1MFx1NTE2Q1x1NTNGOC9cdTZFOTBcdTc4MDEvQ1JNRUItQlogdjUuNi4yKDIwMjUwNjMwKS90ZW1wbGF0ZS9hZG1pbi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5jb25zdHJ1Y3Rvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgU2V0dGluZyBmcm9tICdAL3NldHRpbmcnOwppbXBvcnQgeyBzY2FuVXBsb2FkIH0gZnJvbSAnQC9hcGkvc2V0dGluZyc7CmltcG9ydCBjb21wcmVzc0ltZyBmcm9tICdAL3V0aWxzL2NvbXByZXNzSW1nLmpzJzsKaW1wb3J0IHsgaXNQaWNVcGxvYWQgfSBmcm9tICdAL3V0aWxzJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdhcHBfdXBsb2FkX2ZpbGUnLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBmaWxlVXJsOiBTZXR0aW5nLmFwaUJhc2VVUkwgKyAnL2ltYWdlL3NjYW5fdXBsb2FkJywKICAgICAgaW1nTGlzdDogW10sCiAgICAgIGFsbFNpemU6IDAsCiAgICAgIHRva2VuOiAnJywKICAgICAgdXBsb2FkaW5nOiB0cnVlLAogICAgICBsaW1pdDogMjAsCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBwaWQ6IDAKICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy50b2tlbiA9IHRoaXMuJHJvdXRlLnF1ZXJ5LnRva2VuOwogICAgdGhpcy5waWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5waWQ7CiAgICBkb2N1bWVudC50aXRsZSA9ICfmiYvmnLrnq6/miavnoIHkuIrkvKAnOwogIH0sCiAgbWV0aG9kczogewogICAgc2VsZWN0SW1nczogZnVuY3Rpb24gc2VsZWN0SW1ncygpIHsKICAgICAgaWYgKHRoaXMubG9hZGluZykgcmV0dXJuOwogICAgICB0aGlzLiRyZWZzWyd1cGxvYWQnXS4kcmVmc1sndXBsb2FkLWlubmVyJ10uaGFuZGxlQ2xpY2soKTsKICAgIH0sCiAgICBhZ2FpbjogZnVuY3Rpb24gYWdhaW4oKSB7CiAgICAgIHRoaXMudXBsb2FkaW5nID0gdHJ1ZTsKICAgICAgdGhpcy5pbWdMaXN0ID0gW107CiAgICAgIHRoaXMuYWxsU2l6ZSA9IDA7CiAgICB9LAogICAgc3VibWl0VXBsb2FkOiBmdW5jdGlvbiBzdWJtaXRVcGxvYWQoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvcigvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yKCkubShmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBpLCBmaWxlOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IoKS53KGZ1bmN0aW9uIChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQubikgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgaWYgKCFfdGhpcy5pbWdMaXN0Lmxlbmd0aCkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubiA9IDY7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKCFfdGhpcy5sb2FkaW5nKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uID0gMTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYSgyKTsKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIF90aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICAgIGkgPSAwOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgaWYgKCEoaSA8IF90aGlzLmltZ0xpc3QubGVuZ3RoKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubiA9IDU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZmlsZSA9IF90aGlzLmltZ0xpc3RbaV0ucmF3OwogICAgICAgICAgICAgIF9jb250ZXh0Lm4gPSAzOwogICAgICAgICAgICAgIHJldHVybiBfdGhpcy51cGxvYWRJdGVtKGZpbGUpOwogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgaWYgKGkgPT0gX3RoaXMuaW1nTGlzdC5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgICAgICBfdGhpcy51cGxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIF90aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBpKys7CiAgICAgICAgICAgICAgX2NvbnRleHQubiA9IDI7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICBfY29udGV4dC5uID0gNzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIF90aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+ivt+WFiOmAieaLqeWbvueJhycpOwogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmEoMik7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGhhbmRsZVJlbW92ZTogZnVuY3Rpb24gaGFuZGxlUmVtb3ZlKGZpbGUpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHZhciBpbmRleCA9IHRoaXMuaW1nTGlzdC5maW5kSW5kZXgoZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZS51cmwgPT0gZmlsZS51cmw7CiAgICAgIH0pOwogICAgICB0aGlzLmltZ0xpc3Quc3BsaWNlKGluZGV4LCAxKTsKICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKGUpIHsKICAgICAgICB2YXIgcyA9IDA7CiAgICAgICAgaWYgKF90aGlzMi5pbWdMaXN0Lmxlbmd0aCkgewogICAgICAgICAgX3RoaXMyLmltZ0xpc3QubWFwKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHMgKz0gZS5yYXcuc2l6ZTsKICAgICAgICAgIH0pOwogICAgICAgICAgX3RoaXMyLmFsbFNpemUgPSBzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpczIuYWxsU2l6ZSA9IDA7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICB1cGxvYWRJdGVtOiBmdW5jdGlvbiB1cGxvYWRJdGVtKGZpbGUpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgZmlsZSk7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCd1cGxvYWRUb2tlbicsIF90aGlzMy50b2tlbik7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdwaWQnLCBfdGhpczMucGlkKTsKICAgICAgICBzY2FuVXBsb2FkKGZvcm1EYXRhKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIGlmIChyZXMuc3RhdHVzID09IDIwMCkgewogICAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdGhpczMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICBfdGhpczMuJG1lc3NhZ2UoewogICAgICAgICAgICAgIG1lc3NhZ2U6ICfkuIrkvKDlpLHotKUnLAogICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsCiAgICAgICAgICAgICAgZHVyYXRpb246IDEwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgICAgX3RoaXMzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgIF90aGlzMy4kbWVzc2FnZS5lcnJvcihlcnIubXNnKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgZmlsZUVycm9yOiBmdW5jdGlvbiBmaWxlRXJyb3IoZXJyLCBmaWxlLCBmaWxlTGlzdCkgewogICAgICBjb25zb2xlLmxvZyhlcnIsIGZpbGUsIGZpbGVMaXN0KTsKICAgIH0sCiAgICBiZWZvcmVVcGxvYWQ6IGZ1bmN0aW9uIGJlZm9yZVVwbG9hZChmaWxlKSB7CiAgICAgIHJldHVybiBpc1BpY1VwbG9hZChmaWxlKTsKICAgIH0sCiAgICBmaWxlQ2hhbmdlOiBmdW5jdGlvbiBmaWxlQ2hhbmdlKGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoLyojX19QVVJFX18qL19yZWdlbmVyYXRvcigpLm0oZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIHM7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvcigpLncoZnVuY3Rpb24gKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQyLm4pIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGlmICghKGZpbGUuc2l6ZSA+PSAyMDk3MTUyKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQyLm4gPSAyOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9jb250ZXh0Mi5uID0gMTsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXM0LmNvbUltZyhmaWxlLnJhdykudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICBmaWxlTGlzdC5tYXAoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgaWYgKGUudWlkID09PSBmaWxlLnVpZCkgewogICAgICAgICAgICAgICAgICAgIF90aGlzNC5hbGxTaXplICs9IHJlcy5zaXplOwogICAgICAgICAgICAgICAgICAgIGUucmF3ID0gcmVzOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIF90aGlzNC5pbWdMaXN0ID0gZmlsZUxpc3Q7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICBfY29udGV4dDIubiA9IDM7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBfdGhpczQuaW1nTGlzdCA9IGZpbGVMaXN0OwogICAgICAgICAgICAgIHMgPSAwOwogICAgICAgICAgICAgIGlmIChfdGhpczQuaW1nTGlzdC5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIF90aGlzNC5pbWdMaXN0Lm1hcChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICBzICs9IGUucmF3LnNpemU7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIF90aGlzNC5hbGxTaXplID0gczsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgX3RoaXM0LmFsbFNpemUgPSAwOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYSgyKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGNvbUltZzogZnVuY3Rpb24gY29tSW1nKGZpbGUpIHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICBjb21wcmVzc0ltZyhmaWxlKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIHJlc29sdmUocmVzKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgbG9hZERhdGE6IGZ1bmN0aW9uIGxvYWREYXRhKGl0ZW0sIGNhbGxiYWNrKSB7CiAgICAgIGdldENhdGVnb3J5TGlzdEFwaSh7CiAgICAgICAgcGlkOiBpdGVtLnZhbHVlCiAgICAgIH0pLnRoZW4oLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3IoKS5tKGZ1bmN0aW9uIF9jYWxsZWUzKHJlcykgewogICAgICAgICAgdmFyIGRhdGE7CiAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yKCkudyhmdW5jdGlvbiAoX2NvbnRleHQzKSB7CiAgICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0My5uKSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgZGF0YSA9IHJlcy5kYXRhLmxpc3Q7CiAgICAgICAgICAgICAgICBjYWxsYmFjayhkYXRhKTsKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmEoMik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgICB9KSk7CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICAgICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICB9OwogICAgICB9KCkpLmNhdGNoKGZ1bmN0aW9uIChyZXMpIHt9KTsKICAgIH0KICB9Cn07"},{"version":3,"names":["Setting","scanUpload","compressImg","isPicUpload","name","data","fileUrl","apiBaseURL","imgList","allSize","token","uploading","limit","loading","pid","created","$route","query","document","title","methods","selectImgs","$refs","handleClick","again","submitUpload","_this","_asyncToGenerator","_regenerator","m","_callee","i","file","w","_context","n","length","a","raw","uploadItem","$message","warning","handleRemove","_this2","index","findIndex","e","url","splice","$nextTick","s","map","size","_this3","Promise","resolve","reject","formData","FormData","append","then","res","status","message","type","duration","catch","err","error","msg","fileError","fileList","console","log","beforeUpload","fileChange","_this4","_callee2","_context2","comImg","uid","loadData","item","callback","getCategoryListApi","value","_ref","_callee3","_context3","list","_x","apply","arguments"],"sources":["src/pages/app/upload/index.vue"],"sourcesContent":["<template>\n  <div class=\"main\" v-loading=\"loading\">\n    <div v-if=\"uploading\">\n      <div class=\"img-list\" :class=\"{ 'none-card': imgList.length }\">\n        <el-upload\n          ref=\"upload\"\n          :action=\"fileUrl\"\n          list-type=\"picture-card\"\n          :on-change=\"fileChange\"\n          :on-error=\"fileError\"\n          :before-upload=\"beforeUpload\"\n          :file-list=\"imgList\"\n          :auto-upload=\"false\"\n          :multiple=\"true\"\n          :limit=\"limit\"\n          accept=\"image/*\"\n        >\n          <div slot=\"default\" class=\"upload-card\" v-if=\"!imgList.length\">\n            <i class=\"el-icon-plus\"></i>\n            <p class=\"text\">点击选择图片</p>\n          </div>\n          <div slot=\"file\" slot-scope=\"{ file }\">\n            <img class=\"el-upload-list__item-thumbnail\" :src=\"file.url\" alt=\"\" />\n            <i class=\"el-icon-error btndel\" v-db-click @click=\"handleRemove(file)\" />\n          </div>\n        </el-upload>\n      </div>\n\n      <div class=\"footer\">\n        <div v-if=\"imgList.length\">共{{ imgList.length }}/{{ limit }}张，{{ (allSize / 1000000).toFixed(2) }} M</div>\n        <div v-else></div>\n        <div class=\"upload-btn\">\n          <div v-if=\"imgList.length < limit\" class=\"btn\" v-db-click @click=\"selectImgs\">\n            {{ imgList.length ? '继续选择' : '选择图片' }}\n          </div>\n          <div class=\"btn upload\" :class=\"{ 'no-pic': !imgList.length }\" v-db-click @click=\"submitUpload\">确认上传</div>\n        </div>\n      </div>\n    </div>\n    <div v-else class=\"upload-success\">\n      <div class=\"success\">\n        <img class=\"image\" src=\"@/assets/images/success.jpg\" alt=\"\" />\n      </div>\n      <div class=\"text\">图片上传成功</div>\n      <div class=\"again\" v-db-click @click=\"again\">继续上传</div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Setting from '@/setting';\nimport { scanUpload } from '@/api/setting';\nimport compressImg from '@/utils/compressImg.js';\nimport { isPicUpload } from '@/utils';\n\nexport default {\n  name: 'app_upload_file',\n  data() {\n    return {\n      fileUrl: Setting.apiBaseURL + '/image/scan_upload',\n      imgList: [],\n      allSize: 0,\n      token: '',\n      uploading: true,\n      limit: 20,\n      loading: false,\n      pid: 0,\n    };\n  },\n  created() {\n    this.token = this.$route.query.token;\n    this.pid = this.$route.query.pid;\n    document.title = '手机端扫码上传';\n  },\n  methods: {\n    selectImgs() {\n      if (this.loading) return;\n      this.$refs['upload'].$refs['upload-inner'].handleClick();\n    },\n    again() {\n      this.uploading = true;\n      this.imgList = [];\n      this.allSize = 0;\n    },\n    async submitUpload() {\n      if (this.imgList.length) {\n        if (this.loading) return;\n        this.loading = true;\n        for (let i = 0; i < this.imgList.length; i++) {\n          const file = this.imgList[i].raw;\n          await this.uploadItem(file);\n          if (i == this.imgList.length - 1) {\n            this.uploading = false;\n            this.loading = false;\n          }\n        }\n      } else {\n        this.$message.warning('请先选择图片');\n      }\n    },\n    handleRemove(file) {\n      let index = this.imgList.findIndex((e) => {\n        return e.url == file.url;\n      });\n      this.imgList.splice(index, 1);\n      this.$nextTick((e) => {\n        let s = 0;\n        if (this.imgList.length) {\n          this.imgList.map((e) => {\n            s += e.raw.size;\n          });\n          this.allSize = s;\n        } else {\n          this.allSize = 0;\n        }\n      });\n    },\n\n    uploadItem(file) {\n      return new Promise((resolve, reject) => {\n        const formData = new FormData();\n        formData.append('file', file);\n        formData.append('uploadToken', this.token);\n        formData.append('pid', this.pid);\n        scanUpload(formData)\n          .then((res) => {\n            if (res.status == 200) {\n              resolve();\n            } else {\n              this.loading = false;\n              this.$message({\n                message: '上传失败',\n                type: 'error',\n                duration: 1000,\n              });\n            }\n          })\n          .catch((err) => {\n            this.loading = false;\n            this.$message.error(err.msg);\n          });\n      });\n    },\n    fileError(err, file, fileList) {\n      console.log(err, file, fileList);\n    },\n    beforeUpload(file) {\n      return isPicUpload(file);\n    },\n    async fileChange(file, fileList) {\n      if (file.size >= 2097152) {\n        await this.comImg(file.raw).then((res) => {\n          fileList.map((e) => {\n            if (e.uid === file.uid) {\n              this.allSize += res.size;\n              e.raw = res;\n            }\n          });\n          this.imgList = fileList;\n        });\n      } else {\n        this.imgList = fileList;\n        let s = 0;\n        if (this.imgList.length) {\n          this.imgList.map((e) => {\n            s += e.raw.size;\n          });\n          this.allSize = s;\n        } else {\n          this.allSize = 0;\n        }\n      }\n    },\n    comImg(file) {\n      return new Promise((resolve, reject) => {\n        compressImg(file).then((res) => {\n          resolve(res);\n        });\n      });\n    },\n    loadData(item, callback) {\n      getCategoryListApi({\n        pid: item.value,\n      })\n        .then(async (res) => {\n          const data = res.data.list;\n          callback(data);\n        })\n        .catch((res) => {});\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n.upload-btn {\n  display: flex;\n  align-items: center;\n}\n.img-list {\n  padding: 10px;\n  overflow: scroll;\n  height: calc(100vh - 50px);\n  background-color: #fff;\n}\n\n::v-deep .el-upload-list--picture-card .el-upload-list__item {\n  // width: 113px;\n  // height: 113px;\n  // line-height: 113px;\n  // overflow: inherit;\n  margin: 1% 1% 0px 1%;\n  width: 31.3%;\n  height: 31.3%;\n  padding-top: 31.3%;\n  aspect-ratio: 1 / 1;\n}\n::v-deep .el-upload-list--picture-card .el-upload-list__item > div {\n  // position: relative;\n  width: 100%;\n  height: 100%;\n}\n::v-deep .el-upload--picture-card {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  height: 146px;\n  justify-content: center;\n  align-items: center;\n  background: #f9f9f9;\n}\n::v-deep .el-upload-list--picture-card .el-upload-list__item img {\n  width: 100%;\n  height: 100%;\n  border-radius: 6px;\n  object-fit: cover;\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n.btndel {\n  position: absolute;\n  z-index: 1;\n  font-size: 18px;\n  right: -1px;\n  top: -1px;\n  color: #282828;\n  opacity: 0.5;\n}\n::v-deep .el-upload--picture-card:hover,\n.el-upload:focus {\n  border-color: #c0ccda;\n}\n.img-box {\n  display: flex;\n  padding-left: 100px;\n  flex-wrap: wrap;\n}\n.none-card ::v-deep .el-upload--picture-card {\n  display: none !important;\n}\n.footer {\n  padding: 0 10px 0 15px;\n  position: fixed;\n  bottom: 0;\n  width: 100%;\n  box-sizing: border-box;\n  background-color: rgba(255, 255, 255, 0.85);\n  backdrop-filter: blur(10px);\n  z-index: 277;\n  border-top: 1px solid #f0f0f0;\n  height: 50px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  .btn {\n    border: 1px solid #cccccc;\n    width: 88px;\n    height: 30px;\n    border-radius: 15px;\n    color: #000;\n    font-size: 14px;\n    font-family: PingFang SC-Regular, PingFang SC;\n    font-weight: 400;\n    color: #666666;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n  .upload {\n    background-color: #e93323;\n    color: #fff;\n    margin-left: 10px;\n  }\n  .upload.no-pic {\n    background: #e93323;\n    opacity: 0.3;\n  }\n}\n.upload-card {\n  display: flex;\n  flex-direction: column;\n  line-height: 16px;\n  .el-icon-plus {\n    font-size: 28px;\n    font-weight: bold;\n    color: #bbbbbb;\n  }\n  .text {\n    font-size: 13px;\n    font-weight: 400;\n    color: #999999;\n    margin-top: 18px;\n  }\n}\n.upload-success {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  height: 80vh;\n  .success {\n    width: 50px;\n    height: 50px;\n    background: #4bbc12;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin-bottom: 20px;\n    .image {\n      width: 60%;\n    }\n  }\n  .text {\n    font-size: 16px;\n    font-family: PingFang SC-Medium, PingFang SC;\n    font-weight: 500;\n    color: #282828;\n    margin-bottom: 40px;\n  }\n  .again {\n    width: 150px;\n    height: 43px;\n    border-radius: 21px;\n    text-align: center;\n    line-height: 41px;\n    font-size: 15px;\n    font-weight: 400;\n    color: #333333;\n    border: 1px solid #cccccc;\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]}]}