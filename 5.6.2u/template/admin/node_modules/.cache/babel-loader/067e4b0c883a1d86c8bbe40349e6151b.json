{"remainingRequest":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\babel-loader\\lib\\index.js!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\app\\routine\\download\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\src\\pages\\app\\routine\\download\\index.vue","mtime":1731313973062},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\babel.config.js","mtime":1679965410000},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\.babelrc","mtime":1679965410000},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1753254258567},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1753254255279},{"path":"D:\\pc\\zm\\昆明阔翔科技有限公司\\源码\\CRMEB-BZ v5.6.2(20250630)\\template\\admin\\node_modules\\vue-loader\\lib\\index.js","mtime":1753254260598}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRDovcGMvem0vXHU2NjA2XHU2NjBFXHU5NjE0XHU3RkQ0XHU3OUQxXHU2MjgwXHU2NzA5XHU5NjUwXHU1MTZDXHU1M0Y4L1x1NkU5MFx1NzgwMS9DUk1FQi1CWiB2NS42LjIoMjAyNTA2MzApL3RlbXBsYXRlL2FkbWluL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyLmpzIjsKaW1wb3J0IHsgcm91dGluZURvd25sb2FkLCByb3V0aW5lSW5mbyB9IGZyb20gJ0AvYXBpL2FwcCc7CmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCc7CmltcG9ydCB7IGZvcm1hdERhdGUgYXMgX2Zvcm1hdERhdGUgfSBmcm9tICdAL3V0aWxzL3ZhbGlkYXRlJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdyb3V0aW5lVGVtcGxhdGUnLAogIGZpbHRlcnM6IHsKICAgIGZvcm1hdERhdGU6IGZ1bmN0aW9uIGZvcm1hdERhdGUodGltZSkgewogICAgICBpZiAodGltZSAhPT0gMCkgewogICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUodGltZSAqIDEwMDApOwogICAgICAgIHJldHVybiBfZm9ybWF0RGF0ZShkYXRlLCAneXl5eS1NTS1kZCBoaDptbScpOwogICAgICB9CiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZ3JpZDogewogICAgICAgIHhsOiA3LAogICAgICAgIGxnOiA3LAogICAgICAgIG1kOiAxMiwKICAgICAgICBzbTogMjQsCiAgICAgICAgeHM6IDI0CiAgICAgIH0sCiAgICAgIGlmcmFtZVVybDogIiIuY29uY2F0KGxvY2F0aW9uLm9yaWdpbiwgIi9wYWdlcy9pbmRleC9pbmRleD9tZFR5cGU9aWZyYW1lV2luZG93IiksCiAgICAgIGlzX2xpdmU6IDEsCiAgICAgIHBhZ2VEYXRhOiB7CiAgICAgICAgY29kZTogJycsCiAgICAgICAgcm91dGluZV9uYW1lOiAnJywKICAgICAgICBoZWxwOiAnJywKICAgICAgICBhcHBJZDogJzEnCiAgICAgIH0KICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKICAgIHJvdXRpbmVJbmZvKCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgIF90aGlzLnBhZ2VEYXRhID0gcmVzLmRhdGE7CiAgICB9KTsKICB9LAogIHdhdGNoOiB7CiAgICAkcm91dGU6IGZ1bmN0aW9uICRyb3V0ZSh0bywgZnJvbSkge30KICB9LAogIGNvbXB1dGVkOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIG1hcFN0YXRlKCdtZWRpYScsIFsnaXNNb2JpbGUnXSkpLCB7fSwgewogICAgbGFiZWxXaWR0aDogZnVuY3Rpb24gbGFiZWxXaWR0aCgpIHsKICAgICAgcmV0dXJuIHRoaXMuaXNNb2JpbGUgPyB1bmRlZmluZWQgOiAnODBweCc7CiAgICB9LAogICAgbGFiZWxQb3NpdGlvbjogZnVuY3Rpb24gbGFiZWxQb3NpdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuaXNNb2JpbGUgPyAndG9wJyA6ICdyaWdodCc7CiAgICB9CiAgfSksCiAgbWV0aG9kczogewogICAgZG93bkxvYWQ6IGZ1bmN0aW9uIGRvd25Mb2FkKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgcm91dGluZURvd25sb2FkKHsKICAgICAgICBpc19saXZlOiB0aGlzLmlzX2xpdmUKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgd2luZG93Lm9wZW4ocmVzLmRhdGEudXJsKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgIF90aGlzMi4kbWVzc2FnZS53YXJuaW5nKGVyci5tc2cpOwogICAgICB9KTsKICAgIH0sCiAgICBkb3duTG9hZENvZGU6IGZ1bmN0aW9uIGRvd25Mb2FkQ29kZSh1cmwpIHsKICAgICAgaWYgKCF1cmwpIHJldHVybiB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+aaguaXoOWwj+eoi+W6j+eggScpOwogICAgICB2YXIgaW1hZ2UgPSBuZXcgSW1hZ2UoKTsKICAgICAgaW1hZ2Uuc3JjID0gdXJsOwogICAgICAvLyDop6PlhrPot6jln58gQ2FudmFzIOaxoeafk+mXrumimAogICAgICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ2Nyb3NzT3JpZ2luJywgJ2Fub255bW91cycpOwogICAgICBpbWFnZS5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOwogICAgICAgIGNhbnZhcy53aWR0aCA9IGltYWdlLndpZHRoOwogICAgICAgIGNhbnZhcy5oZWlnaHQgPSBpbWFnZS5oZWlnaHQ7CiAgICAgICAgdmFyIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTsKICAgICAgICBjb250ZXh0LmRyYXdJbWFnZShpbWFnZSwgMCwgMCwgaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCk7CiAgICAgICAgdmFyIHVybCA9IGNhbnZhcy50b0RhdGFVUkwoKTsgLy/lvpfliLDlm77niYfnmoRiYXNlNjTnvJbnoIHmlbDmja4KICAgICAgICB2YXIgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsgLy8g55Sf5oiQ5LiA5LiqYeWFg+e0oAogICAgICAgIHZhciBldmVudCA9IG5ldyBNb3VzZUV2ZW50KCdjbGljaycpOyAvLyDliJvlu7rkuIDkuKrljZXlh7vkuovku7YKICAgICAgICBhLmRvd25sb2FkID0gbmFtZSB8fCAncGhvdG8nOyAvLyDorr7nva7lm77niYflkI3np7AKICAgICAgICBhLmhyZWYgPSB1cmw7IC8vIOWwhueUn+aIkOeahFVSTOiuvue9ruS4umEuaHJlZuWxnuaApwogICAgICAgIGEuZGlzcGF0Y2hFdmVudChldmVudCk7IC8vIOinpuWPkWHnmoTljZXlh7vkuovku7YKICAgICAgfTsKICAgIH0KICB9Cn07"},{"version":3,"names":["routineDownload","routineInfo","mapState","formatDate","name","filters","time","date","Date","data","grid","xl","lg","md","sm","xs","iframeUrl","concat","location","origin","is_live","pageData","code","routine_name","help","appId","created","_this","then","res","watch","$route","to","from","computed","_objectSpread","labelWidth","isMobile","undefined","labelPosition","methods","downLoad","_this2","window","open","url","catch","err","$message","warning","msg","downLoadCode","image","Image","src","setAttribute","onload","canvas","document","createElement","width","height","context","getContext","drawImage","toDataURL","a","event","MouseEvent","download","href","dispatchEvent"],"sources":["src/pages/app/routine/download/index.vue"],"sourcesContent":["<template>\n  <div>\n    <!-- <div class=\"i-layout-page-header header-title\">\n      <span class=\"ivu-page-header-title\">{{ $route.meta.title }}</span>\n    </div> -->\n    <pages-header ref=\"pageHeader\" :title=\"$route.meta.title\"></pages-header>\n    <el-card :bordered=\"false\" shadow=\"never\" class=\"ivu-mt mt16\">\n      <div class=\"flex-wrapper\">\n        <!-- :src=\"iframeUrl\" -->\n        <div>\n          <iframe class=\"iframe-box\" :src=\"iframeUrl\" frameborder=\"0\" ref=\"iframe\"></iframe>\n          <div class=\"mask\"></div>\n        </div>\n\n        <div class=\"right\">\n          <div class=\"content\">\n            <div class=\"content-box title\">\n              <div class=\"line\"></div>\n              <div class=\"right title\">小程序设置</div>\n            </div>\n            <el-alert v-if=\"!pageData.appId && !pageData.code\">\n              <template slot=\"title\">\n                您尚未配置小程序信息，请<router-link :to=\"{ path: $routeProStr + '/setting/routine_config/2/7' }\"\n                  >立即设置</router-link\n                ></template\n              >\n            </el-alert>\n            <div class=\"content-box\">\n              <div class=\"left\">小程序名称：</div>\n              <div class=\"right\">{{ pageData.routine_name || '未命名' }}</div>\n            </div>\n            <div class=\"content-box\">\n              <div class=\"left\">小程序码：</div>\n              <div class=\"right\">\n                <el-button type=\"primary\" v-db-click @click=\"downLoadCode(pageData.code)\">下载小程序码</el-button>\n              </div>\n            </div>\n            <div class=\"content-box\">\n              <div class=\"left\">小程序包：</div>\n              <div class=\"right\">\n                <span>是否已开通小程序直播</span>\n                <el-radio-group class=\"rad\" size=\"large\" v-model=\"is_live\">\n                  <el-radio :label=\"0\">未开通</el-radio>\n                  <el-radio :label=\"1\">已开通</el-radio>\n                </el-radio-group>\n              </div>\n            </div>\n            <div class=\"content-box last\">\n              <div class=\"left\"></div>\n              <div class=\"right\">\n                <div>\n                  请谨慎选择是否有开通小程序直播功能，否则将影响小程序的发布 可前往\n                  <a :href=\"pageData.help\" target=\"_blank\">帮助文档</a>\n                  查看如何开通直播功能\n                </div>\n\n                <el-button class=\"mt10\" type=\"primary\" v-db-click @click=\"downLoad()\">下载小程序包</el-button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { routineDownload, routineInfo } from '@/api/app';\nimport { mapState } from 'vuex';\nimport { formatDate } from '@/utils/validate';\nexport default {\n  name: 'routineTemplate',\n  filters: {\n    formatDate(time) {\n      if (time !== 0) {\n        let date = new Date(time * 1000);\n        return formatDate(date, 'yyyy-MM-dd hh:mm');\n      }\n    },\n  },\n  data() {\n    return {\n      grid: {\n        xl: 7,\n        lg: 7,\n        md: 12,\n        sm: 24,\n        xs: 24,\n      },\n      iframeUrl: `${location.origin}/pages/index/index?mdType=iframeWindow`,\n      is_live: 1,\n      pageData: {\n        code: '',\n        routine_name: '',\n        help: '',\n        appId: '1',\n      },\n    };\n  },\n  created() {\n    routineInfo().then((res) => {\n      this.pageData = res.data;\n    });\n  },\n  watch: {\n    $route(to, from) {},\n  },\n  computed: {\n    ...mapState('media', ['isMobile']),\n    labelWidth() {\n      return this.isMobile ? undefined : '80px';\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'right';\n    },\n  },\n  methods: {\n    downLoad() {\n      routineDownload({\n        is_live: this.is_live,\n      })\n        .then((res) => {\n          window.open(res.data.url);\n        })\n        .catch((err) => {\n          this.$message.warning(err.msg);\n        });\n    },\n    downLoadCode(url) {\n      if (!url) return this.$message.warning('暂无小程序码');\n      var image = new Image();\n      image.src = url;\n      // 解决跨域 Canvas 污染问题\n      image.setAttribute('crossOrigin', 'anonymous');\n      image.onload = function () {\n        var canvas = document.createElement('canvas');\n        canvas.width = image.width;\n        canvas.height = image.height;\n        var context = canvas.getContext('2d');\n        context.drawImage(image, 0, 0, image.width, image.height);\n        var url = canvas.toDataURL(); //得到图片的base64编码数据\n        var a = document.createElement('a'); // 生成一个a元素\n        var event = new MouseEvent('click'); // 创建一个单击事件\n        a.download = name || 'photo'; // 设置图片名称\n        a.href = url; // 将生成的URL设置为a.href属性\n        a.dispatchEvent(event); // 触发a的单击事件\n      };\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.template_sp_box {\n  padding: 5px 0;\n  box-sizing: border-box;\n}\n.template_sp {\n  display: block;\n  padding: 2px 0;\n  box-sizing: border-box;\n}\n.flex-wrapper {\n  display: flex;\n  border-radius: 10px;\n}\n.iframe-box {\n  width: 312px;\n  height: 550px;\n  border-radius: 10px;\n}\n.ivu-mt {\n  height: 600px;\n}\n.content {\n  padding: 0 20px;\n}\n.content > .title {\n  padding-bottom: 26px;\n}\n.content-box {\n  display: flex;\n  align-items: center;\n  margin: 20px 20px 0 20px;\n  color: #333;\n}\n.content-box.last {\n  margin-top: 0;\n  color: #999999;\n}\n.line {\n  width: 3px;\n  height: 16px;\n  background-color: var(--prev-color-primary);\n  margin-right: 11px;\n}\n.content-box .title {\n  font-size: 16px;\n  font-weight: bold;\n}\n.content-box > span {\n  color: #f5222d;\n  font-size: 20px;\n}\n.content-box .left {\n  width: 100px;\n  text-align: right;\n}\n.content-box .right {\n  width: 400px;\n}\n.rad {\n  margin-left: 20px;\n}\n.mask {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 312px;\n  height: 550px;\n  background-color: rgba(0, 0, 0, 0);\n}\n</style>\n"],"mappings":";AAmEA,SAAAA,eAAA,EAAAC,WAAA;AACA,SAAAC,QAAA;AACA,SAAAC,UAAA,IAAAA,WAAA;AACA;EACAC,IAAA;EACAC,OAAA;IACAF,UAAA,WAAAA,WAAAG,IAAA;MACA,IAAAA,IAAA;QACA,IAAAC,IAAA,OAAAC,IAAA,CAAAF,IAAA;QACA,OAAAH,WAAA,CAAAI,IAAA;MACA;IACA;EACA;EACAE,IAAA,WAAAA,KAAA;IACA;MACAC,IAAA;QACAC,EAAA;QACAC,EAAA;QACAC,EAAA;QACAC,EAAA;QACAC,EAAA;MACA;MACAC,SAAA,KAAAC,MAAA,CAAAC,QAAA,CAAAC,MAAA;MACAC,OAAA;MACAC,QAAA;QACAC,IAAA;QACAC,YAAA;QACAC,IAAA;QACAC,KAAA;MACA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IAAA,IAAAC,KAAA;IACA1B,WAAA,GAAA2B,IAAA,WAAAC,GAAA;MACAF,KAAA,CAAAN,QAAA,GAAAQ,GAAA,CAAApB,IAAA;IACA;EACA;EACAqB,KAAA;IACAC,MAAA,WAAAA,OAAAC,EAAA,EAAAC,IAAA;EACA;EACAC,QAAA,EAAAC,aAAA,CAAAA,aAAA,KACAjC,QAAA;IACAkC,UAAA,WAAAA,WAAA;MACA,YAAAC,QAAA,GAAAC,SAAA;IACA;IACAC,aAAA,WAAAA,cAAA;MACA,YAAAF,QAAA;IACA;EAAA,EACA;EACAG,OAAA;IACAC,QAAA,WAAAA,SAAA;MAAA,IAAAC,MAAA;MACA1C,eAAA;QACAoB,OAAA,OAAAA;MACA,GACAQ,IAAA,WAAAC,GAAA;QACAc,MAAA,CAAAC,IAAA,CAAAf,GAAA,CAAApB,IAAA,CAAAoC,GAAA;MACA,GACAC,KAAA,WAAAC,GAAA;QACAL,MAAA,CAAAM,QAAA,CAAAC,OAAA,CAAAF,GAAA,CAAAG,GAAA;MACA;IACA;IACAC,YAAA,WAAAA,aAAAN,GAAA;MACA,KAAAA,GAAA,cAAAG,QAAA,CAAAC,OAAA;MACA,IAAAG,KAAA,OAAAC,KAAA;MACAD,KAAA,CAAAE,GAAA,GAAAT,GAAA;MACA;MACAO,KAAA,CAAAG,YAAA;MACAH,KAAA,CAAAI,MAAA;QACA,IAAAC,MAAA,GAAAC,QAAA,CAAAC,aAAA;QACAF,MAAA,CAAAG,KAAA,GAAAR,KAAA,CAAAQ,KAAA;QACAH,MAAA,CAAAI,MAAA,GAAAT,KAAA,CAAAS,MAAA;QACA,IAAAC,OAAA,GAAAL,MAAA,CAAAM,UAAA;QACAD,OAAA,CAAAE,SAAA,CAAAZ,KAAA,QAAAA,KAAA,CAAAQ,KAAA,EAAAR,KAAA,CAAAS,MAAA;QACA,IAAAhB,GAAA,GAAAY,MAAA,CAAAQ,SAAA;QACA,IAAAC,CAAA,GAAAR,QAAA,CAAAC,aAAA;QACA,IAAAQ,KAAA,OAAAC,UAAA;QACAF,CAAA,CAAAG,QAAA,GAAAjE,IAAA;QACA8D,CAAA,CAAAI,IAAA,GAAAzB,GAAA;QACAqB,CAAA,CAAAK,aAAA,CAAAJ,KAAA;MACA;IACA;EACA;AACA","ignoreList":[]}]}